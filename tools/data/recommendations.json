[
  {
    "publishedToAdvisor": null,
    "aprlGuid": "ca87914f-aac4-4783-ab67-82a6f936f194",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/postgresql/flexible-server/concepts-high-availability",
        "name": "Azure Database for PostgreSQL - フレキシブル サーバーでの高可用性 (信頼性)"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "フレキシブル サーバー インスタンスでゾーン冗長を使用して HA を有効にして、スタンバイ レプリカを別のゾーンにデプロイし、信頼性とディザスター リカバリーを向上させるための自動フェールオーバー機能を提供します。\n",
    "pgVerified": true,
    "description": "ゾーン冗長で HA を有効にする",
    "potentialBenefits": "Enhanced uptime and data protection",
    "tags": null,
    "recommendationResourceType": "Microsoft.DBforPostgreSQL/flexibleServers",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Find Database for PostgreSQL instances that are not zone redundant\nresources\n| where type == \"microsoft.dbforpostgresql/flexibleservers\"\n| where properties.highAvailability.mode != \"ZoneRedundant\"\n| project recommendationId = \"ca87914f-aac4-4783-ab67-82a6f936f194\", name, id, tags, param1 = \"ZoneRedundant: False\"\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "b2bad57d-7e03-4c0f-9024-597c9eb295bb",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/postgresql/flexible-server/concepts-maintenance",
        "name": "Azure Database for PostgreSQL - フレキシブル サーバーでの予定メンテナンス"
      }
    ],
    "recommendationControl": "Scalability",
    "longDescription": "フレキシブル サーバー インスタンスでカスタム メンテナンス スケジュールを使用して、サービス更新プログラムを適用する優先時間を選択します。\n",
    "pgVerified": true,
    "description": "カスタム メンテナンス スケジュールを有効にする",
    "potentialBenefits": "Control update timings",
    "tags": null,
    "recommendationResourceType": "Microsoft.DBforPostgreSQL/flexibleServers",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Find Database for PostgreSQL instances that do not have a custom maintenance window\nresources\n| where type == \"microsoft.dbforpostgresql/flexibleservers\"\n| where properties.maintenanceWindow.customWindow != \"Enabled\"\n| project recommendationId = \"b2bad57d-7e03-4c0f-9024-597c9eb295bb\", name, id, tags, param1 = strcat(\"customWindow:\", properties['maintenanceWindow']['customWindow'])\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "31f4ac4b-29cb-4588-8de2-d8fe6f13ceb3",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/postgresql/flexible-server/concepts-backup-restore",
        "name": "Azure Database for PostgreSQL (フレキシブル サーバー) でのバックアップと復元"
      }
    ],
    "recommendationControl": "Disaster Recovery",
    "longDescription": "障害や災害が発生した場合でも、データベースの可用性と耐久性の目標を確実に満たすように GRS を構成します。\n",
    "pgVerified": true,
    "description": "geo 冗長バックアップ ストレージを構成する",
    "potentialBenefits": "Recover from regional failure and/or disaster",
    "tags": null,
    "recommendationResourceType": "Microsoft.DBforPostgreSQL/flexibleServers",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Find Database for PostgreSQL instances that do not have geo redundant backup storage configured\nresources\n| where type == \"microsoft.dbforpostgresql/flexibleservers\"\n| where properties.backup.geoRedundantBackup != \"Enabled\"\n| project recommendationId = \"31f4ac4b-29cb-4588-8de2-d8fe6f13ceb3\", name, id, tags, param1 = strcat(\"geoRedundantBackup:\", properties['backup']['geoRedundantBackup'])\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "2ab85a67-26be-4ed2-a0bb-101b2513ec63",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/postgresql/flexible-server/concepts-read-replicas",
        "name": "Azure Database for PostgreSQL - フレキシブル サーバーの読み取りレプリカ"
      }
    ],
    "recommendationControl": "Disaster Recovery",
    "longDescription": "1 つ以上の読み取りレプリカを構成して、障害や障害が発生した場合でもデータベースの可用性と耐久性の目標を確実に満たすようにします。\n",
    "pgVerified": true,
    "description": "1 つ以上の読み取りレプリカを構成する",
    "potentialBenefits": "Recover from regional failure and/or disaster",
    "tags": null,
    "recommendationResourceType": "Microsoft.DBforPostgreSQL/flexibleServers",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Find Database for PostgreSQL instances that are read replicas\nresources\n| where type == \"microsoft.dbforpostgresql/flexibleservers\"\n| where properties.replicationRole == \"AsyncReplica\"\n| project recommendationId = \"2ab85a67-26be-4ed2-a0bb-101b2513ec63\", name, id, tags, param1 = strcat(\"replicationRole:\", properties['replicationRole'])\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "6293a3cc-6b4a-4c0f-9ea7-b8ae8d7dd3d5",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/postgresql/flexible-server/how-to-auto-grow-storage-portal",
        "name": "Azure Database for PostgreSQL - フレキシブル サーバーでの Azure portal を使用したストレージの自動拡張"
      }
    ],
    "recommendationControl": "Scalability",
    "longDescription": "ストレージの自動拡張を構成して、サーバーのストレージが不足して読み取り専用になるのを防ぎます。\n",
    "pgVerified": false,
    "description": "ストレージの自動拡張を構成する",
    "potentialBenefits": "Scale storage automatically to meet increasing demand",
    "tags": null,
    "recommendationResourceType": "Microsoft.DBforPostgreSQL/flexibleServers",
    "recommendationImpact": "High",
    "automationAvailable": false,
    "query": "// cannot-be-validated-with-arg\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "e93bb813-b356-48f3-9bdf-a06a0a6ba039",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/ja-jp/azure/site-recovery/azure-to-azure-network-mapping#set-up-ip-addressing-for-target-vms",
        "name": "Setup network mapping for site recovery"
      }
    ],
    "recommendationControl": "Disaster Recovery",
    "longDescription": "フェールオーバー中に一貫した IP 割り当てを維持するために、フェールオーバー サブネットで VM フェールオーバー設定の静的 IP アドレスが使用可能であることを確認し、ターゲット VM は同じ静的 IP (使用可能な場合) または次に使用可能な IP を受け取ります。IP の調整は、VM ネットワーク設定で行うことができます。\n",
    "pgVerified": true,
    "description": "Site Recovery VM のフェールオーバー設定の静的 IP アドレスがフェールオーバー サブネットで使用できることを確認する",
    "potentialBenefits": "Smooth failover IP management",
    "tags": null,
    "recommendationResourceType": "Microsoft.RecoveryServices/vaults",
    "recommendationImpact": "High",
    "automationAvailable": false,
    "query": "// cannot-be-validated-with-arg\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "17e877f7-3a89-4205-8a24-0670de54ddcd",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/ja-jp/azure/site-recovery/azure-to-azure-tutorial-dr-drill#run-a-test-failover",
        "name": "Run a test failover"
      }
    ],
    "recommendationControl": "Disaster Recovery",
    "longDescription": "テスト フェールオーバーを実行して BCDR 戦略を検証し、運用環境に影響を与えることなく、アプリケーションがターゲット リージョンで正しく機能していることを確認します。テスト フェールオーバーを使用して、データの損失やダウンタイムなしでディザスター リカバリー計画を定期的にテストします。\n",
    "pgVerified": true,
    "description": "Site Recovery テスト フェールオーバーを使用して VM の機能を検証し、ターゲットでのパフォーマンスを確認する",
    "potentialBenefits": "Ensures BCDR plan accuracy and VM performance",
    "tags": null,
    "recommendationResourceType": "Microsoft.RecoveryServices/vaults",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Find all VMs where replication has been enabled but Test Failover was never performed\nrecoveryservicesresources\n| where type == \"microsoft.recoveryservices/vaults/replicationfabrics/replicationprotectioncontainers/replicationprotecteditems\"\n| where properties.providerSpecificDetails.dataSourceInfo.datasourceType == 'AzureVm' and isnull(properties.lastSuccessfulTestFailoverTime)\n| project recommendationId=\"17e877f7-3a89-4205-8a24-0670de54ddcd\" , name = properties.providerSpecificDetails.recoveryAzureVMName, id=properties.providerSpecificDetails.dataSourceInfo.resourceId\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "2912472d-0198-4bdc-aa90-37f145790edc",
    "recommendationTypeId": "06578866-1877-41e6-9d22-3ea5122e8048",
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/backup/move-to-azure-monitor-alerts",
        "name": "Move to Azure monitor Alerts"
      },
      {
        "url": "https://azure.microsoft.com/updates/transition-to-builtin-azure-monitor-alerts-for-recovery-services-vaults-in-azure-backup-by-31-march-2026/",
        "name": "Classic alerts retirement announcement"
      }
    ],
    "recommendationControl": "Monitoring and Alerting",
    "longDescription": "Azure Backup の Recovery Services コンテナーのクラシック アラートは、2026 年 3 月 31 日に廃止されます。\n",
    "pgVerified": true,
    "description": "クラシック アラートから Azure Recovery Services コンテナーの組み込みの Azure Monitor アラートに移行する",
    "potentialBenefits": "Enhanced, scalable, and consistent alerting.",
    "tags": null,
    "recommendationResourceType": "Microsoft.RecoveryServices/vaults",
    "recommendationImpact": "Medium",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// This Resource Graph query will return all Recovery services vault with Classic alerts enabled.\nresources\n| where type in~ ('microsoft.recoveryservices/vaults')\n| extend monitoringSettings = parse_json(properties).monitoringSettings\n| extend isUsingClassicAlerts = case(isnull(monitoringSettings),'Enabled',monitoringSettings.classicAlertSettings.alertsForCriticalOperations)\n| extend isUsingJobsAlerts = case(isnull(monitoringSettings), 'Enabled', monitoringSettings.azureMonitorAlertSettings.alertsForAllJobFailures)\n| where isUsingClassicAlerts == 'Enabled'\n| project recommendationId = \"2912472d-0198-4bdc-aa90-37f145790edc\", name, id, tags, param1=strcat(\"isUsingClassicAlerts: \", isUsingClassicAlerts), param2=strcat(\"isUsingJobsAlerts: \", isUsingJobsAlerts)\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "1549b91f-2ea0-4d4f-ba2a-4596becbe3de",
    "recommendationTypeId": "9b1308f1-4c25-4347-a061-7cc5cd6a44ab",
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/backup/backup-create-recovery-services-vault#set-cross-region-restore",
        "name": "Set Cross Region Restore"
      },
      {
        "url": "https://learn.microsoft.com/azure/backup/guidance-best-practices",
        "name": "Azure Backup Best Practices"
      },
      {
        "url": "https://learn.microsoft.com/azure/backup/backup-rbac-rs-vault#minimum-role-requirements-for-azure-vm-backup",
        "name": "Minimum Role Requirements for Cross Region Restore"
      },
      {
        "url": "https://learn.microsoft.com/azure/backup/backup-azure-arm-vms-prepare",
        "name": "Recovery Services Vault"
      }
    ],
    "recommendationControl": "Disaster Recovery",
    "longDescription": "リージョン間の復元を使用すると、セカンダリの Azure ペア リージョンで Azure VM を復元できるため、監査やコンプライアンスの訓練が容易になり、プライマリ リージョンで障害が発生した場合に VM やディスクを復旧できます。これは、GRS Vault でのみ利用可能なオプトイン機能です。\n",
    "pgVerified": true,
    "description": "GRS Recovery Services コンテナーのリージョン間復元を有効にする",
    "potentialBenefits": "Enhances disaster recovery capabilities",
    "tags": null,
    "recommendationResourceType": "Microsoft.RecoveryServices/vaults",
    "recommendationImpact": "Medium",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Displays all recovery services vaults that do not have cross region restore enabled\nresources\n| where type =~ \"Microsoft.RecoveryServices/vaults\" and\n    properties.redundancySettings.standardTierStorageRedundancy =~ \"GeoRedundant\" and\n    properties.redundancySettings.crossRegionRestore !~ \"Enabled\"\n| extend\n    param1 = strcat(\"CrossRegionRestore: \", properties.redundancySettings.crossRegionRestore),\n    param2 = strcat(\"StorageReplicationType: \", properties.redundancySettings.standardTierStorageRedundancy)\n| project recommendationId = \"1549b91f-2ea0-4d4f-ba2a-4596becbe3de\", name, id, tags, param1, param2\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "9e39919b-78af-4a0b-b70f-c548dae97c25",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/backup/backup-azure-security-feature-cloud?tabs=azure-portal",
        "name": "Soft Delete for Azure Backup"
      }
    ],
    "recommendationControl": "Disaster Recovery",
    "longDescription": "論理的な削除では、バックアップ データが削除された場合、バックアップ データはさらに 14 日間保持されるため、データを失うことなく、コストをかけずにそのバックアップ項目を回復できます。論理的な削除は既定で有効になっています。この機能を無効にすることはお勧めしません。\n",
    "pgVerified": false,
    "description": "Azure Backup で Recovery Services コンテナーの論理的な削除を有効にする",
    "potentialBenefits": "Enhances disaster recovery capabilities",
    "tags": null,
    "recommendationResourceType": "Microsoft.RecoveryServices/vaults",
    "recommendationImpact": "Medium",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Find all Azure Recovery Services vaults that do not have soft delete  enabled\nresources\n| where type == \"microsoft.recoveryservices/vaults\"\n| mv-expand issoftDelete=properties.securitySettings.softDeleteSettings.softDeleteState\n| where issoftDelete == 'Disabled'\n| project recommendationId = \"9e39919b-78af-4a0b-b70f-c548dae97c25\", name, id, tags, param1=strcat(\"Soft Delete: \",issoftDelete)\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "eb005943-40a8-194b-9db2-474d430046b7",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/container-registry/container-registry-best-practices",
        "name": "Azure Container Registry のベスト プラクティス"
      }
    ],
    "recommendationControl": "Scalability",
    "longDescription": "パフォーマンスのニーズを満たすために、Azure Container Registry のサービス レベルを選択します。Premium は、大規模なデプロイに対して、最大の帯域幅と最高の読み取りおよび書き込み操作レートを提供します。開始するには Basic、運用には Standard、ハイパースケール パフォーマンスと geo レプリケーションには Premium を使用します。\n",
    "pgVerified": false,
    "description": "重要な運用ワークロードに Premium レベルを使用する",
    "potentialBenefits": "High-volume support and geo-replication",
    "tags": null,
    "recommendationResourceType": "Microsoft.ContainerRegistry/registries",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Find all Container Registries that are not using the Premium tier\nresources\n| where type =~ \"microsoft.containerregistry/registries\"\n| where sku.name != \"Premium\"\n| project recommendationId = \"eb005943-40a8-194b-9db2-474d430046b7\", name, id, tags, param1=strcat(\"SkuName: \", tostring(sku.name))\n| order by id asc\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "63491f70-22e4-3b4a-8b0c-845450e46fac",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/container-registry/zone-redundancy?toc=%2Fazure%2Freliability%2Ftoc.json&bc=%2Fazure%2Freliability%2Fbreadcrumb%2Ftoc.json",
        "name": "Azure Container Registry のベスト プラクティス - ゾーン冗長を有効にする"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "Azure Container Registry のオプションのゾーン冗長は、複数のゾーンにリソースを分散することで、特定のリージョン内のレジストリまたはレプリケーション リソースの回復性と高可用性を強化します。\n",
    "pgVerified": false,
    "description": "ゾーン冗長を有効にする",
    "potentialBenefits": "Enhances resiliency and high availability",
    "tags": null,
    "recommendationResourceType": "Microsoft.ContainerRegistry/registries",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Find all Container Registries that do not have zone redundancy enabled\nresources\n| where type =~ \"microsoft.containerregistry/registries\"\n| where properties.zoneRedundancy != \"Enabled\"\n| project recommendationId = \"63491f70-22e4-3b4a-8b0c-845450e46fac\", name, id, tags, param1=strcat(\"zoneRedundancy: \", tostring(properties.zoneRedundancy))\n| order by id asc\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "36ea6c09-ef6e-d743-9cfb-bd0c928a430b",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/container-registry/container-registry-best-practices#geo-replicate-multi-region-deployments",
        "name": "Azure Container Registry のベスト プラクティス - Geo レプリケーション転送を有効にする"
      },
      {
        "url": "https://learn.microsoft.com/azure/container-registry/container-registry-geo-replication",
        "name": "Azure Container Registry の geo レプリケーション"
      }
    ],
    "recommendationControl": "Disaster Recovery",
    "longDescription": "複数リージョンのデプロイに Azure Container Registry の geo レプリケーションを使用して、レジストリ管理を簡素化し、待機時間を最小限に抑えます。これにより、ローカル データセンターからグローバルな顧客にサービスを提供でき、分散した開発チームをサポートします。リージョン Webhook は、レプリカ内のイベントを通知できます。\n",
    "pgVerified": false,
    "description": "geo レプリケーションを有効にする",
    "potentialBenefits": "Simplifies management, reduces latency",
    "tags": null,
    "recommendationResourceType": "Microsoft.ContainerRegistry/registries",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Find all Container Registries that do not have geo-replication enabled\nresources\n| where type =~ \"microsoft.containerregistry/registries\"\n| project registryName = name, registryId = id, tags, primaryRegion = location\n| join kind=leftouter (\n    Resources\n    | where type =~ \"microsoft.containerregistry/registries/replications\"\n    | project replicationRegion=name, replicationId = id\n    | extend registryId=strcat_array(array_slice(split(replicationId, '/'), 0, -3), '/')\n    ) on registryId\n| project-away registryId1, replicationId\n| where isempty(replicationRegion)\n| project recommendationId = \"36ea6c09-ef6e-d743-9cfb-bd0c928a430b\", name=registryName, id=registryId, tags\n| order by id asc\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "a5a0101a-a240-8742-90ba-81dbde9a0c0c",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/container-registry/container-registry-best-practices#repository-namespaces",
        "name": "Azure Container Registry のベスト プラクティス - リポジトリの名前空間を使用する"
      }
    ],
    "recommendationControl": "Security",
    "longDescription": "リポジトリの名前空間を使用すると、組織内の複数のグループおよびデプロイメント間で単一のレジストリを共有でき、グループ分離のためにネストされた名前空間をサポートできます。ただし、リポジトリは階層的ではなく、独立して管理されます。\n",
    "pgVerified": false,
    "description": "リポジトリの名前空間を使用する",
    "potentialBenefits": "Enables sharing and group isolation",
    "tags": null,
    "recommendationResourceType": "Microsoft.ContainerRegistry/registries",
    "recommendationImpact": "Low",
    "automationAvailable": false,
    "query": "// cannot-be-validated-with-arg\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "8e389532-5db5-7e4c-9d4d-443b3e55ae82",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/container-registry/container-registry-best-practices#dedicated-resource-group",
        "name": "Azure Container Registry のベスト プラクティス - 専用のリソース グループを使用する"
      }
    ],
    "recommendationControl": "Governance",
    "longDescription": "複数のホストで使用されるコンテナー レジストリは、コンテナー インスタンスが削除されたときにイメージが誤って削除されるのを防ぎ、ホストで実験している間もイメージ コレクションを保持するために、独自のリソース グループに配置する必要があります。\n",
    "pgVerified": false,
    "description": "Container Registry を専用リソース グループに移動する",
    "potentialBenefits": "Safeguards image collection",
    "tags": null,
    "recommendationResourceType": "Microsoft.ContainerRegistry/registries",
    "recommendationImpact": "Low",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// List container registries that contain additional resources within the same resource group.\nresources\n| where type =~ \"microsoft.containerregistry/registries\"\n| project registryName=name, registryId=id, registryTags=tags, resourceGroupId=strcat('/subscriptions/', subscriptionId, '/resourceGroups/', resourceGroup), resourceGroup, subscriptionId\n| join kind=inner (\n    resources\n    | where not(type =~ \"microsoft.containerregistry/registries\")\n    | summarize recourceCount=count() by subscriptionId, resourceGroup\n    | where recourceCount != 0\n) on resourceGroup, subscriptionId\n| project recommendationId = \"8e389532-5db5-7e4c-9d4d-443b3e55ae82\", name=registryName, id=registryId, tags=registryTags, param1=strcat('resourceGroupName:',resourceGroup), param2=strcat('resourceGroupId:',resourceGroupId)\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "3ef86f16-f65b-c645-9901-7830d6dc3a1b",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/container-registry/container-registry-best-practices#manage-registry-size",
        "name": "Azure Container Registry のベスト プラクティス - レジストリ サイズを管理する"
      },
      {
        "url": "https://learn.microsoft.com/azure/container-registry/container-registry-retention-policy#about-the-retention-policy",
        "name": "アイテム保持ポリシー"
      }
    ],
    "recommendationControl": "Scalability",
    "longDescription": "Azure Container Registry のサービス レベルのストレージの制約は、使用シナリオ (初心者向けの Basic、運用環境向けの Standard、大規模なパフォーマンスと geo レプリケーション向けの Premium) に合わせて調整されます。\n",
    "pgVerified": false,
    "description": "レジストリ サイズを管理する",
    "potentialBenefits": "Reduce costs, optimize storage",
    "tags": null,
    "recommendationResourceType": "Microsoft.ContainerRegistry/registries",
    "recommendationImpact": "Medium",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Find all Container Registries that have their retention policy disabled\nresources\n| where type =~ \"microsoft.containerregistry/registries\"\n| where properties.policies.retentionPolicy.status == \"disabled\"\n| project recommendationId = \"3ef86f16-f65b-c645-9901-7830d6dc3a1b\", name, id, tags, param1='retentionPolicy:disabled'\n| order by id asc\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "03f4a7d8-c5b4-7842-8e6e-14997a34842b",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/container-registry/anonymous-pull-access#about-anonymous-pull-access",
        "name": "匿名プル アクセスの概要"
      }
    ],
    "recommendationControl": "Security",
    "longDescription": "既定では、Azure Container Registry では、プッシュ/プル アクションの認証が必要です。匿名プル アクセスを有効にすると、すべてのコンテンツがパブリック読み取りアクションに公開されます。これはすべてのリポジトリに適用され、リポジトリ スコープのトークンが使用されている場合は、無制限のアクセスが許可される可能性があります。\n",
    "pgVerified": false,
    "description": "匿名プル アクセスを無効にする",
    "potentialBenefits": "Enhanced security and controlled access",
    "tags": null,
    "recommendationResourceType": "Microsoft.ContainerRegistry/registries",
    "recommendationImpact": "Medium",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Find all Container Registries that have anonymous pull access enabled\nresources\n| where type =~ \"microsoft.containerregistry/registries\"\n| where properties.anonymousPullEnabled == \"true\"\n| project recommendationId = \"03f4a7d8-c5b4-7842-8e6e-14997a34842b\", name, id, tags\n| order by id asc\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "44107155-7a32-9348-89f3-d5aa7e7c5a1d",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/container-registry/monitor-service-reference#resource-logs",
        "name": "Azure Container Registry データ監視のリファレンス - リソース ログ"
      },
      {
        "url": "https://learn.microsoft.com/azure/container-registry/monitor-service#collection-and-routing",
        "name": "Azure Container Registry の監視 - 診断ログを有効にする"
      }
    ],
    "recommendationControl": "Monitoring and Alerting",
    "longDescription": "リソース ログは、診断設定を作成して 1 つ以上の場所にルーティングするまで収集および保存されません。\n",
    "pgVerified": false,
    "description": "すべての Azure Container Registry の診断設定を構成する",
    "potentialBenefits": "Enhanced tracking and debugging",
    "tags": null,
    "recommendationResourceType": "Microsoft.ContainerRegistry/registries",
    "recommendationImpact": "Medium",
    "automationAvailable": false,
    "query": "// cannot-be-validated-with-arg\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "d594cde6-4116-d143-a64a-25f63289a2f8",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/container-registry/monitor-service-reference#metrics",
        "name": "Azure Container Registry データ監視のリファレンス"
      },
      {
        "url": "https://learn.microsoft.com/azure/container-registry/monitor-service",
        "name": "Azure Container Registry の監視"
      }
    ],
    "recommendationControl": "Monitoring and Alerting",
    "longDescription": "Azure Monitor を使用して Azure リソースを監視すると、その可用性、パフォーマンス、操作が向上します。フルスタック監視サービスである Azure Container Registry は、Azure やその他のクラウドおよびオンプレミスのリソースに機能を提供します。\n",
    "pgVerified": false,
    "description": "Azure Monitor を使用して Azure Container Registry を監視する",
    "potentialBenefits": "Enhanced monitoring and operation",
    "tags": null,
    "recommendationResourceType": "Microsoft.ContainerRegistry/registries",
    "recommendationImpact": "Medium",
    "automationAvailable": false,
    "query": "// cannot-be-validated-with-arg\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "e7f0fd54-fba0-054e-9ab8-e676f2851f88",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/container-registry/container-registry-soft-delete-policy",
        "name": "論理的な削除ポリシーを有効にする"
      }
    ],
    "recommendationControl": "Disaster Recovery",
    "longDescription": "Azure Container Registry (ACR) で論理的な削除を有効にすると、削除された成果物を指定した保持期間で管理できます。ユーザーは、保持後に自動的に消去されるまで、これらの成果物を一覧表示、フィルタリング、復元できます。\n",
    "pgVerified": false,
    "description": "論理的な削除ポリシーを有効にする",
    "potentialBenefits": "Recovery of deleted artifacts",
    "tags": null,
    "recommendationResourceType": "Microsoft.ContainerRegistry/registries",
    "recommendationImpact": "Medium",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Provides a list of Azure Container Registry resources that do not have soft delete enabled\nresources\n| where type =~ \"microsoft.containerregistry/registries\"\n| where properties.policies.softDeletePolicy.status == \"disabled\"\n| project recommendationId = \"e7f0fd54-fba0-054e-9ab8-e676f2851f88\", name, id, tags\n| order by id asc\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "1ceea4b5-1d8b-4be0-9bbe-9594557be51a",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/ja-jp/azure/expressroute/traffic-collector",
        "name": "Azure ExpressRoute Traffic Collector"
      }
    ],
    "recommendationControl": "Monitoring and Alerting",
    "longDescription": "Traffic Collector は、ExpressRoute Direct やサービス プロバイダー ベースの回線上のネットワーク フローをサンプリングし、フロー ログを Log Analytics ワークスペースに送信して分析したり、可視化ツールや SIEM にエクスポートしたりできます。\n",
    "pgVerified": true,
    "description": "Direct やプロバイダー回線で ExpressRoute Traffic Collector が有効に構成されていることを確認する",
    "potentialBenefits": "Enhanced network flow analysis and DR readiness",
    "tags": null,
    "recommendationResourceType": "Microsoft.NetworkFunction/azureTrafficCollectors",
    "recommendationImpact": "Medium",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "baf3bfc0-32a2-4c0c-926d-c9bf0b49808e",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/api-management/upgrade-and-scale#change-your-api-management-service-tier",
        "name": "API Management サービス レベルを変更する"
      },
      {
        "url": "https://learn.microsoft.com/azure/reliability/migrate-api-mgt",
        "name": "Azure API Management を可用性ゾーンに移行する"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "API Management インスタンスを Premium SKU にアップグレードすると、Availability Zones のサポートが追加され、Azure リージョン内の物理的に離れた場所にサービスを分散することで、可用性と回復性が向上します。\n",
    "pgVerified": false,
    "description": "Availability Zones をサポートするために API Management サービスを Premium SKU に移行する",
    "potentialBenefits": "Enhanced availability and resilience",
    "tags": null,
    "recommendationResourceType": "Microsoft.ApiManagement/service",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Find all API Management instances that aren't Premium\nresources\n| where type =~ 'Microsoft.ApiManagement/service'\n| extend skuName = sku.name\n| where tolower(skuName) != tolower('premium')\n| project recommendationId = \"baf3bfc0-32a2-4c0c-926d-c9bf0b49808e\", name, id, tags, param1=strcat(\"SKU: \", skuName)\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "740f2c1c-8857-4648-80eb-47d2c56d5a50",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/api-management/high-availability#availability-zones",
        "name": "API Management の可用性と信頼性を確保する"
      },
      {
        "url": "https://learn.microsoft.com/azure/reliability/migrate-api-mgt",
        "name": "Azure API Management を可用性ゾーンに移行する"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "APIM インスタンスのゾーン冗長により、ゲートウェイとコントロール プレーン (管理 API、開発者ポータル、Git 構成) が物理的に分離されたゾーン内のデータセンター間でレプリケートされ、ゾーン障害に対する回復性が向上します。\n",
    "pgVerified": false,
    "description": "Premium API Management インスタンスで可用性ゾーンを有効にする",
    "potentialBenefits": "Improved resilience to zone failures",
    "tags": null,
    "recommendationResourceType": "Microsoft.ApiManagement/service",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Find all Premium API Management instances that aren't zone redundant\nresources\n| where type =~ 'Microsoft.ApiManagement/service'\n| extend skuName = sku.name\n| where tolower(skuName) == tolower('premium')\n| where isnull(zones) or array_length(zones) < 2\n| extend zoneValue = iff((isnull(zones)), \"null\", zones)\n| project recommendationId = \"740f2c1c-8857-4648-80eb-47d2c56d5a50\", name, id, tags, param1=\"Zones: No Zone or Zonal\", param2=strcat(\"Zones value: \", zoneValue )\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "e35cf148-8eee-49d1-a1c9-956160f99e0b",
    "recommendationTypeId": "e5f60ef8-3fcc-4fb5-bee7-7aaeb44c1509",
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/api-management/breaking-changes/stv1-platform-retirement-august-2024",
        "name": "Azure API Management - stv1 プラットフォームの廃止 (2024 年 8 月)"
      },
      {
        "url": "https://learn.microsoft.com/azure/api-management/compute-infrastructure",
        "name": "Azure API Management のコンピューティング プラットフォーム"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "stv1 は 2024 年 8 月 31 日に廃止されるため、API Management stv2 へのアップグレードが必要であり、新しいプラットフォーム バージョンで拡張機能が提供されます。\n",
    "pgVerified": false,
    "description": "Azure API Management プラットフォームのバージョンは stv2 である必要がある",
    "potentialBenefits": "Ensures service continuity",
    "tags": null,
    "recommendationResourceType": "Microsoft.ApiManagement/service",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Find all API Management instances that aren't upgraded to platform version stv2\nresources\n| where type =~ 'Microsoft.ApiManagement/service'\n| extend plat_version = properties.platformVersion\n| extend skuName = sku.name\n| where tolower(plat_version) != tolower('stv2')\n| project recommendationId = \"e35cf148-8eee-49d1-a1c9-956160f99e0b\", name, id, tags, param1=strcat(\"Platform Version: \", plat_version) , param2=strcat(\"SKU: \", skuName)\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "c79680ea-de85-44fa-a596-f31fa17a952f",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/api-management/api-management-howto-autoscale",
        "name": "Azure API Management の自動スケールを設定する"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "API Management と Auto-Scale を使用して、トラフィック パターンが変動するワークロードで高可用性を実現します。自動スケールにはいくつかの制限があるため、ドキュメントを確認して要件を満たしていることを確認してください。\n",
    "pgVerified": false,
    "description": "API Management サービスで運用ワークロードの自動スケーリングを有効にする",
    "potentialBenefits": "Enhanced availability and resilience",
    "tags": null,
    "recommendationResourceType": "Microsoft.ApiManagement/service",
    "recommendationImpact": "Low",
    "automationAvailable": false,
    "query": "// cannot-be-validated-with-arg\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "bb4c8db4-f821-475b-b1ea-16e95358665e",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/azure-app-configuration/concept-soft-delete#purge-protection",
        "name": "消去保護"
      }
    ],
    "recommendationControl": "Governance",
    "longDescription": "消去保護を有効にすると、論理的に削除されたストアを保持期間中に消去することはできません。無効にすると、保存期間が終了する前に、論理的に削除されたストアを削除できます。\n",
    "pgVerified": false,
    "description": "Azure App Configuration の消去保護を有効にする",
    "potentialBenefits": "Prevent accidental deletion of configuration stores.",
    "tags": null,
    "recommendationResourceType": "Microsoft.AppConfiguration/configurationStores",
    "recommendationImpact": "Low",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Purge protection should be enabled for App Configuration stores to prevent accidental deletion of configuration data.\nresources\n| where type =~ \"Microsoft.AppConfiguration/configurationStores\"\n| where sku.name <> \"free\"\n| where (properties.enablePurgeProtection <> true) or isnull(properties.enablePurgeProtection )\n| project recommendationId = \"bb4c8db4-f821-475b-b1ea-16e95358665e\", name, id, tags, param1 = \"Enable purge protection\"\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "2102a57a-a056-4d5e-afe5-9df9f92177ca",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/ja-jp/azure/azure-app-configuration/faq#---app-configuration---------------",
        "name": "App Configuration レベルを選択する"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "SLA は Free レベルでは使用できません。Standard レベルにアップグレードして 99.9% の SLA を取得します。\n",
    "pgVerified": false,
    "description": "App Configuration Standard レベルにアップグレードする",
    "potentialBenefits": "High availability, more storage, higher request quota.",
    "tags": null,
    "recommendationResourceType": "Microsoft.AppConfiguration/configurationStores",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Upgrade to App Configuration Standard tier\nresources\n| where type =~ \"Microsoft.AppConfiguration/configurationStores\"\n| where sku.name == \"free\"\n| project recommendationId = \"2102a57a-a056-4d5e-afe5-9df9f92177ca\", name, id, tags, param1 = \"Upgrade to Standard SKU\"\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "1cca00d2-d9ab-8e42-a788-5d40f49405cb",
    "recommendationTypeId": "78211c00-15a9-336e-17c4-0b48613dadf4",
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/key-vault/general/soft-delete-overview",
        "name": "Azure Key Vault の論理的な削除の概要"
      }
    ],
    "recommendationControl": "Disaster Recovery",
    "longDescription": "Key Vault の論理的な削除機能を使用すると、削除された Key Vault と、キー、シークレット、証明書などのオブジェクトを回復できます。有効にすると、マークされたリソースは 90 日間保持され、復元が可能になり、基本的に削除が取り消されます。\n",
    "pgVerified": false,
    "description": "Key Vault で論理的な削除が有効になっている必要がある",
    "potentialBenefits": "Enables recovery of deleted items",
    "tags": null,
    "recommendationResourceType": "Microsoft.KeyVault/vaults",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// This Resource Graph query will return all Key Vaults that do not have soft delete enabled.\nresources\n| where type == \"microsoft.keyvault/vaults\"\n| where isnull(properties.enableSoftDelete) or properties.enableSoftDelete != \"true\"\n| project recommendationId = \"1cca00d2-d9ab-8e42-a788-5d40f49405cb\", name, id, tags, param1 = \"EnableSoftDelete: Disabled\"\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "70fcfe6d-00e9-5544-a63a-fff42b9f2edb",
    "recommendationTypeId": "4ed62ae4-5072-f9e7-8d94-51c76c48159a",
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/key-vault/general/soft-delete-overview#purge-protection",
        "name": "Azure Key Vault 消去保護の概要"
      }
    ],
    "recommendationControl": "Disaster Recovery",
    "longDescription": "消去保護は、論理的に削除された Key Vault の保持期間を適用することで悪意のある削除から保護し、この期間中に内部関係者や Microsoft であっても誰も Key Vault を消去できないようにし、永続的なデータ損失を防ぎます。\n",
    "pgVerified": false,
    "description": "Key Vault で消去保護が有効になっている必要がある",
    "potentialBenefits": "Protects from insider attacks, avoids data loss",
    "tags": null,
    "recommendationResourceType": "Microsoft.KeyVault/vaults",
    "recommendationImpact": "Medium",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// This resource graph query will return all Key Vaults that do not have Purge Protection enabled.\nresources\n| where type == \"microsoft.keyvault/vaults\"\n| where isnull(properties.enablePurgeProtection) or properties.enablePurgeProtection != \"true\"\n| project recommendationId = \"70fcfe6d-00e9-5544-a63a-fff42b9f2edb\", name, id, tags, param1 = \"EnablePurgeProtection: Disabled\"\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "00c3d2b0-ea6e-4c4b-89be-b78a35caeb51",
    "recommendationTypeId": "2e96bc2f-1972-e471-9e70-ae58d41e9d2a",
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/key-vault/general/security-features#network-security",
        "name": "Azure Key Vault Private Link サービスの概要"
      }
    ],
    "recommendationControl": "Security",
    "longDescription": "Azure Private Link サービスを使用すると、プライベート IP を使用して VNet 内のプライベート エンドポイントを介して Azure Key Vault に安全かつプライベートに接続し、パブリック インターネットへの露出を排除できます。\n",
    "pgVerified": false,
    "description": "プライベート エンドポイントを Key Vault 用に構成する必要がある",
    "potentialBenefits": "Secure Key Vault with Private Link",
    "tags": null,
    "recommendationResourceType": "Microsoft.KeyVault/vaults",
    "recommendationImpact": "Medium",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// This resource graph query will return all Key Vaults that does not have a Private Endpoint Connection or where a private endpoint exists but public access is enabled\n\nresources\n| where type == \"microsoft.keyvault/vaults\"\n| where isnull(properties.privateEndpointConnections) or properties.privateEndpointConnections[0].properties.provisioningState != (\"Succeeded\") or (isnull(properties.networkAcls) and properties.publicNetworkAccess == 'Enabled')\n| extend param1 = strcat('Private Endpoint: ', iif(isnotnull(properties.privateEndpointConnections),split(properties.privateEndpointConnections[0].properties.privateEndpoint.id,'/')[8],'No Private Endpoint'))\n| extend param2 = strcat('Access: ', iif(properties.publicNetworkAccess == 'Disabled', 'Public Access Disabled', iif(isnotnull(properties.networkAcls), 'NetworkACLs in place','Public Access Enabled')))\n| project recommendationId = \"00c3d2b0-ea6e-4c4b-89be-b78a35caeb51\", name, id, tags, param1, param2\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "e7091145-3642-bd41-bb58-66502e64d2cd",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/key-vault/general/best-practices#why-we-recommend-separate-key-vaults",
        "name": "Azure Key Vault を使用するためのベスト プラクティス"
      }
    ],
    "recommendationControl": "Governance",
    "longDescription": "Key Vault は、シークレット ストレージのセキュリティ境界です。シークレットをグループ化すると、攻撃者が複数のシークレットにアクセスする可能性があるため、セキュリティ イベント中のリスクが高まります。\n",
    "pgVerified": false,
    "description": "環境ごとにアプリケーションごとに個別の Key Vault を使用する",
    "potentialBenefits": "Enhanced security, Reduced risk",
    "tags": null,
    "recommendationResourceType": "Microsoft.KeyVault/vaults",
    "recommendationImpact": "High",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "1dc0821d-4f14-7644-bab4-ba208ff5f7fa",
    "recommendationTypeId": "88bbc99c-e5af-ddd7-6105-6150b2bfa519",
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/key-vault/general/logging?tabs=Vault",
        "name": "Azure Key Vault のログ記録"
      }
    ],
    "recommendationControl": "Monitoring and Alerting",
    "longDescription": "ログを有効にし、アラートを設定し、保持要件に準拠して、Key Vault アクセスの監視とセキュリティを強化し、ユーザーのアクセス頻度と ID を詳しく把握します。\n",
    "pgVerified": false,
    "description": "Key Vault の診断ログを有効にする必要がある",
    "potentialBenefits": "Enhanced monitoring and security compliance",
    "tags": null,
    "recommendationResourceType": "Microsoft.KeyVault/vaults",
    "recommendationImpact": "Low",
    "automationAvailable": false,
    "query": "// cannot-be-validated-with-arg\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "b36fd2ac-dd83-664a-ab48-ff7b8d3b189d",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/azure-monitor/logs/logs-data-export",
        "name": "Log Analytics workspace data export in Azure Monitor"
      },
      {
        "url": "https://learn.microsoft.com/azure/azure-monitor/best-practices-logs#configuration-recommendations",
        "name": "Azure Monitor configuration recommendations"
      }
    ],
    "recommendationControl": "Governance",
    "longDescription": "Log Analytics ワークスペースから Azure Storage アカウントへのデータのエクスポートでは、主に他の Azure サービスやツールとのコンプライアンスと統合のために、geo 冗長 (GRS) または geo ゾーン冗長ストレージ (GZRS) を使用して、リージョンの障害に対するデータ保護が強化されます。\n",
    "pgVerified": true,
    "description": "GRS または GZRS への Log Analytics データのエクスポートを有効にする",
    "potentialBenefits": "Enhances compliance and regional fault tolerance",
    "tags": null,
    "recommendationResourceType": "Microsoft.OperationalInsights/workspaces",
    "recommendationImpact": "Medium",
    "automationAvailable": false,
    "query": "// cannot-be-validated-with-arg\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "4b77191c-cc3c-8c4e-844b-0f56d0927890",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/azure-monitor/logs/log-analytics-workspace-health",
        "name": "Monitor Log Analytics workspace health"
      },
      {
        "url": "https://learn.microsoft.com/azure/azure-monitor/best-practices-logs#configuration-recommendations",
        "name": "Azure Monitor configuration recommendations"
      }
    ],
    "recommendationControl": "Monitoring and Alerting",
    "longDescription": "正常性状態アラートは、データセンターまたはリージョンの障害が原因でワークスペースが使用できなくなった場合に、事前に通知されます。\n",
    "pgVerified": true,
    "description": "Log Analytics ワークスペースの正常性状態アラート ルールを作成する",
    "potentialBenefits": "Early alert for workspace failure",
    "tags": null,
    "recommendationResourceType": "Microsoft.OperationalInsights/workspaces",
    "recommendationImpact": "Low",
    "automationAvailable": false,
    "query": "// cannot-be-validated-with-arg\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "f0bf9ae6-25a5-974d-87d5-025abec73539",
    "recommendationTypeId": "eade5b56-eefd-444f-95c8-23f29e5d93cb",
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/virtual-network/concepts-and-best-practices",
        "name": "Azure Virtual Network - Concepts and best practices | Microsoft Learn"
      },
      {
        "url": "https://learn.microsoft.com/ja-jp/azure/vpn-gateway/vpn-gateway-about-vpn-gateway-settings#gwsub",
        "name": "GatewaySUbnet"
      },
      {
        "url": "https://learn.microsoft.com/ja-jp/azure/route-server/route-server-faq#can-i-associate-a-network-security-group-nsg-to-the-routeserversubnet",
        "name": "Can I associate a network security group (NSG) to the RouteServerSubnet?"
      },
      {
        "url": "https://learn.microsoft.com/ja-jp/azure/firewall/firewall-faq#are-network-security-groups--nsgs--supported-on-the-azurefirewallsubnet",
        "name": "Are Network Security Groups (NSGs) supported on the AzureFirewallSubnet?"
      }
    ],
    "recommendationControl": "Security",
    "longDescription": "ネットワーク セキュリティ グループとアプリケーション セキュリティ グループを使用すると、IP、ポート、プロトコルで受信トラフィックと送信トラフィックをフィルター処理し、サブネット レベルでセキュリティ レイヤーを追加できます。\n",
    "pgVerified": true,
    "description": "すべてのサブネットには、ネットワーク セキュリティ グループが関連付けられている必要がある",
    "potentialBenefits": "Enhanced subnet security and traffic control",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/virtualNetworks",
    "recommendationImpact": "Low",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Find Subnets without NSG associated\nresources\n| where type =~ 'Microsoft.Network/virtualnetworks'\n| mv-expand subnets = properties.subnets\n| extend sn = string_size(subnets.properties.networkSecurityGroup)\n| where sn == 0 and subnets.name !in (\"GatewaySubnet\", \"AzureFirewallSubnet\", \"AzureFirewallManagementSubnet\", \"RouteServerSubnet\")\n| project recommendationId = \"f0bf9ae6-25a5-974d-87d5-025abec73539\", name, id, tags, param1 = strcat(\"SubnetName: \", subnets.name), param2 = \"NSG: False\"\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "69ea1185-19b7-de40-9da1-9e8493547a5c",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/architecture/framework/services/networking/azure-virtual-network/reliability",
        "name": "Reliability and Azure Virtual Network - Microsoft Azure Well-Architected Framework | Microsoft Learn"
      }
    ],
    "recommendationControl": "Security",
    "longDescription": "Azure DDoS Protection は、DDoS 攻撃に対する強化された軽減機能を提供し、アプリケーション設計のベスト プラクティスと組み合わせて、仮想ネットワーク内の特定のリソースを保護するように自動調整されます。\n",
    "pgVerified": true,
    "description": "Azure DDoS Standard Protection プランを使用して Azure VNet のパブリック エンドポイントを保護する",
    "potentialBenefits": "Enhanced DDoS attack mitigation",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/virtualNetworks",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Find virtual networks without DDoS Protection\nresources\n| where type =~ 'Microsoft.Network/virtualNetworks'\n| where isnull(properties.enableDdosProtection) or properties.enableDdosProtection contains \"false\"\n| project recommendationId = \"69ea1185-19b7-de40-9da1-9e8493547a5c\", name, id, tags, param1 = strcat(\"EnableDdosProtection: \", properties.enableDdosProtection)\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "24ae3773-cc2c-3649-88de-c9788e25b463",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/virtual-network/virtual-networks-faq",
        "name": "Azure Virtual Network FAQ | Microsoft Learn"
      },
      {
        "url": "https://learn.microsoft.com/azure/architecture/framework/services/networking/network-connectivity/reliability",
        "name": "Reliability and Network connectivity - Microsoft Azure Well-Architected Framework | Microsoft LearnNetworking Reliability"
      },
      {
        "url": "https://learn.microsoft.com/ja-jp/azure/private-link/availability",
        "name": "Azure Private Link availability"
      }
    ],
    "recommendationControl": "Security",
    "longDescription": "VNet サービス エンドポイントは、Private Link が使用できず、データ移動の問題がない場合にのみ使用します。この機能は、Azure サービスへのアクセスを指定された VNet とサブネットに制限し、ネットワーク セキュリティを強化し、サービス トラフィックを分離します。\n",
    "pgVerified": true,
    "description": "使用可能な場合は PaaS サービスのサービス エンドポイントではなくプライベート エンドポイントを使用する",
    "potentialBenefits": "Enhanced security and data isolation",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/virtualNetworks",
    "recommendationImpact": "Medium",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Find Subnets with Service Endpoint enabled for services that offer Private Link\nresources\n| where type =~ 'Microsoft.Network/virtualnetworks'\n| mv-expand subnets = properties.subnets\n| extend se = array_length(subnets.properties.serviceEndpoints)\n| where se >= 1\n| project name, id, tags, subnets, serviceEndpoints=todynamic(subnets.properties.serviceEndpoints)\n| mv-expand serviceEndpoints\n| project name, id, tags, subnetName=subnets.name, serviceName=tostring(serviceEndpoints.service)\n| where serviceName in (parse_json('[\"Microsoft.CognitiveServices\",\"Microsoft.AzureCosmosDB\",\"Microsoft.DBforMariaDB\",\"Microsoft.DBforMySQL\",\"Microsoft.DBforPostgreSQL\",\"Microsoft.EventHub\",\"Microsoft.KeyVault\",\"Microsoft.ServiceBus\",\"Microsoft.Sql\", \"Microsoft.Storage\",\"Microsoft.StorageSync\",\"Microsoft.Synapse\",\"Microsoft.Web\"]'))\n| project recommendationId = \"24ae3773-cc2c-3649-88de-c9788e25b463\", name, id, tags, param1 = strcat(\"subnet=\", subnetName), param2=strcat(\"serviceName=\",serviceName), param3=\"ServiceEndpoints=true\"\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "c63b81fb-7afc-894c-a840-91bb8a8dcfaf",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/virtual-network/ip-services/public-ip-addresses#availability-zone",
        "name": "Public IP addresses - Availability Zones"
      },
      {
        "url": "https://learn.microsoft.com/ja-jp/azure/virtual-network/ip-services/public-ip-basic-upgrade-guidance#steps-to-complete-the-upgrade",
        "name": "Upgrading a basic public IP address to Standard SKU"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "Azure のパブリック IP アドレスは、非ゾーン、ゾーン、またはゾーン冗長として使用できる Standard SKU にすることができます。ゾーン冗長 IP は、すべてのゾーンでアクセスでき、1 つのゾーンの障害に耐えることができるため、回復性が向上します。\n",
    "pgVerified": true,
    "description": "該当する場合は Standard SKU とゾーン冗長 IP を使用する",
    "potentialBenefits": "Enhanced resilience with zone redundancy",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/publicIPAddresses",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph query\n// List public IP addresses that are not Zone-Redundant\nResources\n| where type =~ \"Microsoft.Network/publicIPAddresses\" and sku.tier =~ \"Regional\"\n| where isempty(zones) or array_length(zones) <= 1\n| extend az = case(isempty(zones), \"Non-zonal\", array_length(zones) <= 1, strcat(\"Zonal (\", strcat_array(zones, \",\"), \")\"), zones)\n| project recommendationId = \"c63b81fb-7afc-894c-a840-91bb8a8dcfaf\", name, id, tags, param1 = strcat(\"sku: \", sku.name), param2 = strcat(\"availabilityZone: \", az)\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "1adba190-5c4c-e646-8527-dd1b2a6d8b15",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/advisor/advisor-reference-reliability-recommendations#use-nat-gateway-for-outbound-connectivity",
        "name": "Use NAT GW for outbound connectivity"
      },
      {
        "url": "https://learn.microsoft.com/azure/architecture/framework/services/compute/azure-app-service/reliability#tcp-and-snat-ports",
        "name": "TCP and SNAT Ports"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "仮想ネットワークからの送信トラフィックに NAT Gateway を採用し、動的なスケーリングとセキュリティで保護されたインターネット接続を確保することで、SNAT ポートの枯渇による接続障害を防止します。\n",
    "pgVerified": true,
    "description": "送信接続に NAT Gateway を使用して SNAT の枯渇を回避する",
    "potentialBenefits": "Avoids SNAT port exhaustion risks",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/publicIPAddresses",
    "recommendationImpact": "Medium",
    "automationAvailable": true,
    "query": "// Azure Resource Graph query\n// Lists VMs with PIPs\nresources\n| where type =~ 'Microsoft.Network/publicIPAddresses'\n| where tostring(properties.ipConfiguration.id) contains \"microsoft.network/networkinterfaces\"\n| project recommendationId=\"1adba190-5c4c-e646-8527-dd1b2a6d8b15\", name, id, tags, param1=strcat(\"Migrate from instance IP to NAT Gateway\")\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "5cea1501-6fe4-4ec4-ac8f-f72320eb18d3",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/ja-jp/azure/virtual-network/ip-services/public-ip-basic-upgrade-guidance",
        "name": "Upgrading a basic public IP address to Standard SKU - Guidance"
      },
      {
        "url": "https://azure.microsoft.com/ja-jp/updates/upgrade-to-standard-sku-public-ip-addresses-in-azure-by-30-september-2025-basic-sku-will-be-retired/",
        "name": "Upgrade to Standard SKU public IP addresses in Azure by 30 September 2025 as Basic SKU will be retired"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "Basic SKU パブリック IP アドレスは、2025 年 9 月 30 日に廃止されます。サービスの中断を避けるために、この日より前に Standard SKU のパブリック IP アドレスにアップグレードすることをお勧めします。\n",
    "pgVerified": true,
    "description": "Basic SKU のパブリック IP アドレスを Standard SKU にアップグレードする",
    "potentialBenefits": "Avoids service disruption",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/publicIPAddresses",
    "recommendationImpact": "Medium",
    "automationAvailable": true,
    "query": "// Azure Resource Graph query\n// List Basic SKU public IP addresses\nResources\n| where type =~ \"Microsoft.Network/publicIPAddresses\"\n| where sku.name =~ \"Basic\"\n| project recommendationId = \"5cea1501-6fe4-4ec4-ac8f-f72320eb18d3\", name, id, tags, param1 = strcat(\"sku: \", sku.name)\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "c4254c66-b8a5-47aa-82f6-e7d7fb418f47",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/ja-jp/azure/ddos-protection/ddos-protection-overview",
        "name": "Azure DDoS Protection"
      }
    ],
    "recommendationControl": "Security",
    "longDescription": "DDoS 攻撃は、インターネット経由でパブリックに到達可能な任意のエンドポイントを標的にすることができます。\n",
    "pgVerified": true,
    "description": "パブリック IP アドレスでは DDoS 保護を有効にする必要があります",
    "potentialBenefits": "Avoids service disruption",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/publicIPAddresses",
    "recommendationImpact": "Medium",
    "automationAvailable": true,
    "query": "// Azure Resource Graph query\n// Public IP addresses should have DDoS protection enabled\nresources\n| where type =~ 'Microsoft.Network/publicIPAddresses'\n| where properties.ddosSettings.protectionMode !in~ (\"Enabled\", \"VirtualNetworkInherited\")\n| project recommendationId=\"c4254c66-b8a5-47aa-82f6-e7d7fb418f47\", name, id, tags, param1=strcat(\"Apply either DDoS Network protection or DDoS IP Protrection to the public IP address.\")\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "23b2dfc7-7e5d-9443-9f62-980ca621b561",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/ja-jp/azure/azure-monitor/essentials/activity-log?tabs=powershell",
        "name": "Azure activity log - Azure Monitor | Microsoft Learn"
      }
    ],
    "recommendationControl": "Monitoring and Alerting",
    "longDescription": "Azure Monitor を使用して、ルート テーブルの作成や更新などの操作に対してアラートを作成し、運用リソースの未承認または望ましくない変更を特定します。この設定は、ファイアウォールを回避したり、外部からリソースにアクセスしたりするなど、不適切なルーティング変更を特定するのに役立ちます。\n",
    "pgVerified": true,
    "description": "Azure Monitor を使用してルート テーブルの変更を監視する",
    "potentialBenefits": "Enhanced security and change detection",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/routeTables",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Find all Route Tables without alerts for modification configured.\nresources\n| where type =~ \"Microsoft.Network/routeTables\"\n| project name, id, tags, lowerCaseRouteTableId = tolower(id)\n| join kind = leftouter (\n    resources\n    | where type =~ \"Microsoft.Insights/activityLogAlerts\" and properties.enabled == true\n    | mv-expand scope = properties.scopes\n    | where scope has \"Microsoft.Network/routeTables\"\n    | project alertName = name, conditionJson = dynamic_to_json(properties.condition.allOf), scope\n    | where conditionJson has '\"Administrative\"' and (\n        // Create or Update Route Table\n        (conditionJson has '\"Microsoft.Network/routeTables/write\"') or\n        // All Administrative operations\n        (conditionJson !has '\"Microsoft.Network/routeTables/write\"' and conditionJson !has '\"Microsoft.Network/routeTables/delete\"' and conditionJson !has '\"Microsoft.Network/routeTables/join/action\"')\n        )\n    | project lowerCaseRouteTableIdOfScope = tolower(scope)\n    )\n    on $left.lowerCaseRouteTableId == $right.lowerCaseRouteTableIdOfScope\n| where isempty(lowerCaseRouteTableIdOfScope)\n| project recommendationId = \"23b2dfc7-7e5d-9443-9f62-980ca621b561\", name, id, tags, param1 = \"ModificationAlert: Not configured/Disabled\"\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "89d1166a-1a20-0f46-acc8-3194387bf127",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/ja-jp/azure/azure-resource-manager/management/lock-resources?toc=%2Fazure%2Fvirtual-network%2Ftoc.json&tabs=json",
        "name": "Protect your Azure resources with a lock - Azure Resource Manager | Microsoft Learn"
      }
    ],
    "recommendationControl": "Governance",
    "longDescription": "管理者は、ロックを設定することで、Azure サブスクリプション、リソース グループ、またはリソースを偶発的な削除や変更から保護できます。\n",
    "pgVerified": true,
    "description": "ルート テーブルのロックを設定して、偶発的な変更や削除を防止する",
    "potentialBenefits": "Prevents accidental edits/deletions",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/routeTables",
    "recommendationImpact": "Low",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "4281631c-3d19-4994-8d96-084c2a51a534",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/ja-jp/azure/nat-gateway/nat-gateway-design#scale-a-nat-gateway-to-meet-the-demand-of-a-dynamic-workload",
        "name": "Scale a NAT gateway to meet the demand of a dynamic workload"
      },
      {
        "url": "https://learn.microsoft.com/ja-jp/azure/nat-gateway/nat-metrics#total-snat-connection-count",
        "name": "Total SNAT Connection Count"
      }
    ],
    "recommendationControl": "Scalability",
    "longDescription": "NAT Gateway は、パブリック IP アドレスごとに 64,512 個の SNAT ポートを提供し、最大 16 個のパブリック IP アドレスをサポートします。\"合計 SNAT 接続数\" メトリックを監視して、NAT Gateway の接続制限に近づいているかどうかを判断します。NAT Gateway は、パブリック IP アドレスを追加することでスケーリングできます。\n",
    "pgVerified": false,
    "description": "動的ワークロードの需要を満たすために NAT Gateway をスケーリングする",
    "potentialBenefits": "Enhances reliability and scalability",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/natGateways",
    "recommendationImpact": "Medium",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "babf75d6-6407-4d90-b01e-5a1768e621f5",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/ja-jp/azure/nat-gateway/nat-metrics",
        "name": "What is Azure NAT Gateway metrics and alerts?"
      },
      {
        "url": "https://azure.github.io/azure-monitor-baseline-alerts/services/Network/natGateways/",
        "name": "AMBA - NAT Gateway"
      }
    ],
    "recommendationControl": "Monitoring and Alerting",
    "longDescription": "NAT Gateway の監視とアラートには、Network Insights を使用します。\"合計 SNAT 接続数\" メトリックを使用して、NAT Gateway の接続制限に近づいているかどうかを判断します。NAT Gateway の Azure Monitor Baseline Alerts (AMBA) しきい値に基づいてアラートを設定します。\n",
    "pgVerified": false,
    "description": "NAT Gateway の監視とアラートを構成する",
    "potentialBenefits": "Enhanced network performance and health",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/natGateways",
    "recommendationImpact": "High",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "419df1ea-336b-460a-b6b2-fefe2588fcef",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/ja-jp/azure/nat-gateway/nat-availability-zones#zonal-nat-gateway-resource-for-each-zone-in-a-region-to-create-zone-resiliency",
        "name": "Zonal NAT gateway resource for each zone in a region to create zone-resiliency"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "NAT Gateway リソースを使用する仮想マシンインスタンスが、NAT Gateway リソースとそのパブリック IP アドレスと同じゾーンにある場合、ゾーン分離シナリオのためのゾーン約束が存在します。ゾーン分離に使用したいパターンは、可用性ゾーンごとに \"ゾーン スタック\" を作成することです。\n",
    "pgVerified": false,
    "description": "ゾーン分離シナリオでのゾーン NAT Gateway のデプロイを検討する",
    "potentialBenefits": "Enhances reliability and scalability",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/natGateways",
    "recommendationImpact": "Medium",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "4d703025-dafc-f840-a183-5dc440456134",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/expressroute/designing-for-disaster-recovery-with-expressroute-privatepeering",
        "name": "Designing for disaster recovery with ExpressRoute private peering"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "各 ExpressRoute ゲートウェイを異なるピアリングの場所にある少なくとも 2 つの回線に接続すると、1 つの回線で障害が発生した場合にデータの代替経路が確保されるため、冗長性と信頼性が向上します。\n",
    "pgVerified": true,
    "description": "オンプレミス ネットワークを複数の ExpressRoute 経由で Azure の重要なワークロードに接続する",
    "potentialBenefits": "Enhanced reliability and redundancy",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/expressRouteCircuits",
    "recommendationImpact": "High",
    "automationAvailable": false,
    "query": "// cannot-be-validated-with-arg\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "0e19cc41-8274-1342-b0db-0e4146eacef8",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/ja-jp/azure/expressroute/designing-for-high-availability-with-expressroute",
        "name": "Designing for high availability with ExpressRoute"
      },
      {
        "url": "https://learn.microsoft.com/azure/well-architected/services/networking/azure-expressroute#recommendations",
        "name": "Azure Well-Architected Framework review - Azure ExpressRoute - Design Checklist"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "Microsoft または ExpressRoute プロバイダーは、サービスの物理的な冗長性を常に確保します。最適なパフォーマンスと信頼性を得るには、ExpressRoute ピアリングの場所からネットワークへのこのレベルの物理冗長性 (2 つのデバイス、2 つのリンク) を維持することが不可欠です。\n",
    "pgVerified": true,
    "description": "ExpressRoute の物理リンクが個別のネットワーク エッジ デバイスに接続されていることを確認する",
    "potentialBenefits": "Enhanced reliability and fault tolerance",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/expressRouteCircuits",
    "recommendationImpact": "High",
    "automationAvailable": false,
    "query": "// cannot-be-validated-with-arg\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "f06a2bbe-5839-d447-9f39-fc3d20562d88",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/expressroute/designing-for-high-availability-with-expressroute#active-active-connections",
        "name": "Designing for high availability with ExpressRoute - Active-active connections"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "ExpressRoute 回線の両方の接続をアクティブ/アクティブ モードで運用すると、Microsoft ネットワークがフローごとに接続間でトラフィックの負荷を分散するため、高可用性が向上します。\n",
    "pgVerified": true,
    "description": "ExpressRoute 回線の両方の接続がアクティブ/アクティブ モードで構成されていることを確認する",
    "potentialBenefits": "Improved high availability and load balancing",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/expressRouteCircuits",
    "recommendationImpact": "High",
    "automationAvailable": false,
    "query": "// cannot-be-validated-with-arg\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "2a5bf650-586d-db4c-a292-d922be7d3e0e",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/expressroute/expressroute-bfd",
        "name": "Configure BFD over ExpressRoute"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "ExpressRoute 経由で BFD を有効にすると、MSEE デバイスと ExpressRoute 用に構成されたルーター (CE/PE) 間のリンク障害検出が高速化され、マネージド レイヤー 3 サービスを使用する顧客とパートナー エッジの両方のルーティング デバイスに適用できます。\n",
    "pgVerified": true,
    "description": "エッジ デバイスで双方向フォワーディング検出を有効にして、フェイルオーバーを高速化する",
    "potentialBenefits": "Faster link failure detection",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/expressRouteCircuits",
    "recommendationImpact": "High",
    "automationAvailable": false,
    "query": "// cannot-be-validated-with-arg\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "9771a435-d031-814e-9827-9b5fdafc0f87",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://azure.github.io/azure-monitor-baseline-alerts/services/Network/expressRouteCircuits/",
        "name": "Azure Monitor Baseline Alerts - expressRouteCircuits"
      }
    ],
    "recommendationControl": "Monitoring and Alerting",
    "longDescription": "Network Insights を使用して、ExpressRoute 回線の可用性、QoS、スループットを監視します。Azure Monitor ベースライン アラートに基づいて、可用性、QoS メトリック、および特定のしきい値を超えるスループット メトリックに関するアラートを設定します。\n",
    "pgVerified": true,
    "description": "ExpressRoute 回線の監視とアラートを構成する",
    "potentialBenefits": "Enhanced network performance and health",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/expressRouteCircuits",
    "recommendationImpact": "High",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "26cb547f-aabc-dc40-be02-d0a9b6b04b1a",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/expressroute/maintenance-alerts",
        "name": "How to view and configure alerts for Azure ExpressRoute circuit maintenance"
      }
    ],
    "recommendationControl": "Monitoring and Alerting",
    "longDescription": "ExpressRoute は、計画メンテナンスと計画外メンテナンスの両方の通知にサービス正常性を活用し、ExpressRoute 回線への変更についてユーザーに確実に通知します。\n",
    "pgVerified": true,
    "description": "ExpressRoute 回線のメンテナンス通知を受信するようにサービス正常性を構成する",
    "potentialBenefits": "Stay informed on circuit updates",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/expressRouteCircuits",
    "recommendationImpact": "High",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "d40c769d-2f08-4980-8d8f-a386946276e6",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/ja-jp/azure/expressroute/rate-limit",
        "name": "Rate limiting for ExpressRoute Direct circuits (Preview)"
      }
    ],
    "recommendationControl": "Scalability",
    "longDescription": "レート制限は、オンプレミス ネットワークと ExpressRoute Direct を介して Azure 間のトラフィック量を制御し、プライベートまたは Microsoft ピアリングに適用されます。ポート帯域幅を分散し、安定性を確保し、輻輳を防止し、回線で有効にするための手順を概説します。\n",
    "pgVerified": true,
    "description": "ExpressRoute Direct 回線全体にレート制限を実装してネットワーク フローを最適化する",
    "potentialBenefits": "Optimizes network, prevents congestion",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/expressRouteCircuits",
    "recommendationImpact": "Medium",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// This query will return all the ExpressRoute circuits (Direct Based) that have Direct Port Rate Limiting disabled\nresources\n| where type =~ \"microsoft.network/expressroutecircuits\"\n| where properties.expressRoutePort != \"\" or isnotnull(properties.expressRoutePort)\n| where properties.enableDirectPortRateLimit == false\n| project recommendationId = \"d40c769d-2f08-4980-8d8f-a386946276e6\", name, id, tags, param1=strcat(\"enableDirectPortRateLimit: \",properties.enableDirectPortRateLimit)\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "d2976d3e-294b-4b49-a1f0-c42566a3758f",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/azure-monitor/essentials/diagnostic-settings",
        "name": "Diagnostic settings in Azure Monitor"
      }
    ],
    "recommendationControl": "Monitoring and Alerting",
    "longDescription": "リソース ログは、診断設定を作成して 1 つ以上の場所にルーティングするまで収集および保存されません。\n",
    "pgVerified": true,
    "description": "すべてのネットワーク セキュリティ グループの診断設定を構成する",
    "potentialBenefits": "Enhanced monitoring and security insights",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/networkSecurityGroups",
    "recommendationImpact": "Medium",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "8bb4a57b-55e4-d24e-9c19-2679d8bc779f",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/azure-monitor/essentials/activity-log?tabs=powershell",
        "name": "Azure Monitor activity log"
      }
    ],
    "recommendationControl": "Monitoring and Alerting",
    "longDescription": "Azure Monitor を使用して、ネットワーク セキュリティ グループ ルールの作成や更新などの操作に対してアラートを作成し、リソースに対する承認されていない変更や望ましくない変更をキャッチし、ファイアウォールのバイパスや外部からのリソースへのアクセスの試行を特定します。\n",
    "pgVerified": true,
    "description": "Azure Monitor を使用してネットワーク セキュリティ グループの変更を監視する",
    "potentialBenefits": "Enhanced security and change monitoring",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/networkSecurityGroups",
    "recommendationImpact": "Low",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Find all Network Security Groups without alerts for modification configured.\nresources\n| where type =~ \"Microsoft.Network/networkSecurityGroups\"\n| project name, id, tags, lowerCaseNsgId = tolower(id)\n| join kind = leftouter (\n    resources\n    | where type =~ \"Microsoft.Insights/activityLogAlerts\" and properties.enabled == true\n    | mv-expand scope = properties.scopes\n    | where scope has \"Microsoft.Network/networkSecurityGroups\"\n    | project alertName = name, conditionJson = dynamic_to_json(properties.condition.allOf), scope\n    | where conditionJson has '\"Administrative\"' and (\n        // Create or Update Network Security Group\n        (conditionJson has '\"Microsoft.Network/networkSecurityGroups/write\"') or\n        // All administrative operations\n        (conditionJson !has '\"Microsoft.Network/networkSecurityGroups/write\"' and conditionJson !has '\"Microsoft.Network/networkSecurityGroups/delete\"' and conditionJson !has '\"Microsoft.Network/networkSecurityGroups/join/action\"')\n        )\n    | project lowerCaseNsgIdOfScope = tolower(scope)\n    )\n    on $left.lowerCaseNsgId == $right.lowerCaseNsgIdOfScope\n| where isempty(lowerCaseNsgIdOfScope)\n| project recommendationId = \"8bb4a57b-55e4-d24e-9c19-2679d8bc779f\", name, id, tags, param1 = \"ModificationAlert: Not configured/Disabled\"\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "52ac35e8-9c3e-f84d-8ce8-2fab955333d3",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/azure-resource-manager/management/lock-resources?toc=%2Fazure%2Fvirtual-network%2Ftoc.json&tabs=json",
        "name": "Lock your resources to protect your infrastructure"
      }
    ],
    "recommendationControl": "Governance",
    "longDescription": "管理者は、Azure サブスクリプション、リソース グループ、またはリソースをロックして、誤って削除や変更されないように保護できます。ロックは、ユーザーのアクセス許可よりも優先されます。ロックは、削除または変更を防ぐことができ、ポータルでは \"削除\" と \"読み取り専用\" と呼ばれます。\n",
    "pgVerified": true,
    "description": "ネットワーク セキュリティ グループのロックを構成して、偶発的な変更や削除を防止する",
    "potentialBenefits": "Prevents accidental edits/deletions",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/networkSecurityGroups",
    "recommendationImpact": "Low",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "da1a3c06-d1d5-a940-9a99-fcc05966fe7c",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Disabled",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/network-watcher/network-watcher-nsg-flow-logging-overview",
        "name": "Flow logging for network security groups"
      }
    ],
    "recommendationControl": "Monitoring and Alerting",
    "longDescription": "ネットワークを監視、管理、および理解することは、保護と最適化に不可欠です。現在の状態、接続先と接続先、開いているインターネット ポート、予想される動作と不規則な動作、トラフィックの急増を把握することが不可欠です。\n",
    "pgVerified": true,
    "description": "NSG フロー ログを構成する",
    "potentialBenefits": "Enhances security and optimizes network",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/networkSecurityGroups",
    "recommendationImpact": "Medium",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Find all Network Security Groups without NSG Flow logs configured or disabled.\nresources\n| where type =~ \"Microsoft.Network/networkSecurityGroups\"\n| project name, id, tags, lowerCaseNsgId = tolower(id)\n| join kind = leftouter (\n    resources\n    | where type == \"microsoft.network/networkwatchers/flowlogs\" and properties.enabled == true\n    | project flowLogName = name, lowerCaseTargetNsgId = tolower(properties.targetResourceId)\n    )\n    on $left.lowerCaseNsgId == $right.lowerCaseTargetNsgId\n| where isempty(lowerCaseTargetNsgId)\n| project recommendationId = \"da1a3c06-d1d5-a940-9a99-fcc05966fe7c\", name, id, tags, param1 = \"NSGFlowLog: Not configured/Disabled\"\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "8291c1fa-650c-b44b-b008-4deb7465919d",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/virtual-network/network-security-groups-overview#security-rules",
        "name": "Security rules"
      }
    ],
    "recommendationControl": "Security",
    "longDescription": "Azure ネットワーク セキュリティ グループは、セキュリティ規則を使用して、送信元、宛先、ポート、プロトコルに基づいて受信トラフィックまたは送信トラフィックを許可または拒否し、仮想ネットワーク内のリソース間のネットワーク トラフィックをフィルター処理します。\n",
    "pgVerified": true,
    "description": "NSG には既定のセキュリティ規則しかないため、必要な規則を構成する",
    "potentialBenefits": "Enhanced traffic control and security",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/networkSecurityGroups",
    "recommendationImpact": "Medium",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// This query will return all NSGs that have NO security rules\nresources\n| where type =~ \"microsoft.network/networksecuritygroups\"\n| extend sr = string_size(properties.securityRules)\n| where sr <=2 or isnull(properties.securityRules)\n| project recommendationId = \"8291c1fa-650c-b44b-b008-4deb7465919d\", name, id\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "c72b7fee-1fa0-5b4b-98e5-54bcae95bb74",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/architecture/framework/services/networking/azure-firewall",
        "name": "Azure Well Architected Framework - Azure Firewall"
      },
      {
        "url": "https://learn.microsoft.com/azure/firewall/deploy-availability-zone-powershell",
        "name": "Deploy Azure Firewall across multiple availability zones"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "Azure Firewall では、デプロイに応じて異なる SLA が提供されます。単一の可用性ゾーンまたは複数の可用性ゾーンで、信頼性とパフォーマンスが向上する可能性があります。\n",
    "pgVerified": true,
    "description": "複数の可用性ゾーンに Azure Firewall をデプロイする",
    "potentialBenefits": "Enhanced SLA and reliability",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/azureFirewalls",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// List all Azure Firewalls that are not configured with multiple availability zones or deployed without a zone\nresources\n| where type == 'microsoft.network/azurefirewalls'\n| where array_length(zones) <= 1 or isnull(zones)\n| where isempty(properties.virtualHub.id) or isnull(properties.virtualHub.id)\n| project recommendationId = \"c72b7fee-1fa0-5b4b-98e5-54bcae95bb74\", name, id, tags, param1=\"multipleZones:false\"\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "3c8fa7c6-6b78-a24a-a63f-348a7c71acb9",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/azure-monitor/essentials/metrics-supported#microsoftnetworkazurefirewalls",
        "name": "Azure Firewall metrics supported in Azure Monitor"
      },
      {
        "url": "https://learn.microsoft.com/azure/firewall/firewall-performance",
        "name": "Azure Firewall performance"
      }
    ],
    "recommendationControl": "Monitoring and Alerting",
    "longDescription": "Azure Firewall の全体的な正常性、処理されたスループット、送信 SNAT ポートの使用状況を監視します。制限がサービスに影響を与える前にアラートを受け取ります。NAT ゲートウェイとゾーン展開の統合を検討してください。ゾーン冗長ファイアウォールとセキュリティで保護された仮想ハブ ネットワークに関する制限事項に注意してください。\n",
    "pgVerified": true,
    "description": "Azure Firewall メトリックを監視する",
    "potentialBenefits": "Improve health and performance monitoring",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/azureFirewalls",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// List all Azure Firewalls resources in-scope, along with any metrics associated to Azure Monitor alert rules, that are not fully configured.\nresources\n| where type == \"microsoft.network/azurefirewalls\"\n| project firewallId = tolower(id), name, tags\n| join kind = leftouter (\n    resources\n    | where type == \"microsoft.insights/metricalerts\"\n    | mv-expand properties.scopes\n    | mv-expand properties.criteria.allOf\n    | where properties_scopes contains \"azureFirewalls\"\n    | project metricId = tolower(properties_scopes), monitoredMetric = properties_criteria_allOf.metricName, tags\n    | summarize monitoredMetrics = make_list(monitoredMetric) by tostring(metricId)\n    | project\n        metricId,\n        monitoredMetrics,\n        allAlertsConfigured = monitoredMetrics contains(\"FirewallHealth\") and monitoredMetrics contains (\"Throughput\") and monitoredMetrics contains (\"SNATPortUtilization\")\n) on $left.firewallId == $right.metricId\n| extend alertsNotFullyConfigured = isnull(allAlertsConfigured) or not(allAlertsConfigured)\n| where alertsNotFullyConfigured\n| project recommendationId = \"c8fa7c6-6b78-a24a-a63f-348a7c71acb9\", name, id = firewallId, tags, param1 = strcat(\"MetricsAlerts:\", monitoredMetrics)\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "1b2dbf4a-8a0b-5e4b-8f4e-3f758188910d",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/ddos-protection/ddos-protection-overview",
        "name": "Azure DDoS Protection overview"
      }
    ],
    "recommendationControl": "Security",
    "longDescription": "DDoS 保護プランを Azure Firewall をホストする仮想ネットワークに関連付けて、DDoS 攻撃に対する軽減を強化します。Azure Firewall Manager は、ファイアウォール インフラストラクチャと DDoS 保護プランの作成を統合します。\n",
    "pgVerified": true,
    "description": "Azure Firewall VNet で DDoS Protection を構成する",
    "potentialBenefits": "Enhanced DDoS attack defense",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/azureFirewalls",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// List all in-scope Azure Firewall resources, where the VNet is not associated to a DDoS Protection Plan\nresources\n| where type =~ \"Microsoft.Network/azureFirewalls\"\n| where isempty(properties.virtualHub.id) or isnull(properties.virtualHub.id)\n| mv-expand ipConfig = properties.ipConfigurations\n| project\n    name,\n    firewallId = id,\n    tags,\n    vNetName = split(ipConfig.properties.subnet.id, \"/\", 8)[0],\n    vNetId = tolower(substring(ipConfig.properties.subnet.id, 0, indexof(ipConfig.properties.subnet.id, \"/subnet\")))\n| join kind=fullouter (\n    resources\n    | where type =~ \"Microsoft.Network/ddosProtectionPlans\"\n    | mv-expand vNet = properties.virtualNetworks\n    | project ddosProtectionPlanId = id, vNetId = tolower(vNet.id)\n    )\n    on vNetId\n| where isempty(ddosProtectionPlanId)\n| project recommendationId = \"1b2dbf4a-8a0b-5e4b-8f4e-3f758188910d\", name, id = firewallId, tags, param1 = strcat(\"vNet: \", vNetName), param2 = \"ddosProtection: Disabled\"\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "3a63560a-1ed3-6140-acd1-d1d23f9a2e12",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/firewall-manager/rule-hierarchy",
        "name": "Azure Firewall Policy hierarchy"
      }
    ],
    "recommendationControl": "Governance",
    "longDescription": "Azure Firewall ポリシーは、子ポリシーよりも優先度の高い中央の基本ポリシーを使用して、コンプライアンスを適用するためのルール階層をサポートし、Azure カスタム ロールを使用して基本ポリシーを保護し、サブスクリプションやグループ内のアクセスを管理します。\n",
    "pgVerified": true,
    "description": "Azure Firewall ポリシー継承モデルを活用する",
    "potentialBenefits": "Enhanced compliance and rule hierarchy",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/azureFirewalls",
    "recommendationImpact": "Medium",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "d2e4a38e-2307-4299-a217-4c0cebc9a7f6",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/ja-jp/azure/well-architected/service-guides/azure-firewall#recommendations",
        "name": "Azure Well-Architected Framework review - Azure Firewall"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "SNAT の枯渇を回避するために、Azure Firewall ごとに少なくとも 2 つから 4 つのパブリック IP アドレスを構成します。Azure Firewall では、パブリック IP へのすべての送信トラフィックに対して SNAT が提供され、追加のパブリック IP ごとに 2,496 個の SNAT ポートが提供されます。\n",
    "pgVerified": false,
    "description": "SNAT ポート使用率のための 2 〜 4 つのパブリック IP の設定",
    "potentialBenefits": "Avoids SNAT exhaustion.",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/azureFirewalls",
    "recommendationImpact": "Medium",
    "automationAvailable": false,
    "query": "// under development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "8faace2d-a36e-425c-aa58-2ad99e3e0b7a",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/well-architected/service-guides/azure-firewall#recommendations",
        "name": "Azure Well-Architected Framework review - Azure Firewall"
      },
      {
        "url": "https://learn.microsoft.com/azure/firewall/metrics",
        "name": "Azure Firewall metrics overview"
      }
    ],
    "recommendationControl": "Monitoring and Alerting",
    "longDescription": "20 ミリ秒を超えるレイテンシ プローブを 30 ミリ秒を超える期間監視する指標を作成すると、ファイアウォール インスタンスの CPU にストレスがかかり、問題を示している可能性があるタイミングを特定できます。\n",
    "pgVerified": false,
    "description": "「AZFW Latency Probe」メトリックを監視する",
    "potentialBenefits": "Improved CPU stress detection",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/azureFirewalls",
    "recommendationImpact": "High",
    "automationAvailable": false,
    "query": "// under development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "b89c9acc-0aba-fb44-9ff2-3dbfcf97dce7",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/private-link/manage-private-endpoint?tabs=manage-private-link-powershell#private-endpoint-connections",
        "name": "Private endpoint connections"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "プライベート エンドポイントには、静的 IP アドレスとネットワーク インターフェイス名の 2 つのカスタム プロパティがあり、作成時に設定する必要があります。成功状態でない場合は、エンドポイントまたは関連するリソースに問題がある可能性があります。\n",
    "pgVerified": true,
    "description": "成功していない接続状態のプライベート エンドポイントに関する問題を解決する",
    "potentialBenefits": "Ensure connection availability",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/privateEndpoints",
    "recommendationImpact": "Medium",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// This query will return all Private Endpoints that are not in a Succeeded state\nresources\n| where type =~ \"microsoft.network/privateendpoints\"\n| where (properties.provisioningState =~ \"Succeeded\" and (properties.privateLinkServiceConnections[0].properties.provisioningState =~ \"Succeeded\" or properties.manualPrivateLinkServiceConnections[0].properties.provisioningState =~ \"Succeeded\")) == false\n| project recommendationId = \"b89c9acc-0aba-fb44-9ff2-3dbfcf97dce7\", name, id, tags, param1 = strcat(\"provisioningState: \", tostring(properties.provisioningState)), param2 = strcat(\"provisioningState: \", tostring(properties.privateLinkServiceConnections[0].properties.provisioningState)), param3 = strcat(\"manualProvisioningState: \", tostring(properties.manualPrivateLinkServiceConnections[0].properties.provisioningState))\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "f05a3e6d-49db-2740-88e2-2b13706c1f67",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/traffic-manager/traffic-manager-monitoring",
        "name": "Azure Traffic Manager endpoint monitoring"
      },
      {
        "url": "https://learn.microsoft.com/azure/traffic-manager/traffic-manager-monitoring#enable-or-disable-health-checks-preview",
        "name": "Enable or disable health checks"
      },
      {
        "url": "https://learn.microsoft.com/azure/traffic-manager/traffic-manager-troubleshooting-degraded",
        "name": "Troubleshooting degraded state on Azure Traffic Manager"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "監視状態は、アプリケーション ワークロードのフェールオーバーを確実にするためにオンラインにする必要があります。Traffic Manager の正常性が \"低下\" と表示される場合は、1 つ以上のエンドポイントが低下している可能性があります。\n",
    "pgVerified": true,
    "description": "Traffic Manager の監視状態はオンラインである必要がある",
    "potentialBenefits": "Ensures failover functionality",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/trafficManagerProfiles",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Find traffic manager profiles that have an endpoint monitor status of not 'Online'\nresources\n| where type == \"microsoft.network/trafficmanagerprofiles\"\n| mv-expand properties.endpoints\n| where properties_endpoints.properties.endpointMonitorStatus != \"Online\"\n| project recommendationId = \"f05a3e6d-49db-2740-88e2-2b13706c1f67\", name, id, tags, param1 = strcat('Profile name: ',properties_endpoints.name), param2 = strcat('endpointMonitorStatus: ', properties_endpoints.properties.endpointMonitorStatus)\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "5b422a7f-8caa-3d48-becb-511599e5bba9",
    "recommendationTypeId": "6cd70072-c45c-4716-bf7b-b35c18e46e72",
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/traffic-manager/traffic-manager-endpoint-types",
        "name": "Traffic Manager Endpoint Types"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "Azure Traffic Manager を構成するときは、少なくとも 2 つのエンドポイントをプロビジョニングして、ワークロードが別のインスタンスにフェールオーバーできるようにし、信頼性と可用性を向上させます。\n",
    "pgVerified": true,
    "description": "Traffic Manager プロファイルには複数のエンドポイントが必要である",
    "potentialBenefits": "Enhances failover capabilities",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/trafficManagerProfiles",
    "recommendationImpact": "Medium",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Find traffic manager profiles that have less than 2 endpoints\nresources\n| where type == \"microsoft.network/trafficmanagerprofiles\"\n| where array_length(properties.endpoints) < 2\n| project recommendationId = \"5b422a7f-8caa-3d48-becb-511599e5bba9\", name, id, tags, param1 = strcat('EndpointCount: ', array_length(properties.endpoints))\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "1ad9d7b7-9692-1441-a8f4-93792efbe97a",
    "recommendationTypeId": "0db76759-6d22-4262-93f0-2f989ba2b58e",
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/advisor/advisor-reference-reliability-recommendations#add-at-least-one-more-endpoint-to-the-profile-preferably-in-another-azure-region",
        "name": "Reliability recommendations"
      }
    ],
    "recommendationControl": "Disaster Recovery",
    "longDescription": "プロファイルには、エンドポイントに障害が発生した場合の可用性を確保するために、複数のエンドポイントが必要です。また、信頼性を高めるために、これらのエンドポイントを異なるリージョンに分散することもお勧めします。\n",
    "pgVerified": true,
    "description": "別のリージョン内で少なくとも 1 つのエンドポイントを構成する",
    "potentialBenefits": "Enhances availability across regions",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/trafficManagerProfiles",
    "recommendationImpact": "Medium",
    "automationAvailable": false,
    "query": "// cannot-be-validated-with-arg\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "c31f76a0-48cd-9f44-aa43-99ee904db9bc",
    "recommendationTypeId": "0bbe0a49-3c63-49d3-ab4a-aa24198f03f7",
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/advisor/advisor-reference-reliability-recommendations#add-an-endpoint-configured-to-all-world",
        "name": "Add an endpoint configured to \"All (World)\""
      },
      {
        "url": "https://aka.ms/Rf7vc5",
        "name": "Traffic Manager profile - GeographicProfile (Add an endpoint configured to \"\"All (World)\"\")."
      }
    ],
    "recommendationControl": "Disaster Recovery",
    "longDescription": "地理的ルーティングの場合、トラフィックは特定のリージョンに基づいてエンドポイントに転送されます。事前定義されたフェールオーバーなしでリージョンに障害が発生した場合、地理的プロファイルのエンドポイントを \"すべて (ワールド)\" に構成すると、トラフィックのブラック ホールを防ぎ、サービスを引き続き利用できます。\n",
    "pgVerified": true,
    "description": "エンドポイントが地理的プロファイルに対して (All World) に設定されていることを確認します。",
    "potentialBenefits": "Avoids traffic black holing, ensures availability",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/trafficManagerProfiles",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Provides a list of Traffic Manager resources that are not confirgured for all-World access\nResources\n| where type == 'microsoft.network/trafficmanagerprofiles'\n| where properties.trafficRoutingMethod =~ \"Geographic\"\n| extend endpoints = properties.endpoints\n| mv-expand endpoint = endpoints\n| where endpoint.properties.geoMapping !contains \"WORLD\"\n| extend endpointName = endpoint.name\n| project recommendationId=\"c31f76a0-48cd-9f44-aa43-99ee904db9bc\", name, id, tags, param1=strcat(\"endpointName:\",endpointName), param2=strcat(\"GeoMapping:\", tostring(endpoint.properties.geoMapping))\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "9987c813-d687-4163-a511-95f31bc5e536",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/expressroute/designing-for-disaster-recovery-with-expressroute-privatepeering",
        "name": "ExpressRoute プライベート ピアリングを使用したディザスター リカバリーの設計"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "信頼性を高めるため、各仮想ハブの ExpressRoute ゲートウェイは少なくとも 2 つの回線に接続し、各回線は他の回線とは異なるピアリングの場所を起点とします。多様な接続経路を確保して耐障害性を高めます。",
    "pgVerified": false,
    "description": "仮想ハブの ExpressRoute ゲートウェイを多様なピアリングの場所の回線に接続して耐障害性を確保する",
    "potentialBenefits": "Enhance resiliency for Azure Service",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/expressRouteGateways",
    "recommendationImpact": "High",
    "automationAvailable": false,
    "query": "// under-development\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "17e8d380-e4b4-41a1-9b37-2e4df9fd5125",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/virtual-wan/monitoring-best-practices#expressroute-gateway",
        "name": "Azure Virtual WAN の監視 - ベスト プラクティス"
      }
    ],
    "recommendationControl": "Monitoring and Alerting",
    "longDescription": "仮想 WAN の ExpressRoute ゲートウェイの監視とアラートを設定します。パケット/秒の超過、BGP ルート プレフィックス数の超過、ゲートウェイの過剰使用、ルート変更の頻度の高さなど、重要なイベントに迅速に対応するためのアラート ルールを作成します。",
    "pgVerified": false,
    "description": "仮想ハブの ExpressRoute ゲートウェイの正常性を監視する",
    "potentialBenefits": "Detection and mitigation to avoid disruptions.",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/expressRouteGateways",
    "recommendationImpact": "High",
    "automationAvailable": false,
    "query": "// under-development\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "ae054bf2-aefa-cf4a-8282-741194cef8da",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/ja-jp/azure/ddos-protection/monitor-ddos-protection-reference",
        "name": "Monitoring Azure DDoS Protection"
      }
    ],
    "recommendationControl": "Security",
    "longDescription": "Azure DDoS プランのメトリックでは、パケットとバイトがタグ別に区別されます: ドロップ (DDoS によってスクラブされたパケット)、転送済み (VIP へのパケットはフィルター処理されません)、タグなし (パケットの合計、ドロップされたパケットと転送されたパケットの合計)。\n",
    "pgVerified": true,
    "description": "Azure DDoS Protection プランのメトリックを監視する",
    "potentialBenefits": "Enhanced security and traffic insight",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/ddosProtectionPlans",
    "recommendationImpact": "Medium",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "f6a14b32-a727-4ace-b5fa-7b1c6bdff402",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/ja-jp/azure/expressroute/about-fastpath",
        "name": "About ExpressRoute FastPath"
      }
    ],
    "recommendationControl": "Scalability",
    "longDescription": "ExpressRoute ゲートウェイは、ネットワーク トラフィックとルート交換を容易にします。FastPath は、トラフィックを仮想マシンに直接転送し、ゲートウェイをバイパスしてゲートウェイの使用率を低下させることで、オンプレミスから仮想ネットワークへのデータ パスのパフォーマンスを向上させます。\n",
    "pgVerified": true,
    "description": "データ パスのパフォーマンスを向上させるには、ExpressRoute Direct とゲートウェイで FastPath を有効にする",
    "potentialBenefits": "Enhances speed and resiliency",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/connections",
    "recommendationImpact": "Medium",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "a5f3a4bd-4cf1-4196-a3cb-f5a0876198b2",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/ja-jp/azure/azure-resource-manager/management/lock-resources?tabs=json",
        "name": "Protect your Azure resources with a lock - Azure Resource Manager | Microsoft Learn"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "ゲートウェイ接続リソースの Azure リソース ロックを構成して、誤って削除されないようにし、オンプレミス ネットワークと Azure ワークロード間の接続を維持します。\n",
    "pgVerified": true,
    "description": "接続に Azure リソース ロックを構成して、誤って削除されないようにする",
    "potentialBenefits": "Prevents accidental deletion of connections",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/connections",
    "recommendationImpact": "High",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "f0d4f766-ac19-48c4-b228-4601cc038baa",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/virtual-wan/monitoring-best-practices#virtual-wan-gateways",
        "name": "Azure Virtual WAN の監視 - ベスト プラクティス"
      }
    ],
    "recommendationControl": "Monitoring and Alerting",
    "longDescription": "仮想ハブの VPN ゲートウェイの監視とアラートを設定します。パケット ドロップ数、BGP ステータス、ゲートウェイの過剰使用などの重要なイベントに迅速に対応するためのアラート ルールを作成します。",
    "pgVerified": false,
    "description": "仮想ハブのサイト間 VPN ゲートウェイを監視する",
    "potentialBenefits": "Detection and mitigation to avoid disruptions.",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/vpnGateways",
    "recommendationImpact": "High",
    "automationAvailable": false,
    "query": "// under-development\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "4e133bd0-8762-bc40-a95b-b29142427d73",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/network-watcher/network-watcher-overview",
        "name": "What is Azure Network Watcher?"
      }
    ],
    "recommendationControl": "Monitoring and Alerting",
    "longDescription": "Azure Network Watcher には、IaaS リソースの監視、診断、メトリックの表示、ログの管理を行うためのツールが用意されています。VM、仮想ネットワーク、アプリケーション ゲートウェイ、ロード バランサーの正常性を維持するのに役立ちますが、PaaS や Web 分析の正常性を維持することはできません。\n",
    "pgVerified": true,
    "description": "ネットワーク サービスがあるすべてのリージョンに Network Watcher をデプロイする",
    "potentialBenefits": "Enhanced monitoring and diagnostics for Azure IaaS",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/networkWatchers",
    "recommendationImpact": "Low",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// This query will return all locations that do not have a Network Watcher deployed\nresources\n| where location != \"global\"\n| union (Resources\n    | where type =~ \"microsoft.network/networkwatchers\")\n| summarize NetworkWatcherCount = countif(type =~ 'Microsoft.Network/networkWatchers') by location\n| where NetworkWatcherCount == 0\n| project recommendationId = \"4e133bd0-8762-bc40-a95b-b29142427d73\", name=location, id=\"n/a\", param1 = strcat(\"LocationMisingNetworkWatcher:\", location)\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "22a769ed-0ecb-8b49-bafe-8f52e6373d9c",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/network-watcher/nsg-flow-logging",
        "name": "Manage NSG flow logs using the Azure portal"
      }
    ],
    "recommendationControl": "Monitoring and Alerting",
    "longDescription": "ネットワーク セキュリティ グループ フロー ログは、ネットワーク セキュリティ グループを介して IP トラフィック情報をログに記録する Azure Network Watcher の機能です。失敗状態の場合、関連するリソースからの監視データは収集されません。\n",
    "pgVerified": true,
    "description": "失敗状態や無効状態のフロー ログ設定を修正する",
    "potentialBenefits": "Ensures IP traffic logging",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/networkWatchers",
    "recommendationImpact": "Low",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// This query will return all Network Watcher Flow Logs that are not enabled or in a succeeded state\nresources\n| where type =~ \"microsoft.network/networkwatchers/flowlogs\" and isnotnull(properties)\n| extend targetResourceId = tostring(properties.targetResourceId)\n| extend status = iff(properties.enabled =~ 'true', \"Enabled\", \"Disabled\")\n| extend provisioningState = tostring(properties.provisioningState)\n| extend flowLogType = iff(properties.targetResourceId contains \"Microsoft.Network/virtualNetworks\", 'Virtual network', 'Network security group')\n| where provisioningState != \"Succeeded\" or status != \"Enabled\"\n| project recommendationId = \"22a769ed-0ecb-8b49-bafe-8f52e6373d9c\", name, id, tags, param1 = strcat(\"provisioningState:\", provisioningState), param2=strcat(\"Status:\", status), param3=strcat(\"targetResourceId:\",targetResourceId), param4=strcat(\"flowLogType:\",flowLogType)\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "1e28bbc1-1eb7-486f-8d7f-93943f40219c",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/ja-jp/azure/network-watcher/connection-monitor-overview",
        "name": "接続の監視の概要"
      }
    ],
    "recommendationControl": "Monitoring and Alerting",
    "longDescription": "Azure や ハイブリッド接続の監視を改善します。\n",
    "pgVerified": true,
    "description": "Network Watcher の接続モニターを構成する",
    "potentialBenefits": "Improves monitoring for Azure and Hybrid connectivity",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/networkWatchers",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// under-development\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "a1317a0b-402d-4604-be40-a25a004ba171",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/network-watcher/nsg-flow-logs-overview",
        "name": "ネットワーク セキュリティ グループのフロー ログ"
      },
      {
        "url": "https://learn.microsoft.com/azure/network-watcher/vnet-flow-logs-overview",
        "name": "仮想ネットワーク フロー ログ"
      }
    ],
    "recommendationControl": "Monitoring and Alerting",
    "longDescription": "Azure や ハイブリッド接続の監視を改善します。\n",
    "pgVerified": true,
    "description": "ネットワーク セキュリティ グループと仮想ネットワーク フロー ログを有効にする",
    "potentialBenefits": "Improves monitoring and security for Azure connectivity",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/networkWatchers",
    "recommendationImpact": "High",
    "automationAvailable": false,
    "query": "// under-development\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "bf0b7dbd-016d-458c-af99-70fcb03ad451",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/network-watcher/traffic-analytics",
        "name": "Network Watcher のトラフィック分析"
      }
    ],
    "recommendationControl": "Monitoring and Alerting",
    "longDescription": "Azure や ハイブリッド接続の監視、セキュリティ、トラブルシューティングを改善します。\n",
    "pgVerified": true,
    "description": "ネットワーク セキュリティ グループと仮想ネットワーク フロー ログの設定でトラフィック解析を有効にする",
    "potentialBenefits": "Improves monitoring, security and troubleshooting.",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/networkWatchers",
    "recommendationImpact": "High",
    "automationAvailable": false,
    "query": "// under-development\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "823b0cff-05c0-2e4e-a1e7-9965e1cfa16f",
    "recommendationTypeId": "c9c9750b-9ddb-436f-b19a-9c725539a0b5",
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/application-gateway/application-gateway-autoscaling-zone-redundant#autoscaling-and-high-availability",
        "name": "Application Gateway Autoscaling Zone-Redundant"
      }
    ],
    "recommendationControl": "Scalability",
    "longDescription": "Azure Application Gateways v2 は、既定で常に複数のインスタンスを使用して高可用性の方法でデプロイされます。自動スケーリングを有効にすると、サービスがスケーリングの手動介入に依存しなくなります。\n",
    "pgVerified": true,
    "description": "自動スケーリング機能が有効になっていることを確認する",
    "potentialBenefits": "Enhances uptime and enables autoscaling",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/applicationGateways",
    "recommendationImpact": "Medium",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// This query will return all Application Gateways that do not have autoscale enabled or have a min capacity of 1\nresources\n| where type =~ \"microsoft.network/applicationGateways\"\n| where isnull(properties.autoscaleConfiguration) or properties.autoscaleConfiguration.minCapacity <= 1\n| project recommendationId = \"823b0cff-05c0-2e4e-a1e7-9965e1cfa16f\", name, id, tags, param1 = \"autoScaleConfiguration: isNull or MinCapacity <= 1\"\n| order by id asc\n\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "233a7008-71e9-e745-923e-1a1c7a0b92f3",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/well-architected/services/networking/azure-application-gateway#security",
        "name": "Application Gateway Security"
      },
      {
        "url": "https://learn.microsoft.com/azure/application-gateway/ssl-overview",
        "name": "Application Gateway SSL Overview"
      },
      {
        "url": "https://learn.microsoft.com/azure/application-gateway/application-gateway-ssl-policy-overview",
        "name": "Application Gateway SSL Policy Overview"
      },
      {
        "url": "https://learn.microsoft.com/azure/application-gateway/key-vault-certs",
        "name": "Application Gateway KeyVault Certs"
      },
      {
        "url": "https://learn.microsoft.com/azure/application-gateway/ssl-certificate-management",
        "name": "Application Gateway SSL Cert Management"
      }
    ],
    "recommendationControl": "Security",
    "longDescription": "Application Gateway でのエンドツーエンドの SSL/TLS または SSL/TLS 終端により、運用サービスに HTTPS を使用してすべての着信接続をセキュリティで保護し、攻撃から保護し、Web サーバーとブラウザー間でデータのプライバシーと暗号化が維持されるようにします。\n",
    "pgVerified": true,
    "description": "すべての着信接続を SSL で保護する",
    "potentialBenefits": "Enhanced security and privacy",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/applicationGateways",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// You can use the following Azure Resource Graph query to check if an HTTP rule is using an SSL certificate or is using Azure Key Vault to store the certificates\nresources\n| where type =~ \"microsoft.network/applicationGateways\"\n| mv-expand frontendPorts = properties.frontendPorts\n| mv-expand httpListeners = properties.httpListeners\n| where isnull(parse_json(httpListeners.properties.sslCertificate))\n| project recommendationId=\"233a7008-71e9-e745-923e-1a1c7a0b92f3\", name, id, tags, param1=strcat(\"frontendPort: \", frontendPorts.properties.port), param2=\"tls: false\"\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "8d9223c4-730d-ca47-af88-a9a024c37270",
    "recommendationTypeId": "efe75f01-6fff-5d9d-08e6-092b98d3fb3f",
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/well-architected/services/networking/azure-application-gateway",
        "name": "Well-Architected Framework Application Gateway Overview"
      },
      {
        "url": "https://learn.microsoft.com/azure/application-gateway/features#web-application-firewall",
        "name": "Application Gateway - Web Application Firewall"
      }
    ],
    "recommendationControl": "Security",
    "longDescription": "アプリケーション仮想ネットワークで Application Gateway と Web アプリケーション ファイアウォール (WAF) を使用して、受信 HTTP/S インターネット トラフィックを保護します。WAF は、OWASP コア ルールセット ベースのルールを通じて、潜在的なエクスプロイトに対する一元的な防御を提供します。\n",
    "pgVerified": true,
    "description": "Web アプリケーション ファイアウォール ポリシーを有効にする",
    "potentialBenefits": "Enhanced security for HTTP/S traffic",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/applicationGateways",
    "recommendationImpact": "Low",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// This query will return all Application Gateways that do not have WAF enabled\nResources\n| where type =~ \"microsoft.network/applicationGateways\"\n| where properties.firewallpolicy != \"\"\n| project recommendationId = \"8d9223c4-730d-ca47-af88-a9a024c37270\", name, id, tags, param1 = \"webApplicationFirewallConfiguration: isNull\"\n| order by id asc\n\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "7893f0b3-8622-1d47-beed-4b50a19f7895",
    "recommendationTypeId": "0e19257e-dcef-4d00-8de1-5fe1ae0fd948",
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/application-gateway/overview-v2",
        "name": "Application Gateway Overview V2"
      },
      {
        "url": "https://learn.microsoft.com/azure/application-gateway/overview-v2#feature-comparison-between-v1-sku-and-v2-sku",
        "name": "Application Gateway Feature Comparison Between V1 and V2"
      },
      {
        "url": "https://azure.microsoft.com/updates/application-gateway-v1-will-be-retired-on-28-april-2026-transition-to-application-gateway-v2/",
        "name": "Application Gateway V1 Retirement"
      }
    ],
    "recommendationControl": "Scalability",
    "longDescription": "v1 が必要でない限り、自動スケーリング、静的 VIP、Azure KeyVault 統合などの組み込み機能に Application Gateway v2 を使用して、トラフィック管理とパフォーマンスを向上させます。\n",
    "pgVerified": true,
    "description": "Application Gateway v2 に移行する",
    "potentialBenefits": "Better performance, autoscaling, more features",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/applicationGateways",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Get all Application Gateways, which are using the deprecated V1 SKU\nresources\n| where type =~ 'microsoft.network/applicationgateways'\n| extend tier = properties.sku.tier\n| where tier == 'Standard' or tier == 'WAF'\n| project recommendationId = \"7893f0b3-8622-1d47-beed-4b50a19f7895\", name, id, tags\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "5d035919-898d-a047-8d5d-454e199692e5",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/application-gateway/application-gateway-metrics",
        "name": "Application Gateway Metrics"
      },
      {
        "url": "https://learn.microsoft.com/azure/application-gateway/application-gateway-diagnostics",
        "name": "Application Gateway Diagnostics"
      }
    ],
    "recommendationControl": "Monitoring and Alerting",
    "longDescription": "ストレージ アカウント、Log Analytics、および監査と分析情報の監視サービスでのログ記録を有効にします。\n",
    "pgVerified": true,
    "description": "トラフィックの監視とログ記録を設定する",
    "potentialBenefits": "Enhanced traffic insight and audit",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/applicationGateways",
    "recommendationImpact": "High",
    "automationAvailable": false,
    "query": "// cannot-be-validated-with-arg\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "847a8d88-21c4-bc48-a94e-562206edd767",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/application-gateway/application-gateway-probe-overview",
        "name": "Application Gateway Probe Overview"
      },
      {
        "url": "https://learn.microsoft.com/azure/well-architected/services/networking/azure-application-gateway",
        "name": "Well-Architected Framework Application Gateway Overview"
      }
    ],
    "recommendationControl": "Monitoring and Alerting",
    "longDescription": "カスタム正常性プローブを使用すると、バックエンドの可用性の理解が深まり、バックエンド サービスの影響の監視が容易になります。\n",
    "pgVerified": true,
    "description": "正常性プローブを使用してバックエンドの可用性を検出する",
    "potentialBenefits": "Ensures backend uptime monitoring.",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/applicationGateways",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Application Gateways are not using health probes to monitor the availability of the backend systems\nresources\n| where type =~ \"microsoft.network/applicationGateways\"\n| where array_length(properties.probes) == 0\n| project recommendationId=\"847a8d88-21c4-bc48-a94e-562206edd767\", name, id, tags, param1=\"customHealthProbeUsed: false\"\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "c9c00f2a-3888-714b-a72b-b4c9e8fcffb2",
    "recommendationTypeId": "5c488377-be3e-4365-92e8-09d1e8d9038c",
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/well-architected/services/networking/azure-application-gateway#reliability",
        "name": "Well-Architected Framework Application Gateway Reliability"
      },
      {
        "url": "https://learn.microsoft.com/azure/application-gateway/overview-v2",
        "name": "Application Gateway V2 Overview"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "ゾーン対応構成で Application Gateway をデプロイすると、他のゾーンのサービスが引き続き利用できるため、特定のゾーンがダウンした場合でも、顧客がサービスに引き続きアクセスできるようになります。\n",
    "pgVerified": true,
    "description": "Application Gateway をゾーン冗長構成でデプロイする",
    "potentialBenefits": "Enhanced uptime and customer access",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/applicationGateways",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// list Application Gateways that are not configured to use at least 2 Availability Zones\nresources\n| where type =~ \"microsoft.network/applicationGateways\"\n| where isnull(zones) or array_length(zones) < 2\n| extend zoneValue = iff((isnull(zones)), \"null\", zones)\n| project recommendationId = \"c9c00f2a-3888-714b-a72b-b4c9e8fcffb2\", name, id, tags, param1=\"Zones: No Zone or Zonal\", param2=strcat(\"Zones value: \", zoneValue )\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "10f02bc6-e2e7-004d-a2c2-f9bf9f16b915",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/application-gateway/features#connection-draining",
        "name": "Application Gateway Connection Draining"
      },
      {
        "url": "https://learn.microsoft.com/azure/application-gateway/configuration-http-settings#connection-draining",
        "name": "Application Gateway Connection Draining HTTP Settings"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "バックエンドのメンテナンスにコネクション ドレインを使用すると、更新時や正常性の問題時にバックエンド プール メンバーが正常に削除されます。これは [バックエンド設定] で有効にされ、ルールの作成時にすべてのメンバーに適用されます。\n",
    "pgVerified": true,
    "description": "接続ドレインを使用したバックエンドのメンテナンスを計画する",
    "potentialBenefits": "Smooth updates, no dropped users",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/applicationGateways",
    "recommendationImpact": "Medium",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// This query will check if connection draining is enabled\nresources\n| where type =~ \"microsoft.network/applicationGateways\"\n| mv-expand backendHttpSettings = properties.backendHttpSettingsCollection\n| extend connectionDrainingEnabled = backendHttpSettings.properties.connectionDraining.enabled\n| where connectionDrainingEnabled != true\n| extend backendPoolName = backendHttpSettings.name\n| project recommendationId = \"10f02bc6-e2e7-004d-a2c2-f9bf9f16b915\", name, id, tags, param1 = \"connectionDraining: Disabled\", param2 = strcat(\"backendSettingsName: \", backendPoolName)\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "8364fd0a-7c0e-e240-9d95-4bf965aec243",
    "recommendationTypeId": "ef4da732-f541-4109-bc0e-465c68b6c7eb",
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/ja-jp/azure/application-gateway/configuration-infrastructure#size-of-the-subnet",
        "name": "Azure Application Gateway infrastructure configuration | Microsoft Learn"
      }
    ],
    "recommendationControl": "Other Best Practices",
    "longDescription": "Application Gateway v2 (Standard_v2 または WAF_v2 SKU) では、最大 125 個のインスタンスをサポートできます。/24 サブネットはデプロイに必須ではありませんが、自動スケーリングとメンテナンスのアップグレードに十分な領域を提供することをお勧めします。\n",
    "pgVerified": true,
    "description": "Application Gateway サブネットが /24 サブネット マスクを使用していることを確認する",
    "potentialBenefits": "Allows autoscaling and maintenance",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/applicationGateways",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// This query will validate the subnet id for an appGW ends with a /24\n\nresources\n| where type =~ 'Microsoft.Network/applicationGateways'\n| extend subnetid = tostring(properties.gatewayIPConfigurations[0].properties.subnet.id)\n| join kind=leftouter(resources\n    | where type == \"microsoft.network/virtualnetworks\"\n    | mv-expand properties.subnets\n    | extend subnetid = tostring(properties_subnets.id)\n    | extend addressprefix = tostring(properties_subnets.properties.addressPrefix)\n    | project subnetid, addressprefix) on subnetid\n| where addressprefix !endswith '/24'\n| project recommendationId = \"8364fd0a-7c0e-e240-9d95-4bf965aec243\", name, id, tags, param1 = strcat('AppGW subnet prefix: ', addressprefix)\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "d37db635-157f-584d-9bce-4f6fc8c65ce5",
    "recommendationTypeId": "8d61a7d4-5405-4f43-81e3-8c6239b844a6",
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/expressroute/designing-for-disaster-recovery-with-expressroute-privatepeering",
        "name": "Designing for disaster recovery with ExpressRoute private peering"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "信頼性を高めるために、各 ExpressRoute ゲートウェイは少なくとも 2 つの回線に接続し、各回線は他の回線とは異なるピアリングの場所から発信され、回復性を強化するための多様な接続パスを確保することをお勧めします。\n",
    "pgVerified": true,
    "description": "回復性のために ExpressRoute ゲートウェイをさまざまなピアリングの場所から回線に接続する",
    "potentialBenefits": "Enhanced resiliency for Azure service",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/virtualNetworkGateways",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Provides a list of ExpressRoute Gateways that are not connected to two or more ExpressRoute Circuits. Baremetal circuits are excluded from consideration\n//This query assumes that the running entity has visibilty to the gateway, connection, and circuit scopes.\n//Start with a full list of gateways\n(resources\n| where type == \"microsoft.network/virtualnetworkgateways\"\n| where properties.gatewayType == \"ExpressRoute\"\n| extend exrGatewayId = tolower(tostring(id))\n| join kind=inner(\nresources\n| where type == \"microsoft.network/virtualnetworkgateways\"\n| where properties.gatewayType == \"ExpressRoute\"\n| extend exrGatewayId = tolower(tostring(id))\n| join kind=leftouter(\n//connections joined with circuit peer info\nresources\n| where type == \"microsoft.network/connections\"\n| extend connectionType = properties.connectionType\n| extend exrGatewayId = tolower(tostring(properties.virtualNetworkGateway1.id))\n| extend peerId = tolower(tostring(properties.peer.id))\n| extend connectionId = tolower(tostring(id))\n| where connectionType == \"ExpressRoute\"\n| join kind=leftouter(\n  resources\n  | where type == \"microsoft.network/expressroutecircuits\"\n    //should this be location instead of peeringLocation\n  | extend circuitId = tolower(tostring(id))\n  | extend peeringLocation = tostring(properties.serviceProviderProperties.peeringLocation)\n  | extend peerId = tolower(id)\n) on peerId ) on exrGatewayId\n//remove bare metal services connections/circuits\n| where not(isnotnull(connectionId) and isnull(sku1))\n//group by gateway ID's and peering locations\n| summarize by exrGatewayId, peeringLocation\n//summarize to connections with fewer than two unique connections\n| summarize connCount = count() by exrGatewayId\n| where connCount < 2) on exrGatewayId\n| project recommendationId = \"d37db635-157f-584d-9bce-4f6fc8c65ce5\", name, id, tags, param1 = \"twoOrMoreCircuitsConnectedFromDifferentPeeringLocations: false\")\n| union\n(\nresources\n| where type == \"microsoft.network/virtualnetworkgateways\"\n| where properties.gatewayType == \"ExpressRoute\"\n| extend exrGatewayId = tolower(tostring(id))\n| join kind=leftouter(\n//connections joined with circuit peer info\nresources\n| where type == \"microsoft.network/connections\"\n| extend connectionType = properties.connectionType\n| extend exrGatewayId = tolower(tostring(properties.virtualNetworkGateway1.id))\n| extend peerId = tolower(tostring(properties.peer.id))\n| extend connectionId = tolower(tostring(id))\n| where connectionType == \"ExpressRoute\") on exrGatewayId\n| where isnull(connectionType)\n| project recommendationId = \"d37db635-157f-584d-9bce-4f6fc8c65ce5\", name, id, tags, param1 = \"twoOrMoreCircuitsConnectedFromDifferentPeeringLocations: false\", param2 = \"noConnectionsOnGateway: true\"\n)\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "bbe668b7-eb5c-c746-8b82-70afdedf0cae",
    "recommendationTypeId": "c9af1ef6-55bc-48af-bfe4-2c80490159f8",
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/expressroute/expressroute-about-virtual-network-gateways#zrgw",
        "name": "About ExpressRoute virtual network gateways - Zone-redundant gateway SKUs"
      },
      {
        "url": "https://learn.microsoft.com/azure/vpn-gateway/about-zone-redundant-vnet-gateways",
        "name": "About zone-redundant virtual network gateway in Azure availability zones"
      },
      {
        "url": "https://learn.microsoft.com/azure/vpn-gateway/create-zone-redundant-vnet-gateway",
        "name": "Create a zone-redundant virtual network gateway in Azure Availability Zones"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "Azure ExpressRoute ゲートウェイでは、単一または複数の可用性ゾーンでのデプロイに基づいて、さまざまな SLA が提供されます。仮想ネットワーク ゲートウェイをゾーン間で自動的にデプロイするには、ゾーン冗長ゲートウェイを使用して、回復性を高めた重要でスケーラブルなサービスにアクセスします。\n",
    "pgVerified": true,
    "description": "ゾーン冗長 ExpressRoute ゲートウェイ SKU を使用する",
    "potentialBenefits": "Enhanced SLA and resilience",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/virtualNetworkGateways",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// For all VNGs of type ExpressRoute, show any that do not have AZ in the SKU tier\nresources\n| where type =~ \"Microsoft.Network/virtualNetworkGateways\"\n| where properties.gatewayType == \"ExpressRoute\"\n| where properties.sku.tier !contains 'AZ'\n| project recommendationId = \"bbe668b7-eb5c-c746-8b82-70afdedf0cae\", name, id, tags, param1= strcat(\"sku-tier: \" , properties.sku.tier), param2=location\n| order by id asc\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "c0f23a92-d322-4d4d-97e9-a238b5e3bbb8",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/ja-jp/azure/azure-resource-manager/management/lock-resources?tabs=json",
        "name": "Protect your Azure resources with a lock - Azure Resource Manager | Microsoft Learn"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "ExpressRoute ゲートウェイの Azure リソース ロックを構成すると、管理者が Azure サブスクリプション、リソース グループ、またはリソースをロックできるようにすることで、誤って削除されるのを防ぎ、意図しないユーザーの削除や変更から保護し、すべてのユーザーのアクセス許可をロックします。\n",
    "pgVerified": true,
    "description": "ExpressRoute ゲートウェイの Azure リソース ロックを構成して、誤って削除されないようにする",
    "potentialBenefits": "Prevents accidental deletions",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/virtualNetworkGateways",
    "recommendationImpact": "Medium",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "1c34faa8-8b99-974c-adbf-71922eae943c",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/expressroute/expressroute-monitoring-metrics-alerts#expressroute-gateways",
        "name": "ExpressRoute monitoring, metrics, and alerts | ExpressRoute gateways"
      },
      {
        "url": "https://learn.microsoft.com/ja-jp/azure/expressroute/expressroute-network-insights",
        "name": "Azure ExpressRoute Insights using Network Insights"
      }
    ],
    "recommendationControl": "Monitoring and Alerting",
    "longDescription": "Network Insights を使用して、可用性、パフォーマンス、スケーラビリティなど、ExpressRoute Gateway の正常性を監視します。\n",
    "pgVerified": true,
    "description": "ExpressRoute ゲートウェイのゲートウェイの正常性を監視する",
    "potentialBenefits": "Enhanced monitoring and alerting",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/virtualNetworkGateways",
    "recommendationImpact": "High",
    "automationAvailable": false,
    "query": "// under-development\n\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "194c14ac-0d7a-5a48-ae32-75fa450ee564",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/expressroute/expressroute-about-virtual-network-gateways#vnet-to-vnet-connectivity",
        "name": "About ExpressRoute virtual network gateways - VNet-to-VNet connectivity"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "複数の VNet が同じ ExpressRoute ゲートウェイ経由で接続できますが、Microsoft では、VNet ピアリング、Azure Firewall、NVA、Azure Route Server、サイト間 VPN、仮想 WAN、SD-WAN などの代替手段を使用して、VNet 間通信にネットワークのパフォーマンスと管理を最適化することをお勧めします。\n",
    "pgVerified": true,
    "description": "VNet 間通信に ExpressRoute 回線を使用しないようにする",
    "potentialBenefits": "Enhanced VNet integration efficiency",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/virtualNetworkGateways",
    "recommendationImpact": "Medium",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "3e115044-a3aa-433e-be01-ce17d67e50da",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/ja-jp/azure/expressroute/customer-controlled-gateway-maintenance#azure-portal-steps",
        "name": "Configure customer-controlled maintenance for your virtual network gateway - ExpressRoute | Microsoft Learn"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "ExpressRoute ゲートウェイは、機能、信頼性、パフォーマンス、セキュリティを向上させるために更新されています。顧客制御のメンテナンス構成とスケジューリングにより、更新の影響を最小限に抑え、メンテナンス ウィンドウに合わせて調整します。\n",
    "pgVerified": true,
    "description": "顧客制御の ExpressRoute ゲートウェイのメンテナンスを構成する",
    "potentialBenefits": "Minimizes update impact",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/virtualNetworkGateways",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Find all Virtual Network Gateways without Maintenance Configurations\n\nresources\n| where type =~ \"Microsoft.Network/virtualNetworkGateways\"\n| extend resourceId = tolower(id)\n| join kind=leftouter  (\n    maintenanceresources\n    | where type =~ \"Microsoft.Maintenance/configurationAssignments\"\n    | project JsonData = parse_json(properties)\n    | extend maintenanceConfigurationId = tolower(tostring(JsonData.maintenanceConfigurationId))\n    | join kind=inner (\n        resources\n        | where type =~ \"Microsoft.Maintenance/maintenanceConfigurations\"\n        | project maintenanceConfigurationId=tolower(id)\n    ) on maintenanceConfigurationId\n    | project maintenanceConfigurationId, resourceId=tolower(tostring(JsonData.resourceId))\n) on resourceId\n| where isempty(maintenanceConfigurationId)\n| project recommendationId = \"3e115044-a3aa-433e-be01-ce17d67e50da\", name, id, tags, param1= strcat(\"sku-tier: \" , properties.sku.tier), param2=location\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "5b1933a6-90e4-f642-a01f-e58594e5aab2",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/vpn-gateway/about-zone-redundant-vnet-gateways",
        "name": "Zone redundant Virtual network gateway in availability zone"
      },
      {
        "url": "https://learn.microsoft.com/azure/vpn-gateway/about-zone-redundant-vnet-gateways#gwskus",
        "name": "Gateway SKU"
      },
      {
        "url": "https://www.microsoft.com/licensing/docs/view/Service-Level-Agreements-SLA-for-Online-Services?lang=1",
        "name": "SLA summary for Azure services"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "Azure VPN ゲートウェイでは、1 つまたは 2 つの可用性ゾーンでのデプロイに基づいて、さまざまな SLA が提供されます。ゾーン冗長仮想ネットワーク ゲートウェイを可用性ゾーンにデプロイすると、ゾーンの回復性が確保され、Azure 上のミッション クリティカルでスケーラブルなサービスへのアクセスが向上します。\n",
    "pgVerified": true,
    "description": "ゾーン冗長 VPN ゲートウェイを選択する",
    "potentialBenefits": "Enhanced reliability and scalability",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/virtualNetworkGateways",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// For all VNGs of type Vpn, show any that do not have AZ in the SKU tier\nresources\n| where type =~ \"Microsoft.Network/virtualNetworkGateways\"\n| where properties.gatewayType == \"Vpn\"\n| where properties.sku.tier !contains 'AZ'\n| project recommendationId = \"5b1933a6-90e4-f642-a01f-e58594e5aab2\", name, id, tags, param1= strcat(\"sku-tier: \" , properties.sku.tier), param2=location\n| order by id asc\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "281a2713-c0e0-3c48-b596-19f590c46671",
    "recommendationTypeId": "c249dc0e-9a17-423e-838a-d72719e8c5dd",
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/vpn-gateway/active-active-portal#gateway",
        "name": "Active-active VPN gateway"
      },
      {
        "url": "https://learn.microsoft.com/azure/vpn-gateway/vpn-gateway-about-vpn-gateway-settings#gwsku",
        "name": "Gateway SKU"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "アクティブ/アクティブ モードは、Basic を除くすべての SKU で使用でき、2 つのゲートウェイ IP 構成と 2 つのパブリック IP アドレスが可能になり、冗長性とトラフィック処理が強化されます。\n",
    "pgVerified": true,
    "description": "冗長性のためのアクティブ/アクティブ VPN ゲートウェイを有効化する",
    "potentialBenefits": "Enhanced reliability and network capacity",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/virtualNetworkGateways",
    "recommendationImpact": "Medium",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Identifies non-active-active VPN type virtual network gateways\nresources\n| where type =~ 'Microsoft.Network/virtualNetworkGateways'\n| where properties.gatewayType =~ \"vpn\"\n| extend gatewayType = properties.gatewayType, vpnType = properties.vpnType, connections = properties.connections, activeactive=properties.activeActive\n| where activeactive == false\n| project recommendationId = \"281a2713-c0e0-3c48-b596-19f590c46671\", name, id, tags\n\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "af11fc4c-c06c-4f4c-b98d-6eee6d5c4c70",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/vpn-gateway/vpn-gateway-highlyavailable#dual-redundancy-active-active-vpn-gateways-for-both-azure-and-on-premises-networks",
        "name": "Dual-redundancy active-active VPN gateways for both Azure and on-premises networks"
      }
    ],
    "recommendationControl": "Disaster Recovery",
    "longDescription": "アクティブ/アクティブ VPN コンセントレーターと Azure VPN ゲートウェイをデプロイすると、4 つの IPSec トンネルを含むフルメッシュ トポロジを使用して、回復性と可用性が最大化されます。\n",
    "pgVerified": true,
    "description": "アクティブ/アクティブ VPN コンセントレータをオンプレミスに導入して、VPN ゲートウェイで最大限の耐障害性を実現する",
    "potentialBenefits": "Maximizes resilience and availability",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/virtualNetworkGateways",
    "recommendationImpact": "High",
    "automationAvailable": false,
    "query": "// under-development\n\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "9eab120e-f6d3-ee49-ba0d-766562ce7df1",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/vpn-gateway/monitor-vpn-gateway-reference",
        "name": "VPN gateway data reference"
      }
    ],
    "recommendationControl": "Monitoring and Alerting",
    "longDescription": "仮想ネットワーク ゲートウェイの正常性の監視とアラートを設定して、運用効率を確保し、中断に迅速に対応するためのさまざまなメトリックを利用します。\n",
    "pgVerified": true,
    "description": "VPN ゲートウェイの接続と正常性を監視する",
    "potentialBenefits": "Improved uptime and issue awareness",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/virtualNetworkGateways",
    "recommendationImpact": "High",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "9186dae0-7ddc-8f4b-bea5-55538cea4893",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/azure-monitor/essentials/metrics-getting-started",
        "name": "Getting started with Azure Metrics Explorer"
      },
      {
        "url": "https://learn.microsoft.com/azure/vpn-gateway/monitor-vpn-gateway-reference#metrics",
        "name": "Monitor VPN gateway"
      }
    ],
    "recommendationControl": "Monitoring and Alerting",
    "longDescription": "VPN ゲートウェイは、サービス正常性を活用して、計画メンテナンスと計画外メンテナンスの両方についてユーザーに通知し、VPN 接続の変更についてユーザーに通知されるようにします。\n",
    "pgVerified": true,
    "description": "VPN ゲートウェイ サービスの正常性を有効にする",
    "potentialBenefits": "Improves VPN maintenance alerts",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/virtualNetworkGateways",
    "recommendationImpact": "High",
    "automationAvailable": false,
    "query": "// under-development\n\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "4bae5a28-5cf4-40d9-bcf1-623d28f6d917",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/vpn-gateway/about-zone-redundant-vnet-gateways",
        "name": "About zone-redundant virtual network gateway in Azure availability zones"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "ゾーン冗長 VPN ゲートウェイの場合は、常にゾーン冗長 Standard SKU パブリック IP を使用して、すべてのインスタンスが 1 つのゾーンにデプロイされないようにします。これにより、ゲートウェイの信頼性が確保され、アクティブ/パッシブ (シングル IP) とアクティブ/アクティブ (デュアル IP) の両方のセットアップに適用されます。\n",
    "pgVerified": true,
    "description": "ゾーン冗長パブリック IP を使用してゾーン冗長 VPN ゲートウェイをデプロイする",
    "potentialBenefits": "Enhanced reliability and disaster recovery",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/virtualNetworkGateways",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Provides a list of zone-redundant Azure VPN gateways associated with non-zone-redundant Public IPs\nresources\n| where type =~ \"Microsoft.Network/virtualNetworkGateways\"\n| where properties.gatewayType == \"Vpn\"\n| where properties.sku.tier contains 'AZ'\n| mv-expand ipconfig = properties.ipConfigurations\n| extend pipId = tostring(ipconfig.properties.publicIPAddress.id)\n| join kind=inner (\n    resources\n    | where type == \"microsoft.network/publicipaddresses\"\n    | where isnull(zones) or array_length(zones) < 3   )\n    on $left.pipId == $right.id\n| project recommendationId = \"4bae5a28-5cf4-40d9-bcf1-623d28f6d917\", name, id, tags, param1 = strcat(\"PublicIpAddressName: \", name1), param2 = strcat (\"PublicIpAddressId: \",id1), param3 = strcat (\"PublicIpAddressTags: \",tags1)\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "fd43ea32-2ccf-49a8-ada4-9a78794e3ff1",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/virtual-wan/monitoring-best-practices#point-to-site-vpn-gateway",
        "name": "Azure Virtual WAN の監視 - ベスト プラクティス"
      }
    ],
    "recommendationControl": "Monitoring and Alerting",
    "longDescription": "ポイント対サイト VPN ゲートウェイの監視とアラートを設定します。ゲートウェイの過剰使用、接続数の上限、ユーザー VPN ルートの上限などの重要なイベントに迅速に対応するためのアラート ルールを作成します。",
    "pgVerified": false,
    "description": "仮想ハブのポイント対サイト VPN ゲートウェイの正常性を監視する",
    "potentialBenefits": "Detection and mitigation to avoid disruptions.",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/p2sVpnGateways",
    "recommendationImpact": "High",
    "automationAvailable": false,
    "query": "// under-development\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "7d09523b-b3c0-403e-b104-d5d46240d683",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/reliability/reliability-dns",
        "name": "Azure DNS での信頼性"
      }
    ],
    "recommendationControl": "Disaster Recovery",
    "longDescription": "Azure DNS では、ゾーン内のレコード セットの TTL (Time-To-Live) を 1 ～ 2147483647 秒に設定できます。RPO 目標を達成するために、DNS ゾーンの DNS レコード セットの TTL が適切に設定されていることを確認する必要があります。\n",
    "pgVerified": false,
    "description": "TTL (Time-To-Live) が適切に設定され、RPO を確実に達成できるようにする",
    "potentialBenefits": "Ensures that no cached DNS records exist past RPO targets",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/dnsZones",
    "recommendationImpact": "High",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "60077378-7cb1-4b35-89bb-393884d9921d",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/ja-jp/azure/expressroute/expressroute-howto-erdirect#state",
        "name": "How to configure ExpressRoute Direct Change Admin State of links"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "Azure ExpressRoute Direct では、\"管理状態\" はレイヤー 1 リンクの管理状態を示し、リンクが有効か無効かを示し、物理ポートを効果的にオンまたはオフにします。\n",
    "pgVerified": true,
    "description": "ExpressRoute Direct の両方のリンクの管理状態が [有効] 状態である必要がある",
    "potentialBenefits": "Ensures optimal connectivity.",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/ExpressRoutePorts",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Find all Express Route Directs that do not have Admin State of both Links Enabled\nresources\n| where type == \"microsoft.network/expressrouteports\"\n| where properties['links'][0]['properties']['adminState'] == \"Disabled\" or properties['links'][1]['properties']['adminState'] == \"Disabled\"\n| project recommendationId = \"60077378-7cb1-4b35-89bb-393884d9921d\", name, id, tags, param1 = strcat(\"Link1AdminState: \", properties['links'][0]['properties']['adminState']), param2 = strcat(\"Link2AdminState: \", properties['links'][1]['properties']['adminState'])\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "0bee356b-7348-4799-8cab-0c71ffe13018",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/ja-jp/azure/expressroute/expressroute-erdirect-about?source=recommendations#circuit-sizes",
        "name": "About ExpressRoute Direct Circuit Sizes"
      }
    ],
    "recommendationControl": "Scalability",
    "longDescription": "10 Gbps または 100 Gbps の ExpressRoute Direct リソースで ExpressRoute 回線を最大 20 Gbps または 200 Gbps までプロビジョニングすることは可能ですが、回復性のためには推奨されません。ExpressRoute Direct ポートに障害が発生し、回線がフル キャパシティを使用している場合、残りのポートは余分な負荷を処理しません。\n",
    "pgVerified": true,
    "description": "ExpressRoute Direct をオーバー サブスクライブしないようにする",
    "potentialBenefits": "Improves resilience during port failures",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/ExpressRoutePorts",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Find all Express Route Directs that are over subscribed\nresources\n| where type == \"microsoft.network/expressrouteports\"\n| where toint(properties['provisionedBandwidthInGbps']) > toint(properties['bandwidthInGbps'])\n| project recommendationId = \"0bee356b-7348-4799-8cab-0c71ffe13018\", name, id, tags, param1 = strcat(\"provisionedBandwidthInGbps: \", properties['provisionedBandwidthInGbps']), param2 = strcat(\"bandwidthInGbps: \", properties['bandwidthInGbps'])\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "55815823-d588-4cb7-a5b8-ae581837356e",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://azure.github.io/azure-monitor-baseline-alerts/services/Network/expressRoutePorts/",
        "name": "Azure Monitor Baseline Alerts - expressRoutePorts"
      }
    ],
    "recommendationControl": "Monitoring and Alerting",
    "longDescription": "Network Insights を使用して、ExpressRoute ポートのライト レベル、ビット/秒の入出力、および回線プロトコルを監視します。Azure Monitor ベースライン アラートに基づいて、特定のしきい値を超えるライト レベル、ビット/秒の入出力、および回線プロトコルに関するアラートを設定します。\n",
    "pgVerified": false,
    "description": "ExpressRoute ポートの監視とアラートを構成する",
    "potentialBenefits": "Enhanced network performance and health",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/expressRoutePorts",
    "recommendationImpact": "High",
    "automationAvailable": false,
    "query": "// under-development\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "38c3bca1-97a1-eb42-8cd3-838b243f35ba",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/architecture/framework/services/networking/azure-load-balancer/reliability",
        "name": "Reliability and Azure Load Balancer"
      },
      {
        "url": "https://learn.microsoft.com/azure/architecture/checklist/resiliency-per-service#azure-load-balancer",
        "name": "Resiliency checklist for specific Azure services- Azure Load Balancer"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "Standard SKU Load Balancer を選択すると、可用性ゾーンとゾーンの回復性によって信頼性が向上し、デプロイがゾーンとリージョンの障害に耐えられるようになります。Basic とは異なり、グローバル負荷分散をサポートし、SLA を提供します。\n",
    "pgVerified": true,
    "description": "Standard Load Balancer SKU を使用する",
    "potentialBenefits": "Enhanced reliability and SLA support",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/loadBalancers",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Find all LoadBalancers using Basic SKU\nresources\n| where type =~ 'Microsoft.Network/loadBalancers'\n| where sku.name == 'Basic'\n| project recommendationId = \"38c3bca1-97a1-eb42-8cd3-838b243f35ba\", name, id, tags, Param1=strcat(\"sku-tier: basic\")\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "6d82d042-6d61-ad49-86f0-6a5455398081",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/architecture/checklist/resiliency-per-service#azure-load-balancer",
        "name": "Resiliency checklist for specific Azure services- Azure Load Balancer"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "バックエンドに少なくとも 2 つのインスタンスを使用して Azure Load Balancer をデプロイすると、単一障害点が防止され、スケーラビリティがサポートされます。最適なスケール構築のために、仮想マシン スケール セットとペアリングすることをお勧めします。\n",
    "pgVerified": true,
    "description": "バックエンド プールに少なくとも 2 つのインスタンスが含まれていることを確認する",
    "potentialBenefits": "Enhances reliability and scalability",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/loadBalancers",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Find all LoadBalancers which only have 1 backend pool defined or only 1 VM in the backend pool\nresources\n| where type =~ 'Microsoft.Network/loadBalancers'\n| extend bep = properties.backendAddressPools\n| extend BackEndPools = array_length(bep)\n| where BackEndPools == 0\n| project recommendationId = \"6d82d042-6d61-ad49-86f0-6a5455398081\", name, id, Param1=\"backendPools\", Param2=toint(0), tags\n| union (resources\n  | where type =~ 'Microsoft.Network/loadBalancers'\n  | where sku.name == \"Standard\"\n  | extend bep = properties.backendAddressPools\n  | extend BackEndPools = toint(array_length(bep))\n  | mv-expand bip = properties.backendAddressPools\n  | extend BackendAddresses = array_length(bip.properties.loadBalancerBackendAddresses)\n  | where toint(BackendAddresses) <= 1\n  | project recommendationId = \"6d82d042-6d61-ad49-86f0-6a5455398081\", name, id, tags, Param1=\"backendAddresses\", Param2=toint(BackendAddresses))\n| union (\n  resources\n  | where type =~ 'Microsoft.Network/loadBalancers'\n  | where sku.name == \"Basic\"\n  | mv-expand properties.backendAddressPools\n  | extend backendPoolId = properties_backendAddressPools.id\n  | project id, name, tags, tostring(backendPoolId), recommendationId = \"6d82d042-6d61-ad49-86f0-6a5455398081\", Param1=\"BackEndPools\"\n  | join kind = leftouter (\n  resources\n  | where type =~ \"Microsoft.Network/networkInterfaces\"\n  | mv-expand properties.ipConfigurations\n  | mv-expand properties_ipConfigurations.properties.loadBalancerBackendAddressPools\n  | extend backendPoolId = tostring(properties_ipConfigurations_properties_loadBalancerBackendAddressPools.id)\n  | summarize poolMembers = count() by backendPoolId\n  | project tostring(backendPoolId), poolMembers ) on backendPoolId\n  | where toint(poolMembers) <= 1\n  | extend BackendAddresses = poolMembers\n  | project id, name, tags, recommendationId, Param1=\"backendAddresses\", Param2=toint(BackendAddresses))\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "8d319a05-677b-944f-b9b4-ca0fb42e883c",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/architecture/checklist/resiliency-per-service#azure-load-balancer",
        "name": "Resiliency checklist for specific Azure services- Azure Load Balancer"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "Standard Public Load Balancer の送信規則では、バックエンド プールのポートを手動で割り当てて、スケーラビリティと SNAT ポートの枯渇のリスクを制限します。NAT ゲートウェイは、動的スケーリングと安全なインターネット接続のために推奨されます。\n",
    "pgVerified": true,
    "description": "本番ワークロードの送信ルールの代わりに NAT ゲートウェイを使用する",
    "potentialBenefits": "Enhanced scalability and reliability",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/loadBalancers",
    "recommendationImpact": "Medium",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Find all LoadBalancers with Outbound rules configured\nresources\n| where type =~ 'Microsoft.Network/loadBalancers'\n| extend outboundRules = array_length(properties.outboundRules)\n| where outboundRules > 0\n| project recommendationId = \"8d319a05-677b-944f-b9b4-ca0fb42e883c\", name, id, tags, Param1 = \"outboundRules: >=1\"\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "621dbc78-3745-4d32-8eac-9e65b27b7512",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/ja-jp/azure/load-balancer/load-balancer-standard-availability-zones#zone-redundant",
        "name": "Load Balancer and Availability Zones"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "可用性ゾーンがあるリージョンでは、ゾーン冗長フロントエンド IP を Standard Load Balancer に割り当てると、1 つの可用性ゾーンに障害が発生した場合でも、他の正常なゾーンとバックエンド インスタンスがトラフィックを受信できる場合、トラフィックの継続的な分散が保証されます。\n",
    "pgVerified": true,
    "description": "Standard Load Balancer がゾーン冗長であることを確認する",
    "potentialBenefits": "Enhances uptime and resilience",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/loadBalancers",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Find all LoadBalancers with with regional or zonal public IP Addresses\nresources\n| where type == \"microsoft.network/loadbalancers\"\n| where tolower(sku.name) != 'basic'\n| mv-expand feIPconfigs = properties.frontendIPConfigurations\n| extend\n    feConfigName = (feIPconfigs.name),\n    PrivateSubnetId = toupper(feIPconfigs.properties.subnet.id),\n    PrivateIPZones = feIPconfigs.zones,\n    PIPid = toupper(feIPconfigs.properties.publicIPAddress.id),\n    JoinID = toupper(id)\n| where isnotempty(PrivateSubnetId)\n| where isnull(PrivateIPZones) or array_length(PrivateIPZones) < 2\n| project name, feConfigName, id\n| union (resources\n    | where type == \"microsoft.network/loadbalancers\"\n    | where tolower(sku.name) != 'basic'\n    | mv-expand feIPconfigs = properties.frontendIPConfigurations\n    | extend\n        feConfigName = (feIPconfigs.name),\n        PIPid = toupper(feIPconfigs.properties.publicIPAddress.id),\n        JoinID = toupper(id)\n    | where isnotempty(PIPid)\n    | join kind=innerunique (\n        resources\n        | where type == \"microsoft.network/publicipaddresses\"\n        | where isnull(zones) or array_length(zones) < 2\n        | extend\n            LBid = toupper(substring(properties.ipConfiguration.id, 0, indexof(properties.ipConfiguration.id, '/frontendIPConfigurations'))),\n            InnerID = toupper(id)\n    ) on $left.PIPid == $right.InnerID)\n| project recommendationId = \"621dbc78-3745-4d32-8eac-9e65b27b7512\", name, id, tags, param1=\"Zones: No Zone or Zonal\", param2=strcat(\"Frontend IP Configuration:\", \" \", feConfigName)\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "e5f5fcea-f925-4578-8599-9a391e888a60",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/ja-jp/azure/load-balancer/load-balancer-custom-probe-overview",
        "name": "Load Balancer Health Probe Overview"
      }
    ],
    "recommendationControl": "Monitoring and Alerting",
    "longDescription": "正常性プローブは、バックエンド エンドポイントの状態を判断するために Azure Load Balancer によって使用されます。ベンダーの推奨事項に沿ったカスタム正常性プローブを使用すると、バックエンドの可用性の理解が深まり、バックエンド サービスの影響の監視が容易になります。\n",
    "pgVerified": true,
    "description": "正常性プローブを使用してバックエンド インスタンスの可用性を検出する",
    "potentialBenefits": "Ensures backend uptime monitoring.",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/loadBalancers",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// List the load balancers which don't have health probe configured\nresources\n| where type =~ \"microsoft.network/loadbalancers\"\n| where array_length(properties.probes) == 0\n| project recommendationId=\"e5f5fcea-f925-4578-8599-9a391e888a60\", name, id, tags, param1=\"customHealthProbeUsed: false\"\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "2820f6d6-a23c-7a40-aec5-506f3bd1aeb6",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/dns/dns-protect-private-zones-recordsets",
        "name": "プライベート DNS ゾーンとレコードを保護する方法"
      }
    ],
    "recommendationControl": "Security",
    "longDescription": "組み込みの「プライベート DNS ゾーンの共同作成者」ロールを特定の許可されたユーザー、グループ、およびエンティティに割り当て、プライベート DNS ゾーンとレコードへの不正または偶発的な変更から保護します。すべてのゾーンに「プライベート DNS ゾーンの共同作成者」権限を付与して、アクセスを制限します。\n",
    "pgVerified": true,
    "description": "プライベート DNS ゾーンとレコードを保護する",
    "potentialBenefits": "Prevents DNS outages",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/privateDnsZones",
    "recommendationImpact": "Medium",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "ab896e8c-49b9-2c44-adec-98339aff7821",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://azure.github.io/azure-monitor-baseline-alerts/services/Network/privateDnsZones/",
        "name": "Azure Monitor Baseline Alerts - privateDnsZones"
      }
    ],
    "recommendationControl": "Monitoring and Alerting",
    "longDescription": "Azure Monitor を使用して、プライベート DNS ゾーンのクエリ量、レコード セット数、加えて、レコード セットや仮想ネットワーク リンク、自動登録付き仮想ネットワーク リンクのキャパシティ メトリックを監視します。これらのメトリックに対して Azure Monitor Baseline Alerts の特定のしきい値に基づいてアラートを作成します。\n",
    "pgVerified": true,
    "description": "プライベート DNS ゾーンの正常性を監視し、アラートを設定する",
    "potentialBenefits": "Enhanced DNS reliability and alerting",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/privateDnsZones",
    "recommendationImpact": "High",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "1e02335c-1f90-fd4e-a5a5-d359c7b22d70",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/private-link-and-dns-integration-at-scale",
        "name": "Private Link と DNS の大規模な統合"
      }
    ],
    "recommendationControl": "Disaster Recovery",
    "longDescription": "復旧時間目標 (RTO) が低い事業継続シナリオの場合、リージョンごとに本番環境と災害復旧環境 (DR) のプライベート DNS ゾーンを構成し、ワークロードとリソースの DNS エントリが同一であることを確認します。これにより、両方のゾーンで DNS 解決の一貫性が保たれます。\n",
    "pgVerified": true,
    "description": "低い復旧時間目標 (RTO) 要件がある場合は、リージョンごとのプライベート DNS ゾーンを使用する",
    "potentialBenefits": "Ensures seamless failover for DNS during a regional outage",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/privateDnsZones",
    "recommendationImpact": "Medium",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "3538aa48-c40b-455b-a93b-269fe6e65be2",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/reliability/reliability-dns",
        "name": "Azure DNS での信頼性"
      }
    ],
    "recommendationControl": "Disaster Recovery",
    "longDescription": "Azure プライベート DNS では、ゾーン内のレコード セットの TTL (Time-To-Live) を 1 ～ 2147483647 秒に設定できます。RPO 目標を達成するために、DNS ゾーンの DNS レコード セットの TTL が適切に設定されていることを確認する必要があります。\n",
    "pgVerified": false,
    "description": "TTL (Time-To-Live) が適切に設定され、RPO を確実に達成できるようにする",
    "potentialBenefits": "Ensures that no cached DNS records exist past RPO targets",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/privateDnsZones",
    "recommendationImpact": "High",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "30ec8a5e-46de-4323-87e9-a7c56b72813b",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/virtual-wan/monitoring-best-practices#virtual-hub",
        "name": "Azure Virtual WAN の監視 - ベスト プラクティス"
      }
    ],
    "recommendationControl": "Monitoring and Alerting",
    "longDescription": "仮想ハブの監視とアラートを設定します。仮想ハブの BGP ステータスや処理されるデータの変更に迅速に対応するためのアラート ルールを作成します。",
    "pgVerified": false,
    "description": "仮想ハブの正常性を監視する",
    "potentialBenefits": "Detection and mitigation to avoid disruptions.",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/virtualHubs",
    "recommendationImpact": "Medium",
    "automationAvailable": false,
    "query": null
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "d0cfe47f-686b-5043-bf83-5a3868acb80a",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-monitor?pivots=front-door-standard-premium#access-logs",
        "name": "Azure Web Application Firewall monitoring and logging - Access Log"
      },
      {
        "url": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-tuning?pivots=front-door-standard-premium#understanding-waf-logs",
        "name": "Understanding WAF logs"
      },
      {
        "url": "https://learn.microsoft.com/azure/web-application-firewall/ag/application-gateway-waf-configuration?tabs=portal",
        "name": "Web Application Firewall exclusion lists"
      },
      {
        "url": "https://learn.microsoft.com/azure/web-application-firewall/ag/web-application-firewall-troubleshoot#fixing-false-positives",
        "name": "Fixing a false positive"
      }
    ],
    "recommendationControl": "Monitoring and Alerting",
    "longDescription": "WAF は、正当な要求 (誤検知) を誤ってブロックする可能性があります。これらは、Log Analytics でブロックされた要求の過去 24 時間を調べることで特定できます。\n",
    "pgVerified": true,
    "description": "Azure Front Door WAF ログを調べて、誤ってブロックされた正当な要求を確認する",
    "potentialBenefits": "Reduces false positives, improves access",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/frontdoorWebApplicationFirewallPolicies",
    "recommendationImpact": "High",
    "automationAvailable": false,
    "query": "// cannot-be-validated-with-arg\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "537b4d94-edd1-4041-b13d-8217dfa485f0",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/web-application-firewall/ag/application-gateway-waf-metrics#logs-and-diagnostics",
        "name": "Azure Web Application Firewall Monitoring and Logging"
      },
      {
        "url": "https://learn.microsoft.com/azure/web-application-firewall/ag/web-application-firewall-logs#diagnostic-logs",
        "name": "Diagnostic logs"
      }
    ],
    "recommendationControl": "Monitoring and Alerting",
    "longDescription": "WAF は、正当な要求を誤検知としてブロックする場合があります。Log Analytics を使用して過去 24 時間以内にブロックされた要求を特定すると、これらの不適切なブロックを効率的に管理および軽減するのに役立ちます。\n",
    "pgVerified": true,
    "description": "Azure Application Gateway WAF ログで、誤ってブロックされた有効な要求を確認する",
    "potentialBenefits": "Improve false positive identification",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/frontdoorWebApplicationFirewallPolicies",
    "recommendationImpact": "High",
    "automationAvailable": false,
    "query": "// cannot-be-validated-with-arg\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "5357ae22-0f52-1a49-9fd4-1f00ace6add0",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview#waf-monitoring",
        "name": "WAF monitoring"
      },
      {
        "url": "https://github.com/Azure/Azure-Network-Security/tree/master/Azure%20WAF/Workbook%20-%20WAF%20Monitor%20Workbook",
        "name": "Azure Monitor Workbook for WAF"
      }
    ],
    "recommendationControl": "Monitoring and Alerting",
    "longDescription": "Web Application Firewall とそれが保護するアプリケーションの正常性を監視することは非常に重要です。これは、Microsoft Defender for Cloud、Azure Monitor、Azure Monitor ログとの統合によって実現され、最適なパフォーマンスとセキュリティが確保されます。\n",
    "pgVerified": false,
    "description": "Web アプリケーション ファイアウォールを監視する",
    "potentialBenefits": "Enhanced security and health insight",
    "tags": null,
    "recommendationResourceType": "Microsoft.Network/frontdoorWebApplicationFirewallPolicies",
    "recommendationImpact": "High",
    "automationAvailable": false,
    "query": "// cannot-be-validated-with-arg\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "6a8b3db9-5773-413a-a127-4f7032f34bbd",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/azure-signalr/availability-zones",
        "name": "Availability zones support in Azure SignalR Service"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "運用環境にゾーン冗長で SignalR を使用して、稼働時間を向上させます。この機能は Premium レベルで利用可能で、Premium の作成時またはアップグレード時に有効になります。Standard は、ダウンタイムなしで Premium にアップグレードできます。\n",
    "pgVerified": false,
    "description": "SignalR のゾーン冗長を有効にする",
    "potentialBenefits": "Enhances reliability and uptime",
    "tags": null,
    "recommendationResourceType": "Microsoft.SignalRService/SignalR",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Find SignalR instances that are not configured with the Premium tier\nresources\n| where type == \"microsoft.signalrservice/signalr\"\n| where sku.tier != \"Premium\"\n| project recommendationId = \"6a8b3db9-5773-413a-a127-4f7032f34bbd\", name, id, tags, param1 = \"AvailabilityZones: Single Zone\"\n| order by id asc\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "bb6deb9d-24fa-4ee8-bc23-ac3ebc7fdf8e",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/entra/identity/domain-services/tutorial-create-replica-set",
        "name": "Microsoft Entra Domain Services で回復性または位置情報のためのレプリカ セットを作成して使用する"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "レプリカ セットをサポートするには、マネージド ドメインに少なくとも Enterprise SKU を使用する必要があります。\n",
    "pgVerified": false,
    "description": "少なくとも Enterprise SKU を使用する",
    "potentialBenefits": "The Enterprise SKU enables creation of replica sets.",
    "tags": null,
    "recommendationResourceType": "Microsoft.AAD/domainServices",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Gets Entry Domain Services that are using the Standard SKU\nresources\n| where type == \"microsoft.aad/domainservices\"\n| extend sku = properties.sku\n| where sku =~ 'Standard'\n| project recommendationId='bb6deb9d-24fa-4ee8-bc23-ac3ebc7fdf8e', name=name, id=id, tags=tags, param1=strcat('SKU:', sku)\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "a3058909-fcf8-4450-88b5-499f57449178",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/entra/identity/domain-services/tutorial-create-replica-set",
        "name": "Microsoft Entra Domain Services で回復性または位置情報のためのレプリカ セットを作成して使用する"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "Microsoft Entra Domain Services マネージド ドメインの回復性を向上させる場合や、アプリケーションに近い追加の地理的な場所にデプロイする場合は、レプリカ セットを使用できます。\nDomain Services をサポートする Azure リージョンのピアリングされた仮想ネットワークにレプリカ セットを追加できます。\n",
    "pgVerified": false,
    "description": "レプリカ セットを使用して、Microsoft Entra Domain Services の回復性または位置情報を取得する",
    "potentialBenefits": "The replica sets provide geographical resiliency.",
    "tags": null,
    "recommendationResourceType": "Microsoft.AAD/domainServices",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Gets Entry Domain Services that are using only one replicaSet\nresources\n| where type == \"microsoft.aad/domainservices\"\n| extend replicaSets = properties.replicaSets\n| where array_length(replicaSets) < 2\n| project recommendationId='a3058909-fcf8-4450-88b5-499f57449178', name=name, id=id, tags=tags, param1=strcat('replicaSetLocation:', replicaSets[0].location)\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "4f63619f-5001-439c-bacb-8de891287727",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/aks/availability-zones",
        "name": "AKS の可用性ゾーン"
      },
      {
        "url": "https://learn.microsoft.com/azure/virtual-machine-scale-sets/virtual-machine-scale-sets-use-availability-zones#zone-balancing",
        "name": "ゾーン バランス"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "可用性ゾーンは、アプリケーションとデータをデータセンター レベルの障害から確実に保護するために、独自の電源、冷却手段、ネットワークを備えたリージョン内の独立した場所を提供することで、高可用性を確保します。\n",
    "pgVerified": true,
    "description": "可用性ゾーン間で AKS クラスターをデプロイする",
    "potentialBenefits": "Enhanced fault tolerance for AKS",
    "tags": null,
    "recommendationResourceType": "Microsoft.ContainerService/managedClusters",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Returns AKS clusters that do not have any availability zones enabled or only use a single zone\nresources\n| where type =~ \"Microsoft.ContainerService/managedClusters\"\n| project id, name, tags, location, pools = properties.agentPoolProfiles\n| mv-expand pool = pools\n| extend\n    numOfAvailabilityZones = iif(isnull(pool.availabilityZones), 0, array_length(pool.availabilityZones))\n| where numOfAvailabilityZones < 2\n| project\n    recommendationId = \"4f63619f-5001-439c-bacb-8de891287727\",\n    id,\n    name,\n    tags,\n    param1 = strcat(\"NodePoolName: \", pool.name),\n    param2 = strcat(\"Mode: \", pool.mode),\n    param3 = strcat(\"AvailabilityZones: \", iif(numOfAvailabilityZones == 0, \"None\", strcat(\"Zone \", strcat_array(pool.availabilityZones, \", \")))),\n    param4 = strcat(\"Location: \", location)\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "5ee083cd-6ac3-4a83-8913-9549dd36cf56",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/aks/use-system-pools?tabs=azure-cli#system-and-user-node-pools",
        "name": "システムおよびユーザー ノード プール"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "AKS は、システム ノード プール内のノードに kubernetes.azure.com/mode: システム ラベルを割り当て、システム ポッドが優先的にそこでスケジュールされる必要があることを示します。CriticalAddonsOnly=true:NoSchedule テイントをシステム ノードに追加して、アプリケーション ポッドのスケジュールを禁止できます。\n",
    "pgVerified": false,
    "description": "システム ポッドとアプリケーション ポッドを分離する",
    "potentialBenefits": "Enhanced reliability via pod isolation",
    "tags": null,
    "recommendationResourceType": "Microsoft.ContainerService/managedClusters",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Returns each AKS cluster with nodepools that do not have system pods labelled with CriticalAddonsOnly\nresources\n| where type == \"microsoft.containerservice/managedclusters\"\n| mv-expand agentPoolProfile = properties.agentPoolProfiles\n| where agentPoolProfile.mode =~ 'System' // system node pools\n| extend taint = tostring(parse_json(agentPoolProfile.nodeTaints))\n| extend hasCriticalAddonsTaint = agentPoolProfile.kubeletConfig has 'CriticalAddonsOnly'\n| extend hasNodeLabel = agentPoolProfile.customNodeLabels has 'CriticalAddonsOnly'\n| extend hasCriticalAddonsOnly = hasCriticalAddonsTaint or hasNodeLabel or isempty(taint)\n| extend nodePool = tostring(parse_json(agentPoolProfile.name))\n| where hasCriticalAddonsOnly\n| project\n    recommendationId=\"5ee083cd-6ac3-4a83-8913-9549dd36cf56\",\n    id,\n    name,\n    tags,\n    param1=strcat(\"nodepoolName: \", nodePool)\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "ca324d71-54b0-4a3e-b9e4-10e767daa9fc",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/aks/concepts-identity#azure-ad-integration",
        "name": "Microsoft Entra の統合"
      },
      {
        "url": "https://learn.microsoft.com/azure/aks/manage-azure-rbac",
        "name": "Kubernetes 認可に Azure ロールベースのアクセス制御を使用する"
      },
      {
        "url": "https://learn.microsoft.com/azure/aks/manage-local-accounts-managed-azure-ad",
        "name": "AKS マネージド Microsoft Entra 統合を使用してローカル アカウントを管理する"
      }
    ],
    "recommendationControl": "Security",
    "longDescription": "AKS のローカル Kubernetes アカウントは、監査不可能でレガシーであるため、推奨されません。Microsoft Entra の統合により、一元管理、多要素認証、詳細なアクセスのための RBAC、Azure および外部 ID プロバイダーと互換性のある安全でスケーラブルな認証システムが提供されます。\n",
    "pgVerified": false,
    "description": "ローカル アカウントを無効にする",
    "potentialBenefits": "Enhanced security and access control",
    "tags": null,
    "recommendationResourceType": "Microsoft.ContainerService/managedClusters",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Returns a list of AKS clusters not using AAD enabled\nresources\n| where type == \"microsoft.containerservice/managedclusters\"\n| extend aadProfile = tostring (parse_json(properties.aadProfile))\n| extend disablelocalAdmin = tostring(parse_json(properties.disableLocalAccounts))\n| extend RBAC = tostring(parse_json(properties.enableRBAC))\n| where RBAC == \"false\"\n| project recommendationId=\"ca324d71-54b0-4a3e-b9e4-10e767daa9fc\", name, id, tags, param1=strcat(\"aadProfile: \", aadProfile), param2=strcat(\"disablelocalAdmin: \",disablelocalAdmin), param3=strcat(\"RBAC: \", RBAC)\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "c22db132-399b-4e7c-995d-577a60881be8",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/aks/configure-azure-cni-dynamic-ip-allocation",
        "name": "Azure CNI ネットワークを構成する"
      },
      {
        "url": "https://learn.microsoft.com/azure/aks/azure-cni-overlay",
        "name": "Azure CNI Overlay ネットワークを構成する"
      }
    ],
    "recommendationControl": "Scalability",
    "longDescription": "Azure CNI は、クラスター IP とネットワークの管理を強化し、動的 IP 割り当て、スケーラブルなサブネット、ポッドと VNet の直接接続を可能にし、Azure ネットワーク ポリシーと Calico を使用してポッドとノードの多様なネットワーク ポリシーをサポートし、ネットワークの効率とセキュリティを最適化します。\n",
    "pgVerified": false,
    "description": "IP の動的割り当てのために Azure CNI ネットワークを構成する",
    "potentialBenefits": "Dynamic IP allocation, scalable subnets, direct VNET access",
    "tags": null,
    "recommendationResourceType": "Microsoft.ContainerService/managedClusters",
    "recommendationImpact": "Medium",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Check AKS Clusters using kubenet network profile\nresources\n| where type == \"microsoft.containerservice/managedclusters\"\n| extend networkProfile = tostring (parse_json(properties.networkProfile.networkPlugin))\n| where networkProfile ==\"kubenet\"\n| project recommendationId=\"c22db132-399b-4e7c-995d-577a60881be8\", name, id, tags, param1=strcat(\"networkProfile :\",networkProfile)\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "902c82ff-4910-4b61-942d-0d6ef7f39b67",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/aks/cluster-autoscaler",
        "name": "Azure Kubernetes Service (AKS) でのクラスター オートスケーラーの使用"
      },
      {
        "url": "https://learn.microsoft.com/azure/aks/operator-best-practices-advanced-scheduler",
        "name": "高度なスケジューラ機能に関するベスト プラクティス"
      },
      {
        "url": "https://learn.microsoft.com/azure/aks/best-practices-performance-scale-large#node-pool-scaling",
        "name": "ノード プールのスケーリングの考慮事項とベスト プラクティス"
      },
      {
        "url": "https://learn.microsoft.com/azure/aks/operator-best-practices-scheduler",
        "name": "基本的なスケジューラ機能に関するベスト プラクティス"
      }
    ],
    "recommendationControl": "Scalability",
    "longDescription": "AKS のクラスター オートスケーラーは、ポッド リソースのニーズと使用可能なキャパシティに基づいてノード数を調整し、需要に応じてスケーリングして停止を防ぎます。\n",
    "pgVerified": true,
    "description": "既存のクラスターでクラスター オートスケーラーを有効にする",
    "potentialBenefits": "Optimizes scaling and prevents outages",
    "tags": null,
    "recommendationResourceType": "Microsoft.ContainerService/managedClusters",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Find AKS clusters with auto-scaling disabled\nResources\n| where type == \"microsoft.containerservice/managedclusters\"\n| extend autoScaling = tostring (parse_json(properties.agentPoolProfiles.[0].enableAutoScaling))\n| where autoScaling == \"false\"\n| project recommendationId=\"902c82ff-4910-4b61-942d-0d6ef7f39b67\", name, id, tags, param1=strcat(\"autoScaling :\", autoScaling)\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "269a9f1a-6675-460a-831e-b05a887a8c4b",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/backup/azure-kubernetes-service-cluster-backup",
        "name": "AKS のバックアップ"
      },
      {
        "url": "https://learn.microsoft.com/azure/aks/operator-best-practices-storage",
        "name": "AKS バックアップのベスト プラクティス"
      }
    ],
    "recommendationControl": "Disaster Recovery",
    "longDescription": "バックアップを必要とするステートフル アプリで人気の AKS は、インストールされたバックアップ拡張機能を介して Azure Backup を使用してクラスターとアタッチされたボリュームを保護でき、バックアップ コンテナー経由でバックアップと復元の操作が可能です。\n",
    "pgVerified": true,
    "description": "Azure Kubernetes Service をバックアップする",
    "potentialBenefits": "Ensures data safety for AKS",
    "tags": null,
    "recommendationResourceType": "Microsoft.ContainerService/managedClusters",
    "recommendationImpact": "Low",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Find AKS clusters that do not have backup enabled\n\nresources\n| where type =~ 'Microsoft.ContainerService/managedClusters'\n| extend lname = tolower(name)\n| join kind=leftouter(recoveryservicesresources\n    | where type =~ 'microsoft.dataprotection/backupvaults/backupinstances'\n    | extend lname = tolower(tostring(split(properties.dataSourceInfo.resourceID, '/')[8]))\n    | extend protectionState = properties.currentProtectionState\n    | project lname, protectionState) on lname\n| where protectionState != 'ProtectionConfigured'\n| extend param1 = iif(isnull(protectionState), 'Protection Not Configured', strcat('Protection State: ', protectionState))\n| project recommendationId = \"269a9f1a-6675-460a-831e-b05a887a8c4b\", name, id, tags, param1\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "d3111036-355d-431b-ab49-8ddad042800b",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/reliability/availability-zones-overview",
        "name": "可用性ゾーンとは"
      },
      {
        "url": "https://learn.microsoft.com/azure/storage/common/storage-redundancy#zone-redundant-storage",
        "name": "ゾーン冗長ストレージ"
      },
      {
        "url": "https://learn.microsoft.com/azure/virtual-machines/disks-redundancy#zone-redundant-storage-for-managed-disks",
        "name": "ZRS ディスク"
      },
      {
        "url": "https://learn.microsoft.com/azure/virtual-machines/disks-migrate-lrs-zrs",
        "name": "LRS から ZRS にディスクを変換する"
      },
      {
        "url": "https://learn.microsoft.com/azure/storage/container-storage/enable-multi-zone-redundancy",
        "name": "Azure Container Storage でマルチゾーン ストレージ冗長性を有効にする"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "ZRS は、3 つのゾーン間でのデータ レプリケーションを保証し、ゾーンの停止から保護します。ストレージ クラスで SKU を ZRS に設定することで、Azure Disks、Container Storage、Files、Blob で使用でき、v1.29 以降でマルチゾーン AKS クラスターが強化されます。\n",
    "pgVerified": true,
    "description": "マルチゾーン AKS を実行している場合は永続ボリュームにゾーン冗長ストレージを使用する",
    "potentialBenefits": "Increases data durability and availability",
    "tags": null,
    "recommendationResourceType": "Microsoft.ContainerService/managedClusters",
    "recommendationImpact": "Medium",
    "automationAvailable": false,
    "query": "// cannot-be-validated-with-arg\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "b002c030-72e6-4a37-8217-1cb276c43169",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/aks/csi-storage-drivers",
        "name": "CSI ストレージ ドライバー"
      },
      {
        "url": "https://learn.microsoft.com/azure/aks/csi-migrate-in-tree-volumes",
        "name": "ツリー内ストレージ クラスから AKS 上の CSI ドライバーに移行する"
      }
    ],
    "recommendationControl": "Governance",
    "longDescription": "Kubernetes 1.26 以降、Azure Disk と Azure File のツリー内ドライバーは非推奨となり、CSI ドライバーが優先されます。既存の展開は引き続き運用可能ですが、テストは行われていません。ユーザーは、新機能と SKU のために CSI ドライバーに切り替える必要があります。\n",
    "pgVerified": true,
    "description": "ツリー内ドライバーを使用した永続ボリュームを Azure CSI ドライバーにアップグレードする",
    "potentialBenefits": "Ensures future compatibility",
    "tags": null,
    "recommendationResourceType": "Microsoft.ContainerService/managedClusters",
    "recommendationImpact": "High",
    "automationAvailable": false,
    "query": "// cannot-be-validated-with-arg\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "9a1c17e5-c9a0-43db-b920-adaf54d1bcb7",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://kubernetes.io/docs/concepts/policy/resource-quotas/",
        "name": "Resource Quotas"
      }
    ],
    "recommendationControl": "Scalability",
    "longDescription": "ResourceQuota オブジェクトは、名前空間ごとのリソース使用の制限を設定し、作成されるオブジェクトの数と種類、および使用可能なコンピューティング リソースの合計を制御します。\n",
    "pgVerified": false,
    "description": "リソース クォータを実装して、Kubernetes リソースがハード リソース制限を超えないようにする",
    "potentialBenefits": "Limits AKS resource usage per namespace",
    "tags": null,
    "recommendationResourceType": "Microsoft.ContainerService/managedClusters",
    "recommendationImpact": "Low",
    "automationAvailable": false,
    "query": "// cannot-be-validated-with-arg\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "b4639ca7-6308-429a-8b98-92f0bf9bf813",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/aks/virtual-nodes",
        "name": "仮想ノード"
      },
      {
        "url": "https://learn.microsoft.com/azure/container-instances/container-instances-overview",
        "name": "Azure Container Instances"
      }
    ],
    "recommendationControl": "Scalability",
    "longDescription": "AKS ワークロードを迅速にスケーリングするには、Kubernetes オートスケーラーとは異なり、ポッドのプロビジョニングを迅速に行うために仮想ノードを利用します。可用性ゾーンを持つクラスターの場合は、永続ボリュームが可用性ゾーン間で機能しないため、可用性ゾーンごとに 1 つのノード プールを確保し、アクセス権がない場合にオートスケーラー ポッドの作成に失敗するのを防ぎます。\n",
    "pgVerified": false,
    "description": "仮想ノード (ACI) を AKS クラスターに接続する",
    "potentialBenefits": "Faster scaling with virtual nodes",
    "tags": null,
    "recommendationResourceType": "Microsoft.ContainerService/managedClusters",
    "recommendationImpact": "Low",
    "automationAvailable": false,
    "query": "// cannot-be-validated-with-arg\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "0611251f-e70f-4243-8ddd-cfe894bec2e7",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/aks/free-standard-pricing-tiers",
        "name": "価格レベル"
      },
      {
        "url": "https://learn.microsoft.com/azure/architecture/reference-architectures/containers/aks/baseline-aks?toc=https%3A%2F%2Flearn.microsoft.com%2Fen-us%2Fazure%2Faks%2Ftoc.json&bc=https%3A%2F%2Flearn.microsoft.com%2Fen-us%2Fazure%2Fbread%2Ftoc.json#kubernetes-api-server-sla",
        "name": "AKS ベースライン アーキテクチャ"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "運用 AKS クラスターでは、返金制度のある SLA と強化されたノードのスケーラビリティのために Standard レベルが必要です。無料サービスにはこうした機能はありません。\n",
    "pgVerified": true,
    "description": "AKS のレベルを Standard に更新する",
    "potentialBenefits": "SLA guarantee and better scalability",
    "tags": null,
    "recommendationResourceType": "Microsoft.ContainerService/managedClusters",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Returns all AKS clusters not running on the Standard tier\nresources\n| where type == \"microsoft.containerservice/managedclusters\"\n| where sku.tier != \"Standard\"\n| project recommendationId=\"0611251f-e70f-4243-8ddd-cfe894bec2e7\", id, name, tags, param1=strcat(\"skuName: \", sku.name), param2=strcat(\"skuTier: \", sku.tier)\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "dcaf8128-94bd-4d53-9235-3a0371df6b74",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/aks/monitor-aks",
        "name": "AKS を監視する"
      }
    ],
    "recommendationControl": "Monitoring and Alerting",
    "longDescription": "Azure Monitor を使用すると、イベントの収集、コンテナー ログのキャプチャ、Metrics API からの CPU/メモリ データの収集により、AKS の正常性とパフォーマンスに関するリアルタイムの分析情報が得られます。これにより、Azure Monitor Container Insights、Prometheus、Grafana などを使用してデータを視覚化できます。\n",
    "pgVerified": true,
    "description": "AKS で監視を有効にする",
    "potentialBenefits": "Real-time AKS health/performance insights",
    "tags": null,
    "recommendationResourceType": "Microsoft.ContainerService/managedClusters",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Returns AKS clusters where either Azure Monitor is not enabled and/or Container Insights is not enabled\nresources\n|  where type == \"microsoft.containerservice/managedclusters\"\n|  extend azureMonitor = tostring(parse_json(properties.azureMonitorProfile.metrics.enabled))\n|  extend insights = tostring(parse_json(properties.addonProfiles.omsagent.enabled))\n|  where isempty(azureMonitor) or isempty(insights)\n|  project recommendationId=\"dcaf8128-94bd-4d53-9235-3a0371df6b74\",id, name, tags, param1=strcat(\"azureMonitorProfileEnabled: \", iff(isempty(azureMonitor), \"false\", azureMonitor)), param2=strcat(\"containerInsightsEnabled: \", iff(isempty(insights), \"false\", insights))\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "a7bfcc18-b0d8-4d37-81f3-8131ed8bead5",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/aks/concepts-storage#ephemeral-os-disk",
        "name": "エフェメラル OS ディスク"
      },
      {
        "url": "https://learn.microsoft.com/azure/aks/cluster-configuration",
        "name": "AKS クラスターを構成する"
      },
      {
        "url": "https://learn.microsoft.com/samples/azure-samples/aks-ephemeral-os-disk/aks-ephemeral-os-disk/",
        "name": "Everything you want to know about ephemeral OS disks and AKS"
      }
    ],
    "recommendationControl": "Scalability",
    "longDescription": "AKS 上のエフェメラル OS ディスクでは、ローカル接続による読み取り/書き込みの待機時間が短くなり、マネージド ディスクで見られるレプリケーションが不要になります。これにより、パフォーマンスが向上し、再イメージ化と起動時間が短縮されるため、スケーリングやアップグレードなどのクラスター操作が高速化されます。\n",
    "pgVerified": true,
    "description": "AKS クラスターでエフェメラル OS ディスクを使用する",
    "potentialBenefits": "Lower latency, faster re-imaging and booting",
    "tags": null,
    "recommendationResourceType": "Microsoft.ContainerService/managedClusters",
    "recommendationImpact": "Medium",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Returns any AKS cluster nodepools that do not have Ephemeral Disks\nresources\n| where type == \"microsoft.containerservice/managedclusters\"\n| mv-expand agentPoolProfile = properties.agentPoolProfiles\n| extend type = tostring(agentPoolProfile.osDiskType)\n| where type != 'Ephemeral'\n| project recommendationId=\"a7bfcc18-b0d8-4d37-81f3-8131ed8bead5\", name, id, param1=strcat(\"osDiskType: \", type)\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "26ebaf1f-c70d-4ebd-8641-4b60a0ce0094",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/architecture/reference-architectures/containers/aks/baseline-aks?toc=https%3A%2F%2Flearn.microsoft.com%2Fen-us%2Fazure%2Faks%2Ftoc.json&bc=https%3A%2F%2Flearn.microsoft.com%2Fen-us%2Fazure%2Fbread%2Ftoc.json#policy-management",
        "name": "AKS ベースライン - ポリシー管理"
      },
      {
        "url": "https://learn.microsoft.com/azure/aks/policy-reference",
        "name": "AKS 用の Azure Policy 組み込み定義"
      }
    ],
    "recommendationControl": "Governance",
    "longDescription": "AKS クラスターの Azure ポリシーは、セキュリティ、認証、プロビジョニング、ネットワークなどに関するガバナンスのベスト プラクティスを適用し、運用のための堅牢で安全な環境を確保するのに役立ちます。\n",
    "pgVerified": false,
    "description": "AKS 用に構成された Azure ポリシーを有効にして修復する",
    "potentialBenefits": "Enhanced AKS governance and security",
    "tags": null,
    "recommendationResourceType": "Microsoft.ContainerService/managedClusters",
    "recommendationImpact": "Low",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Returns a count of non-compliant policy items per AKS cluster\nPolicyResources\n| where type =~ 'Microsoft.PolicyInsights/PolicyStates'\n| extend complianceState = tostring(properties.complianceState)\n| where complianceState == 'NonCompliant'\n| where properties.resourceType =~ 'Microsoft.ContainerService/managedClusters'\n| extend\n    id = tostring(properties.resourceId)\n| summarize count() by id\n| join kind=inner (\n    resources\n    | where type =~ 'Microsoft.ContainerService/managedClusters'\n    | project id, name\n) on id\n| project recommendationId=\"26ebaf1f-c70d-4ebd-8641-4b60a0ce0094\", id, name, param1=strcat(\"numNonCompliantAlerts: \", count_)\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "5f3cbd68-692a-4121-988c-9770914859a9",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/architecture/guide/aks/aks-cicd-github-actions-and-gitops",
        "name": "AKS での GitOps"
      },
      {
        "url": "https://learn.microsoft.com/azure/architecture/example-scenario/gitops-aks/gitops-blueprint-aks",
        "name": "AKS 向けの GitOps - リファレンス アーキテクチャ"
      }
    ],
    "recommendationControl": "Other Best Practices",
    "longDescription": "クラウド ネイティブ アプリの運用モデルである GitOps は、継続的デリバリーの信頼できる情報源として、アプリケーションとインフラストラクチャ コードを格納するために Git を使用します。\n",
    "pgVerified": false,
    "description": "DevOps フレームワークの使用時に GitOps を有効にする",
    "potentialBenefits": "Ensures AKS config consistency",
    "tags": null,
    "recommendationResourceType": "Microsoft.ContainerService/managedClusters",
    "recommendationImpact": "Low",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Returns AKS clusters where GitOps is not enabled\nresources\n|  where type == \"microsoft.containerservice/managedclusters\"\n|  extend gitops = tostring (parse_json(properties.addOnProfiles.gitops.enabled))\n|  where isempty(gitops)\n|  project recommendationId=\"5f3cbd68-692a-4121-988c-9770914859a9\", id, name, tags, param1=strcat(\"gitopsEnabled: \", \"false\")\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "928fcc6f-5e9a-42d9-9bd4-260af42de2e5",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://kubernetes.io/docs/concepts/scheduling-eviction/topology-spread-constraints/",
        "name": "Topology Spread Constraints"
      },
      {
        "url": "https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/",
        "name": "Assign Pod Node"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "ポッド トポロジの分散制約を使用してノードやゾーン トポロジに基づいてポッドの分散を制御し、ポッドがクラスター全体に分散されるようにすることで、可用性と信頼性を向上させます。\n",
    "pgVerified": true,
    "description": "ポッド トポロジの分散制約を使用して、ポッドが異なるノードやゾーンに分散されるようにする",
    "potentialBenefits": "Ensures high availability and efficient use",
    "tags": null,
    "recommendationResourceType": "Microsoft.ContainerService/managedClusters",
    "recommendationImpact": "High",
    "automationAvailable": false,
    "query": "// cannot-be-validated-with-arg\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "cd6791b1-c60e-4b37-ac98-9897b1e6f4b8",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-startup-probes/",
        "name": "Configure probes"
      },
      {
        "url": "https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/",
        "name": "Assign Pod Node"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "AKS kubelet コントローラーでは、liveness プローブを使用してコンテナーとアプリケーションの正常性を検証し、正常性状態に基づいてコンテナーを再起動するタイミングをシステムが認識できるようにします。\n",
    "pgVerified": true,
    "description": "Pod の Liveness、Readiness、および Startup プローブを設定する",
    "potentialBenefits": "Enhances container health monitoring",
    "tags": null,
    "recommendationResourceType": "Microsoft.ContainerService/managedClusters",
    "recommendationImpact": "High",
    "automationAvailable": false,
    "query": "// cannot-be-validated-with-arg\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "bcfe71f1-ebed-49e5-a84a-193b81ad5d27",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://kubernetes.io/docs/concepts/workloads/controllers/replicaset/",
        "name": "Replica Sets"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "Pod や Deployment マニフェストで複数のレプリカを設定すると、レプリカ Pod の数が安定し、指定された数の同一の Pod が常に利用可能になり、可用性が保証されます。\n",
    "pgVerified": true,
    "description": "本番アプリケーションで複数のレプリカを含むデプロイを使用して可用性を保証する",
    "potentialBenefits": "Ensures stable pod availability",
    "tags": null,
    "recommendationResourceType": "Microsoft.ContainerService/managedClusters",
    "recommendationImpact": "High",
    "automationAvailable": false,
    "query": "// cannot-be-validated-with-arg\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "7f7ae535-a5ba-4665-b7e0-c451dbdda01f",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/aks/use-system-pools",
        "name": "システム ノード プール"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "システム ノード プールは、重要なシステム ポッドがノードの停止に対して回復力を持つように、最小ノード数を 2 に設定する必要があります。\n",
    "pgVerified": true,
    "description": "システム ノード プール数を構成する",
    "potentialBenefits": "Ensures pod resilience",
    "tags": null,
    "recommendationResourceType": "Microsoft.ContainerService/managedClusters",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Returns each AKS cluster with nodepools that have system nodepools with less than 2 nodes\nresources\n| where type == \"microsoft.containerservice/managedclusters\"\n| mv-expand agentPoolProfile = properties.agentPoolProfiles\n| extend taints = tostring(parse_json(agentPoolProfile.nodeTaints))\n| extend nodePool = tostring(parse_json(agentPoolProfile.name))\n| where taints has \"CriticalAddonsOnly=true:NoSchedule\" and  agentPoolProfile.minCount < 2\n| project recommendationId=\"7f7ae535-a5ba-4665-b7e0-c451dbdda01f\", id, name, param1=strcat(\"nodePoolName: \", nodePool), param2=strcat(\"nodePoolMinNodeCount: \", agentPoolProfile.minCount)\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "005ccbbd-aeab-46ef-80bd-9bd4479412ec",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/well-architected/service-guides/azure-kubernetes-service#design-checklist",
        "name": "Azure Well-Architected Framework レビュー - Azure Kubernetes Service (AKS)"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "少なくとも 2 つのノードでユーザー ノード プールを構成することは、高可用性を必要とするアプリケーションにとって不可欠であり、中断することなく運用とアクセスを維持できます。\n",
    "pgVerified": true,
    "description": "ユーザー ノードプール数を構成する",
    "potentialBenefits": "Ensures high app availability",
    "tags": null,
    "recommendationResourceType": "Microsoft.ContainerService/managedClusters",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Returns each AKS cluster with nodepools that have user nodepools with less than 2 nodes\nresources\n| where type == \"microsoft.containerservice/managedclusters\"\n| mv-expand agentPoolProfile = properties.agentPoolProfiles\n| extend taints = tostring(parse_json(agentPoolProfile.nodeTaints))\n| extend nodePool = tostring(parse_json(agentPoolProfile.name))\n| where taints !has \"CriticalAddonsOnly=true:NoSchedule\" and  agentPoolProfile.minCount < 2\n| project recommendationId=\"005ccbbd-aeab-46ef-80bd-9bd4479412ec\", id, name, param1=strcat(\"nodePoolName: \", nodePool), param2=strcat(\"nodePoolMinNodeCount: \", agentPoolProfile.minCount)\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "a08a06a0-e41a-4b99-83bb-69ce8bca54cb",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://kubernetes.io/docs/tasks/run-application/configure-pdb/",
        "name": "Configure PDBs"
      },
      {
        "url": "https://learn.microsoft.com/azure/aks/operator-best-practices-scheduler#plan-for-availability-using-pod-disruption-budgets",
        "name": "ポッド中断バジェットを使用して可用性を計画する"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "ポッド中断バジェット (PDB) は、メンテナンスやスケーリングなどの中断時に利用可能なポッドの最小数または割合を設定する Kubernetes リソースであり、最小数のポッドがクラスターで常に利用可能であることを保証します。\n",
    "pgVerified": true,
    "description": "ポッド中断バジェット (PDB) を構成する",
    "potentialBenefits": "Ensures cluster resiliency during disruptions",
    "tags": null,
    "recommendationResourceType": "Microsoft.ContainerService/managedClusters",
    "recommendationImpact": "Medium",
    "automationAvailable": false,
    "query": "// cannot-be-validated-with-arg\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "e620fa98-7a40-41a0-bfc9-b4407297fb58",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/aks/configure-azure-cni-dynamic-ip-allocation",
        "name": "Azure CNI での動的 IP 割り当て"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "最大自動スケール設定用にサイズ設定されたノード プール サブネットを使用すると、AKS はノードを効率的にスケールアウトし、リソースの制約と潜在的なサービスの中断を減らしながら、需要の増加に対応できます。\n",
    "pgVerified": false,
    "description": "ノード プール サブネットのサイズは、最大自動スケール設定に対応する必要がある",
    "potentialBenefits": "Efficient scaling, reduced disruptions",
    "tags": null,
    "recommendationResourceType": "Microsoft.ContainerService/managedClusters",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Returns each AKS cluster with nodepools that have user nodepools with a subnetmask that does not match autoscale configured max-nodes\n// Subtracting the network address, broadcast address, and default 3 addresses Azure reserves within each subnet\n\nresources\n| where type == \"microsoft.containerservice/managedclusters\"\n| extend nodePools = properties['agentPoolProfiles']\n| mv-expand nodePools = properties.agentPoolProfiles\n| where nodePools.enableAutoScaling == true\n| extend nodePoolName=nodePools.name, maxNodes = nodePools.maxCount, subnetId = tostring(nodePools.vnetSubnetID)\n| project clusterId = id, clusterName=name, nodePoolName=nodePools.name, toint(maxNodes), subnetId\n| join kind = leftouter (\n    resources\n    | where type == 'microsoft.network/virtualnetworks'\n    | extend subnets = properties.subnets\n    | mv-expand subnets\n    | project id = tostring(subnets.id), addressPrefix = tostring(subnets.properties['addressPrefix'])\n    | extend subnetmask = toint(substring(addressPrefix, indexof(addressPrefix, '/')+1, string_size(addressPrefix)))\n    | extend possibleMaxNodeCount = toint(exp2(32-subnetmask) - 5)\n) on $left.subnetId == $right.id\n| project-away id, subnetmask\n| where possibleMaxNodeCount <= maxNodes\n| extend param1 = strcat(nodePoolName, \" autoscaler upper limit: \", maxNodes)\n| extend param2 = strcat(\"ip addresses on subnet: \", possibleMaxNodeCount)\n| project recommendationId=\"e620fa98-7a40-41a0-bfc9-b4407297fb58\", name=clusterName, id=clusterId, param1, param2\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "a01afc4c-7439-4919-b2da-3565992ea2a7",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/quotas/quotas-overview",
        "name": "Azure クォータ"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "ノード プールの設定は、AKS がノードを効率的にスケールアウトし、リソースの制約と潜在的なサービスの中断を減らしながら需要の増加に対応できるようにするために、サブスクリプションのコア数クォータを超えないようにする必要があります。\n",
    "pgVerified": false,
    "description": "ノード プールの自動スケール設定は、サブスクリプションのコア数クォータを超えないようにする必要がある",
    "potentialBenefits": "Reduced disruptions",
    "tags": null,
    "recommendationResourceType": "Microsoft.ContainerService/managedClusters",
    "recommendationImpact": "High",
    "automationAvailable": false,
    "query": "// cannot-be-validated-with-arg\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "f46b0d1d-56ef-4795-b98a-f6ee00cb341a",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/aks/use-azure-linux",
        "name": "Azure Linux"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "Azure Linux on AKS では、検証済みのソース ビルド コンポーネントを使用して、ネイティブ イメージで回復性が向上します。軽量で、攻撃対象領域とメンテナンスを削減します。Azure 用に最適化された Microsoft で強化されたカーネルにより、コンテナー ワークロードの安定性とセキュリティが強化されます。\n",
    "pgVerified": false,
    "description": "Linux ノード プールに Azure Linux を使用する",
    "potentialBenefits": "Reduced disruptions",
    "tags": null,
    "recommendationResourceType": "Microsoft.ContainerService/managedClusters",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Returns each AKS cluster with nodepools that have Linux nodepools not using Azure Linux\nresources\n| where type == \"microsoft.containerservice/managedclusters\"\n| mv-expand agentPoolProfile = properties.agentPoolProfiles\n| where agentPoolProfile.osType == 'Linux' and agentPoolProfile.osSKU != 'AzureLinux'\n| project recommendationid=\"f46b0d1d-56ef-4795-b98a-f6ee00cb341a\", name, id, param1=strcat(\"nodePoolName: \", agentPoolProfile.name)\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "9200aca6-0e83-4749-a5eb-e3939367bdc2",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/aks/best-practices-app-cluster-reliability#multi-replica-applications",
        "name": "マルチレプリカ アプリケーション"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "アプリケーションのレプリカを少なくとも 2 つデプロイすると、アプリケーションの可用性が高くなり、ノードの障害を許容できるようになります。\n",
    "pgVerified": false,
    "description": "アプリケーションのレプリカを少なくとも 2 つデプロイする",
    "potentialBenefits": "Ensures high app availability",
    "tags": null,
    "recommendationResourceType": "Microsoft.ContainerService/managedClusters",
    "recommendationImpact": "High",
    "automationAvailable": false,
    "query": "// cannot-be-validated-with-arg\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "19b6df57-f6b5-3e4f-843a-273daa087cb0",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/ja-jp/azure/virtual-machines/generation-2#features-and-capabilities",
        "name": "Generation 1 vs generation 2 virtual machines"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "第 2 世代は、第 1 世代の BIOS ベースのアーキテクチャとは異なり、より多くのメモリを提供し、2 TB より大きいディスクをサポートし、UEFI を使用して起動/インストールを高速化し、Intel SGX と仮想化永続メモリ (vPMEM) を備えています。\n",
    "pgVerified": true,
    "description": "第 2 世代仮想マシンのソース イメージを使用する",
    "potentialBenefits": "More memory, supports >2TB disks, faster boot",
    "tags": null,
    "recommendationResourceType": "Microsoft.VirtualMachineImages/imageTemplates",
    "recommendationImpact": "Low",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "21fb841b-ba70-1f4e-a460-1f72fb41aa51",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/ja-jp/azure/reliability/reliability-image-builder?toc=%2Fazure%2Fvirtual-machines%2Ftoc.json&bc=%2Fazure%2Fvirtual-machines%2Fbreadcrumb%2Ftoc.json#capacity-and-proactive-disaster-recovery-resiliency",
        "name": "Image Template resiliency"
      },
      {
        "url": "https://learn.microsoft.com/ja-jp/azure/virtual-machines/image-builder-overview?tabs=azure-powershell#regions",
        "name": "Azure Image Builder Supported Regions"
      }
    ],
    "recommendationControl": "Disaster Recovery",
    "longDescription": "イメージ テンプレートのデプロイに使用される Azure Image Builder サービスには、可用性ゾーンのサポートがありません。イメージ テンプレートをセカンダリ (できればペア) のリージョンにレプリケートすることで、リージョン障害からの迅速なリカバリが可能になり、これらのテンプレートからの仮想マシンの継続的なデプロイが保証されます。\n",
    "pgVerified": true,
    "description": "イメージ テンプレートをセカンダリ リージョンにレプリケートする",
    "potentialBenefits": "Enhances disaster recovery capability",
    "tags": null,
    "recommendationResourceType": "Microsoft.VirtualMachineImages/imageTemplates",
    "recommendationImpact": "Low",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// List all Image Templates that are not replicated to another region\nresources\n| where type =~ \"microsoft.virtualmachineimages/imagetemplates\"\n| mv-expand distribution=properties.distribute\n| where array_length(parse_json(distribution).replicationRegions) == 1\n| project recommendationId = \"21fb841b-ba70-1f4e-a460-1f72fb41aa51\", name, id, param1=strcat(\"replicationRegions:\",parse_json(distribution).replicationRegions)\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "67205887-0733-466e-b50e-b1cd7316c514",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/automation/automation-disaster-recovery?tabs=win-hrw%2Cps-script%2Coption-one",
        "name": "Azure Automation のディザスター リカバリー"
      },
      {
        "url": "https://learn.microsoft.com/azure/automation/automation-disaster-recovery?tabs=win-hrw%2Cps-script%2Coption-one#scenarios-for-cloud-and-hybrid-jobs",
        "name": "クラウドやハイブリッド ジョブのディザスター リカバリー シナリオ"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "Automation アカウントとリソース (モジュール、接続、資格情報、証明書、変数、スケジュールなど) のディザスター リカバリーを設定して、リージョンまたはゾーンの障害に対処します。レプリカ Automation アカウントは、セカンダリ リージョンでフェールオーバーの準備ができている必要があります。\n",
    "pgVerified": false,
    "description": "Automation アカウントとその依存リソースのディザスター リカバリーを設定する",
    "potentialBenefits": "Ensures continuity during outages",
    "tags": null,
    "recommendationResourceType": "Microsoft.Automation/automationAccounts",
    "recommendationImpact": "High",
    "automationAvailable": false,
    "query": "// cannot-be-validated-with-arg\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "e6c7e1cc-2f47-264d-aa50-1da421314472",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/storage/common/storage-redundancy",
        "name": "Azure Storage redundancy"
      },
      {
        "url": "https://learn.microsoft.com/azure/storage/common/redundancy-migration",
        "name": "Change the redundancy configuration for a storage account"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "冗長性により、ストレージ アカウントは障害発生時に可用性と持続性の目標を確実に満たし、低コストと高可用性を比較検討できます。ローカル冗長ストレージは、最小のコストで最小の耐久性を提供します。\n",
    "pgVerified": true,
    "description": "ストレージ アカウントがゾーンまたはリージョン冗長であることを確認する",
    "potentialBenefits": "High availability and durability for storage",
    "tags": null,
    "recommendationResourceType": "Microsoft.Storage/storageAccounts",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// This query will return all storage accounts that are not using Zone or Region replication\nResources\n| where type =~ \"Microsoft.Storage/storageAccounts\"\n| where sku.name in~ (\"Standard_LRS\", \"Premium_LRS\")\n| project recommendationId = \"e6c7e1cc-2f47-264d-aa50-1da421314472\", name, id, tags, param1 = strcat(\"sku: \", sku.name)\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "63ad027e-611c-294b-acc5-8e3234db9a40",
    "recommendationTypeId": "47bb383c-8e25-95f0-c2aa-437add1d87d3",
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://azure.microsoft.com/updates/classic-azure-storage-accounts-will-be-retired-on-31-august-2024/",
        "name": "Azure classic storage accounts retirement announcement"
      },
      {
        "url": "https://learn.microsoft.com/azure/storage/common/classic-account-migration-overview",
        "name": "Migrate your classic storage accounts to Azure Resource Manager"
      }
    ],
    "recommendationControl": "Service Upgrade and Retirement",
    "longDescription": "クラシック ストレージ アカウントは、2024 年 8 月 31 日に完全に廃止されます。クラシック ストレージ アカウントをお持ちの場合は、今すぐ移行の計画を開始してください。\n",
    "pgVerified": true,
    "description": "クラシック ストレージ アカウントを新しい Azure Resource Manager リソースに移行する必要がある",
    "potentialBenefits": "Avoids service retirement issues",
    "tags": null,
    "recommendationResourceType": "Microsoft.Storage/storageAccounts",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Find all Azure classic Storage Account\nresources\n| where type =~ 'microsoft.classicstorage/storageaccounts'\n| project recommendationId = '63ad027e-611c-294b-acc5-8e3234db9a40', name, id, tags, param1=type\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "5587ef77-7a05-a74d-9c6e-449547a12f27",
    "recommendationTypeId": "c6b94711-f1f5-4e7e-9c89-c17ed4190969",
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/storage/common/storage-account-overview#types-of-storage-accounts",
        "name": "Types of storage accounts"
      },
      {
        "url": "https://learn.microsoft.com/azure/storage/common/scalability-targets-standard-account",
        "name": "Scalability and performance targets for standard storage accounts"
      },
      {
        "url": "https://learn.microsoft.com/azure/storage/blobs/storage-performance-checklist",
        "name": "Performance and scalability checklist for Blob storage"
      },
      {
        "url": "https://learn.microsoft.com/azure/storage/blobs/scalability-targets",
        "name": "Scalability and performance targets for Blob storage"
      },
      {
        "url": "https://learn.microsoft.com/azure/storage/blobs/storage-blob-block-blob-premium",
        "name": "Premium block blob storage accounts"
      }
    ],
    "recommendationControl": "Scalability",
    "longDescription": "高速なストレージ応答時間や高いトランザクション レートを必要とするワークロードには、Standard パフォーマンス ストレージではなく Premium パフォーマンス ブロック BLOB ストレージを使用します。\n",
    "pgVerified": true,
    "description": "高パフォーマンスのワークロードに Premium パフォーマンスのブロック BLOB ストレージを使用する",
    "potentialBenefits": "Optimized cost and performance",
    "tags": null,
    "recommendationResourceType": "Microsoft.Storage/storageAccounts",
    "recommendationImpact": "Medium",
    "automationAvailable": false,
    "query": "// cannot-be-validated-with-arg\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "03263c57-c869-3841-9e0a-3dbb9ef3e28d",
    "recommendationTypeId": "42dbf883-9e4b-4f84-9da4-232b87c4b5e9",
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com//azure/storage/blobs/soft-delete-blob-enable?tabs=azure-portal ",
        "name": "Soft delete detail docs"
      }
    ],
    "recommendationControl": "Disaster Recovery",
    "longDescription": "論理的な削除オプションを使用すると、誤って削除された場合にデータを回復でき、ロック機能を使用すると、ストレージ アカウント自体が誤って削除されるのを防ぎ、セキュリティとデータ整合性の対策が強化されます。\n",
    "pgVerified": true,
    "description": "論理的な削除を有効にしてデータを保護する",
    "potentialBenefits": "Prevents accidental data/account loss",
    "tags": null,
    "recommendationResourceType": "Microsoft.Storage/storageAccounts",
    "recommendationImpact": "Medium",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "8ebda7c0-e0e1-ed45-af59-2d7ea9a1c05d",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/storage/blobs/versioning-overview ",
        "name": "Blob versioning"
      }
    ],
    "recommendationControl": "Disaster Recovery",
    "longDescription": "Azure Storage アカウントのバージョン管理を有効にして、誤った変更や削除から回復し、BLOB 操作の待機時間を管理することを検討してください。Microsoft では、パフォーマンスを最適化するために、BLOB ごとに 1000 未満のバージョンを維持することをお勧めします。ライフサイクル管理は、古いバージョンを自動的に削除するのに役立ちます。\n",
    "pgVerified": true,
    "description": "誤って変更した場合のバージョン管理を有効にし、バージョン数を 1000 未満に維持する",
    "potentialBenefits": "Recover data, manage latency",
    "tags": null,
    "recommendationResourceType": "Microsoft.Storage/storageAccounts",
    "recommendationImpact": "Low",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "1b965cb9-7629-214e-b682-6bf6e450a100",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/storage/blobs/point-in-time-restore-overview",
        "name": "Point-in-time restore for block blobs"
      },
      {
        "url": "https://learn.microsoft.com/azure/storage/blobs/point-in-time-restore-manage?tabs=portal",
        "name": "Perform a point-in-time restore on block blob data"
      }
    ],
    "recommendationControl": "Disaster Recovery",
    "longDescription": "ブロック BLOB データを以前の状態に復元することで、偶発的な削除や破損から保護するために、フラット名前空間を持つ標準の汎用 v2 アカウントに対してポイントインタイム リストアを有効にすることを検討してください。\n",
    "pgVerified": true,
    "description": "GPv2 アカウントのポイントインタイム リストアを有効にしてデータを損失から保護する",
    "potentialBenefits": "Protects data from loss/corruption",
    "tags": null,
    "recommendationResourceType": "Microsoft.Storage/storageAccounts",
    "recommendationImpact": "Low",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "96cb8331-6b06-8242-8ce8-4e2f665dc679",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/storage/blobs/monitor-blob-storage",
        "name": "Monitor Azure Blob Storage"
      },
      {
        "url": "https://learn.microsoft.com/azure/storage/blobs/blob-storage-monitoring-scenarios",
        "name": "Best practices for monitoring Azure Blob Storage"
      }
    ],
    "recommendationControl": "Monitoring and Alerting",
    "longDescription": "Azure に依存する重要なアプリケーションやビジネス プロセスでは、監視とアラートが不可欠です。リソース ログは、ログを指定した場所にルーティングする診断設定を作成した後にのみ格納され、収集するログ カテゴリを選択する必要があります。\n",
    "pgVerified": true,
    "description": "すべての BLOB ストレージ アカウントを監視する",
    "potentialBenefits": "Enhanced alerting and log analysis",
    "tags": null,
    "recommendationResourceType": "Microsoft.Storage/storageAccounts",
    "recommendationImpact": "Low",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "2ad78dec-5a4d-4a30-8fd1-8584335ad781",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/storage/common/storage-account-overview#legacy-storage-account-types",
        "name": "Legacy storage account types"
      },
      {
        "url": "https://learn.microsoft.com/azure/storage/common/storage-account-upgrade",
        "name": "Upgrade to a general-purpose v2 storage account"
      }
    ],
    "recommendationControl": "Scalability",
    "longDescription": "汎用 v2 アカウントは、最新の機能を提供するほとんどのストレージ シナリオ、またはギガバイトあたりの最低価格を提供する場合に推奨されます。Standard 汎用 v1 や Blob Storage などのレガシ アカウントは、Microsoft から推奨されていませんが、特定のシナリオに適している場合があります。\n",
    "pgVerified": true,
    "description": "レガシ ストレージ アカウントを v2 ストレージ アカウントにアップグレードすることを検討する",
    "potentialBenefits": "Latest features, lowest cost",
    "tags": null,
    "recommendationResourceType": "Microsoft.Storage/storageAccounts",
    "recommendationImpact": "Low",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Find all Azure Storage Accounts, that upgradeable to General purpose v2.\nResources\n| where type =~ \"Microsoft.Storage/storageAccounts\" and kind in~ (\"Storage\", \"BlobStorage\")\n| extend\n    param1 = strcat(\"AccountKind: \", case(kind =~ \"Storage\", \"Storage (general purpose v1)\", kind =~ \"BlobStorage\", \"BlobStorage\", kind)),\n    param2 = strcat(\"Performance: \", sku.tier),\n    param3 = strcat(\"Replication: \", sku.name)\n| project recommendationId = \"2ad78dec-5a4d-4a30-8fd1-8584335ad781\", name, id, tags, param1, param2, param3\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "dc55be60-6f8c-461e-a9d5-a3c7686ed94e",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/ja-jp/azure/architecture/example-scenario/wvd/windows-virtual-desktop#azure-virtual-desktop-limitations",
        "name": "Learn More"
      },
      {
        "url": "https://learn.microsoft.com/ja-jp/azure/well-architected/azure-virtual-desktop/networking#private-endpoints-private-link",
        "name": "Private Link"
      }
    ],
    "recommendationControl": "Security",
    "longDescription": "Azure Private Link サービスを利用して、VNet 内のプライベート エンドポイント経由で Azure Storage とサービスに安全にアクセスできます。パブリック IP の必要性を排除し、データのプライバシーを確保します。きめ細かなアクセス制御により、セキュリティを強化できます。\n",
    "pgVerified": true,
    "description": "ストレージ アカウントに対して Azure Private Link サービスを有効にする",
    "potentialBenefits": "Secure, private access to storage with no public IPs",
    "tags": null,
    "recommendationResourceType": "Microsoft.Storage/storageAccounts",
    "recommendationImpact": "Medium",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// This resource graph query will return all storage accounts that does not have a Private Endpoint Connection or where a private endpoint exists but public access is enabled\nresources\n| where type =~ \"Microsoft.Storage/StorageAccounts\"\n| where isnull(properties.privateEndpointConnections) or properties.privateEndpointConnections[0].properties.provisioningState != (\"Succeeded\") or (isnull(properties.networkAcls) and properties.publicNetworkAccess == 'Enabled')\n| extend param1 = strcat('Private Endpoint: ', iif(isnotnull(properties.privateEndpointConnections),split(properties.privateEndpointConnections[0].properties.privateEndpoint.id,'/')[8],'No Private Endpoint'))\n| extend param2 = strcat('Access: ', iif(properties.publicNetworkAccess == 'Disabled', 'Public Access Disabled', iif(isnotnull(properties.networkAcls), 'NetworkACLs in place','Public Access Enabled')))\n| project recommendationId = \"dc55be60-6f8c-461e-a9d5-a3c7686ed94e\", name, id, tags, param1, param2\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "493f6079-3bb6-4a56-96ba-ab3248474cb1",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/app-service/troubleshoot-diagnostic-logs",
        "name": "Enable diagnostics logging for apps in Azure App Service"
      }
    ],
    "recommendationControl": "Monitoring and Alerting",
    "longDescription": "Azure App Service の診断ログを有効にすることは、アプリケーション ログと Web サーバー ログの両方を含む監視と診断にとって重要です。\n",
    "pgVerified": false,
    "description": "診断ログを有効にする",
    "potentialBenefits": "Monitoring and Alerting",
    "tags": null,
    "recommendationResourceType": "Microsoft.Web/sites",
    "recommendationImpact": "Low",
    "automationAvailable": false,
    "query": "// cannot-be-validated-with-arg\n\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "a7e8bb3d-8ceb-442d-b26f-007cd63f9ffc",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/application-insights/app-insights-overview",
        "name": "Application Insights"
      },
      {
        "url": "https://learn.microsoft.com/azure/azure-monitor/app/azure-web-apps",
        "name": "Application monitoring for Azure App Service"
      }
    ],
    "recommendationControl": "Monitoring and Alerting",
    "longDescription": "Application Insights を使用して、アプリのパフォーマンスと負荷の動作を監視し、リアルタイムの分析情報、問題の診断、根本原因の分析を提供します。Azure App Service で ASP.NET、ASP.NET Core、Java、Node.js をサポートし、監視機能が組み込まれました。\n",
    "pgVerified": false,
    "description": "パフォーマンスを監視する",
    "potentialBenefits": "Real-time insights and issue diagnosis",
    "tags": null,
    "recommendationResourceType": "Microsoft.Web/sites",
    "recommendationImpact": "Medium",
    "automationAvailable": false,
    "query": "// cannot-be-validated-with-arg\n\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "78a5c033-ff51-4332-8a71-83464c34494b",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/architecture/checklist/resiliency-per-service#app-service",
        "name": "Resiliency checklist for specific Azure services"
      }
    ],
    "recommendationControl": "Scalability",
    "longDescription": "ソリューションに Web フロントエンドと Web API の両方が含まれている場合は、それらを個別の App Service アプリに分解すると、ワークロードによるソリューションの分解が容易になり、独立したスケーリングが可能になります。最初は、両方を同じプランにデプロイし、必要に応じて個別にスケーリングするために分離できます。\n",
    "pgVerified": false,
    "description": "Web アプリを Web API から分離する",
    "potentialBenefits": "Independent scaling, easier management",
    "tags": null,
    "recommendationResourceType": "Microsoft.Web/sites",
    "recommendationImpact": "Low",
    "automationAvailable": false,
    "query": "// cannot-be-validated-with-arg\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "3f9ddb59-0bb3-4acb-9c9b-99aa1776f0ab",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/architecture/checklist/resiliency-per-service#app-service",
        "name": "Resiliency checklist"
      }
    ],
    "recommendationControl": "Scalability",
    "longDescription": "ログ用に別のストレージ アカウントを作成し、アプリケーション データに同じストレージ アカウントを使用しないと、アプリケーション データの処理専用のリソースがログ プロセスによって負荷をかけられないようにすることで、ログ アクティビティによってアプリケーションのパフォーマンスが低下するのを防ぐことができます。\n",
    "pgVerified": false,
    "description": "ログ用に別のストレージ アカウントを作成する",
    "potentialBenefits": "Improves app performance",
    "tags": null,
    "recommendationResourceType": "Microsoft.Web/sites",
    "recommendationImpact": "Medium",
    "automationAvailable": false,
    "query": "// cannot-be-validated-with-arg\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "a1d91661-32d4-430b-b3b6-5adeb0975df7",
    "recommendationTypeId": "1d3b5a51-62d4-4b77-96f6-40ed0a3aa21f",
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/app-service-web/web-sites-staged-publishing",
        "name": "Set up staging environments in Azure App Service"
      }
    ],
    "recommendationControl": "Governance",
    "longDescription": "ステージング用のデプロイ スロットを作成して、更新をデプロイし、検証し、本番スワップの前にすべてのインスタンスがウォームアップされるようにして、不適切な更新の可能性を減らします。LKG スロットを使用すると、後で問題が発生した場合に、以前の正常な展開に簡単にロールバックできるため、信頼性が向上します。\n",
    "pgVerified": false,
    "description": "ステージング スロットにデプロイする",
    "potentialBenefits": "Safer updates and easy rollback",
    "tags": null,
    "recommendationResourceType": "Microsoft.Web/sites",
    "recommendationImpact": "Low",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Display App Service with the count of deployment slots for Apps under eligible App service plans and it shows if deployment slot is enabled or not\n\nresources\n| where type =~ 'microsoft.web/sites' or type =~ 'microsoft.web/sites/slots'\n| extend isSlot = iff(type =~ 'microsoft.web/sites/slots', 1, 0)\n| extend AspName = iff(isSlot == 1, split(name, '/')[0], name)\n| extend Sku = tostring(properties.sku)\n| where tolower(Sku) contains \"standard\" or tolower(Sku) contains \"premium\" or tolower(Sku) contains \"isolatedv2\"\n| project id, name, AspName, isSlot, Sku\n| summarize Slots = countif(isSlot == 1) by id, name, AspName, Sku\n| extend DeploymentSlotEnabled = iff(Slots > 1, true, false)\n| where DeploymentSlotEnabled = false\n| project recommendationId=\"a1d91661-32d4-430b-b3b6-5adeb0975df7\", name, id, tags=\"\", param1=Sku, param2=Slots, param3=\"DeploymentSlotEnabled=false\"\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "0b80b67c-afbe-4988-ad58-a85a146b681e",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/app-service-web/web-sites-configure",
        "name": "Configure web apps in Azure App Service"
      }
    ],
    "recommendationControl": "Other Best Practices",
    "longDescription": "構成にアプリ設定を使用し、Resource Manager テンプレートや PowerShell を使用して定義することで、自動デプロイ/更新プロセスの一部を容易にし、信頼性を向上させることができます。\n",
    "pgVerified": false,
    "description": "アプリを設定として保存する",
    "potentialBenefits": "Enhanced reliability via automation",
    "tags": null,
    "recommendationResourceType": "Microsoft.Web/sites",
    "recommendationImpact": "Medium",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Provides a list of Azure App Service resources that don't have App Settings configured\n\nappserviceresources\n| where type == \"microsoft.web/sites/config\"\n| extend AppSettings = iif(isempty(properties.AppSettings), true, false)\n| where AppSettings == false\n| project  recommendationId=\"0b80b67c-afbe-4988-ad58-a85a146b681e\", id, name, tags=\"\", param1=\"AppSettings is not configured\"\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "fd049c28-ae6d-48f0-a641-cc3ba1a3fe1d",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/ja-jp/azure/app-service/monitor-instances-health-check?tabs=dotnet#enable-health-check",
        "name": "Monitor the health of App Service instances"
      }
    ],
    "recommendationControl": "Other Best Practices",
    "longDescription": "稼働ワークロードには正常性チェックを使用します。正常性チェックは、異常なインスタンスからリクエストを再ルーティングし、異常なままのインスタンスを置き換えることで、アプリケーションの可用性を向上させます。正常性チェック パスでは、アプリケーションの重要なコンポーネントをチェックする必要があります。\n",
    "pgVerified": false,
    "description": "App Services の正常性チェックを有効にする",
    "potentialBenefits": "Enhanced reliability via automation",
    "tags": null,
    "recommendationResourceType": "Microsoft.Web/sites",
    "recommendationImpact": "Medium",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Check if Health Check is enabled for App Service\n\nresources\n| where type =~ 'microsoft.web/sites'\n| where properties.kind has 'app'\n| join kind = inner\n    (\n    appserviceresources\n    | where isnull(properties.HealthCheckPath) == true\n    | project  name\n    ) on name\n| project recommendationId = \"fd049c28-ae6d-48f0-a641-cc3ba1a3fe1d\", name, id, tags, param1 = \"Healthcheckpath = not set\"\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "aab6b4a4-9981-43a4-8728-35c7ecbb746d",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/ja-jp/azure/app-service/app-service-ip-restrictions?tabs=azurecli",
        "name": "Set up Azure App Service access restrictions"
      }
    ],
    "recommendationControl": "Governance",
    "longDescription": "ネットワーク アクセス制限を使用して、アプリへのネットワーク アクセスを制御する優先順位の高い許可/拒否リストを定義します。Application Gateway で使用できるような Web アプリケーション ファイアウォールは、一般向けの Web アプリケーションの保護に推奨されます。\n",
    "pgVerified": false,
    "description": "ネットワーク アクセス制限を構成する",
    "potentialBenefits": "Enhanced security",
    "tags": null,
    "recommendationResourceType": "Microsoft.Web/sites",
    "recommendationImpact": "Medium",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Check if Network access restrictions defined for App service\n\nresources\n| where type =~ 'microsoft.web/sites'\n| where properties.kind has 'app'\n| join kind = inner\n    (\n    appserviceresources\n    | mv-expand IpSecurityRestrictions = properties.IpSecurityRestrictions\n    | where isnotnull(IpSecurityRestrictions) == true\n    | project name\n    ) on name\n| project recommendationId = \"aab6b4a4-9981-43a4-8728-35c7ecbb746d\", name, id, tags, param1 = \"No network restrictions set\"\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "9e6682ac-31bc-4635-9959-ab74b52454e6",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://azure.github.io/AppService/2020/05/15/Robust-Apps-for-the-cloud.html",
        "name": "Ultimate guide to running healthy apps in the cloud"
      }
    ],
    "recommendationControl": "Scalability",
    "longDescription": "App Service は、運用ワークロード用に少なくとも 2 つのインスタンスで構成する必要があります。アプリのウォームアップ時間が長い場合は、少なくとも 3 つのインスタンスを使用する必要があります。\n",
    "pgVerified": false,
    "description": "App Service の最小インスタンス数を 2 に設定する",
    "potentialBenefits": "Improves app performace",
    "tags": null,
    "recommendationResourceType": "Microsoft.Web/sites",
    "recommendationImpact": "Medium",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Provides a list of App services that do not have minimum instance count of 2\n\nresources\n| where type =~ 'microsoft.web/sites'\n| where properties.kind has 'app'\n| join kind = inner\n    (\n    appserviceresources\n    | where properties.PreWarmedInstanceCount < 2\n    | project name\n    ) on name\n| project recommendationId = \"9e6682ac-31bc-4635-9959-ab74b52454e6\", name, id, tags, param1 = \"PreWarmedInstanceCount is less than 2\"\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "c6c4b962-5af4-447a-9d74-7b9c53a5dff5",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://azure.github.io/AppService/2018/09/10/Announcing-the-New-Auto-Healing-Experience-in-App-Service-Diagnostics.html",
        "name": "Announcing the New Auto Healing Experience in App Service Diagnostics - Azure App Service"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "Auto Heal を使用すると、HTTP サーバー エラーやリソースの枯渇などの予期しない状況が発生した場合に、アプリを軽減できます。必要に応じてさまざまなトリガーを構成し、アプリをリサイクルして不適切な状態から回復することを選択できます。\n",
    "pgVerified": false,
    "description": "Function App の自動修復を有効にする",
    "potentialBenefits": "Improved app availability",
    "tags": null,
    "recommendationResourceType": "Microsoft.Web/sites",
    "recommendationImpact": "Low",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Provides a list of Azure Function App resources that do not have auto heal enabled\n\nResources\n| where type =~ 'microsoft.web/sites'\n| where properties.kind contains 'functionapp'\n| join kind=inner\n    (appserviceresources\n    | where type == \"microsoft.web/sites/config\"\n    | where properties.AutoHealEnabled == 'false'\n    | project id, name, tenantId, location, resourceGroup, properties.AutoHealEnabled\n    ) on name\n| project recommendationID = \"c6c4b962-5af4-447a-9d74-7b9c53a5dff5\", name, id, type, kind, param1=\"AutoHealEnabled =false\"\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "52f368ee-1d77-4b34-92db-64be269642d0",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/ja-jp/azure/azure-functions/functions-bindings-warmup?tabs=in-process%2Cnodejs-v4&pivots=programming-language-csharp#trigger",
        "name": "Azure Functions Warmup Trigger"
      }
    ],
    "recommendationControl": "Monitoring and Alerting",
    "longDescription": "ウォームアップ トリガーを追加して、事前ウォーミングプロセス中にカスタム依存関係をプリロードして、関数がリクエストの処理をすぐに開始できるようにします。\n",
    "pgVerified": false,
    "description": "ウォームアップ トリガーを Function App に追加する",
    "potentialBenefits": "Improved app availability",
    "tags": null,
    "recommendationResourceType": "Microsoft.Web/sites",
    "recommendationImpact": "Medium",
    "automationAvailable": false,
    "query": "// cannot-be-validated-with-arg\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "0b06a688-0dd6-4d73-9f72-6666ff853ca9",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/ja-jp/azure/azure-resource-manager/management/resource-name-rules",
        "name": "Resource naming restrictions - Azure Resource Manager"
      }
    ],
    "recommendationControl": "Governance",
    "longDescription": "ホスト ID は 1 から 32 文字で、小文字、数字、およびダッシュのみを含み、ダッシュで開始または終了することはできず、連続するダッシュを含めることはできません。ホスト ID の値は、実行しているすべてのアプリ/スロットで一意である必要があります。\n",
    "pgVerified": false,
    "description": "Function App に一意のホスト ID が設定されていることを確認する",
    "potentialBenefits": "Easier management",
    "tags": null,
    "recommendationResourceType": "Microsoft.Web/sites",
    "recommendationImpact": "Low",
    "automationAvailable": false,
    "query": "// cannot-be-validated-with-arg\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "c9a278b7-024b-454b-bd54-41587c512b74",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/ja-jp/azure/azure-functions/migrate-version-3-version-4?tabs=net6-in-proc%2Cazure-cli%2Cwindows&pivots=programming-language-csharp",
        "name": "Migrate version 3.x to 4.x"
      }
    ],
    "recommendationControl": "Governance",
    "longDescription": "2022 年 12 月 13 日以降、Azure Functions ランタイムのバージョン 2.x および 3.x で実行されている関数アプリは、延長サポートのサポート終了 (EOL) に達しました。関数アプリを Functions ランタイムのバージョン 4.x に移行することを強くお勧めします。\n",
    "pgVerified": false,
    "description": "Function App でサポートされているバージョンが実行されていることを確認する",
    "potentialBenefits": "Better governance",
    "tags": null,
    "recommendationResourceType": "Microsoft.Web/sites",
    "recommendationImpact": "Medium",
    "automationAvailable": false,
    "query": "// cannot-be-validated-with-arg\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "7c608f46-46b2-4cc0-bbd6-1d457c16671c",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/ja-jp/azure/azure-functions/functions-app-settings#functions_worker_runtime",
        "name": "FUNCTIONS_WORKER_RUNTIME"
      }
    ],
    "recommendationControl": "Governance",
    "longDescription": "Function App 構成の FUNCTIONS_WORKER_RUNTIME 設定は、使用している言語に基づいて適切な値に設定する必要があります。この設定は、関数の実行に使用される言語ワーカーを決定するために使用されます。\n",
    "pgVerified": false,
    "description": "FUNCTIONS_WORKER_RUNTIME が正しく設定されていることを確認する",
    "potentialBenefits": "Better governance",
    "tags": null,
    "recommendationResourceType": "Microsoft.Web/sites",
    "recommendationImpact": "Medium",
    "automationAvailable": false,
    "query": "// cannot-be-validated-with-arg\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "88cb90c2-3b99-814b-9820-821a63f600dd",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/ja-jp/azure/reliability/migrate-app-service",
        "name": "Migrate App Service to availability zone support"
      },
      {
        "url": "https://learn.microsoft.com/ja-jp/azure/architecture/reference-architectures/enterprise-integration/ase-high-availability-deployment",
        "name": "High availability enterprise deployment using App Service Environment"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "可用性ゾーン全体に App Service プランをデプロイする Azure の機能は、データセンターの障害時の運用を保証し、異なるリージョンを必要とせずに冗長性を提供することで、ダウンタイムを最小限に抑え、中断のないサービスを維持することで、回復性と信頼性を向上させます。\n",
    "pgVerified": false,
    "description": "App Service を可用性ゾーンのサポートに移行する",
    "potentialBenefits": "Enhances app resiliency and reliability",
    "tags": null,
    "recommendationResourceType": "Microsoft.Web/serverFarms",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// The query filters the qualified App Service Plans that do not have Zone Redundancy enabled.\n// Its important to check regions that support availability zones for Azure App Services running on multi-tenant and App Service Environments https://learn.microsoft.com/en-us/azure/reliability/reliability-app-service?tabs=graph%2Ccli#:~:text=The%20following%20regions%20support%20Azure%20App%20Services%20running%20on%20multi%2Dtenant%20environments%3A\n\nresources\n| where type =~ 'microsoft.web/serverfarms'\n| extend zoneRedundant = tobool(properties.zoneRedundant)\n| extend sku_tier = tostring(sku.tier)\n| where (tolower(sku_tier) contains \"isolated\" or tolower(sku_tier) contains \"premium\") and zoneRedundant == false\n| project recommendationId=\"88cb90c2-3b99-814b-9820-821a63f600dd\", name, id, tags, param1=sku_tier, param2=\"Not Zone Redundant\"\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "b2113023-a553-2e41-9789-597e2fb54c31",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/ja-jp/azure/architecture/checklist/resiliency-per-service#app-service",
        "name": "Resiliency checklist for specific Azure services"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "Standard/Premium Azure App Service プランを選択すると、高度なスケーリング、高可用性、パフォーマンスの向上、複数のスロットを備えた堅牢なアプリが提供され、回復性と継続的な運用が確保されます。\n",
    "pgVerified": false,
    "description": "Standard または Premium レベルを使用する",
    "potentialBenefits": "Enhanced scaling and reliability",
    "tags": null,
    "recommendationResourceType": "Microsoft.Web/serverFarms",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Provides a list of Azure App Service Plans that are not in the \"Standard\", \"Premium\", or \"IsolatedV2\" SKU tiers.\n\nresources\n| where type =~ 'microsoft.web/serverfarms'\n| extend sku_tier = tostring(sku.tier)\n| where tolower(sku_tier) !contains \"standard\" and\n        tolower(sku_tier) !contains \"premium\" and\n        tolower(sku_tier) !contains \"isolatedv2\"\n| project recommendationId=\"b2113023-a553-2e41-9789-597e2fb54c31\", name, id, tags, param1= strcat(\"SKU=\",sku_tier)\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "07243659-4643-d44c-a1c6-07ac21635072",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/ja-jp/azure/architecture/checklist/resiliency-per-service#app-service",
        "name": "Resiliency checklist for specific Azure services"
      }
    ],
    "recommendationControl": "Scalability",
    "longDescription": "サービスの中断を防ぐために、Azure App Service インスタンスの頻繁なスケールアップ/スケールダウンを回避します。ワークロードに適したレベルとサイズを選択し、スケーリングの調整によってアプリケーションの再起動がトリガーされる可能性があるため、トラフィックの変化に合わせてスケールアウトします。\n",
    "pgVerified": false,
    "description": "スケールアップやスケールダウンを避ける",
    "potentialBenefits": "Minimizes restarts, enhances stability",
    "tags": null,
    "recommendationResourceType": "Microsoft.Web/serverFarms",
    "recommendationImpact": "Medium",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Provides a list of Azure App Service Plans and the number of changes that was made to the pricing tier, if the count is higher that 3 it means you need to avoid scaling up and down that often\n\nresourcechanges\n| extend changeTime = todatetime(properties.changeAttributes.timestamp), targetResourceId = tostring(properties.targetResourceId),\nchangeType = tostring(properties.changeType), correlationId = properties.changeAttributes.correlationId,\nchangedProperties = properties.changes, changeCount = properties.changeAttributes.changesCount\n| where changeTime > ago(14d)\n| join kind=inner (resources | project resources_Name = name, resources_Type = type, resources_Subscription= subscriptionId, resources_ResourceGroup= resourceGroup, id) on $left.targetResourceId == $right.id\n| where resources_Type contains \"microsoft.web/serverfarms\"\n| where changedProperties['sku.name'].propertyChangeType == 'Update' or changedProperties['sku.tier'].propertyChangeType == 'Update'\n| summarize count() by targetResourceId, resources_Name  ,tostring(changedProperties['sku.name'].previousValue), tostring(changedProperties['sku.tier'].newValue)\n| project recommendationId=\"07243659-4643-d44c-a1c6-07ac21635072\", name=resources_Name, id=targetResourceId, tags=\"\", param1=['changedProperties_sku.name_previousValue'], param2=['changedProperties_sku.tier_newValue'], param3=count_\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "dbe3fd66-fb2a-9d46-b162-1791e21da236",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/ja-jp/azure/architecture/checklist/resiliency-per-service#app-service",
        "name": "Resiliency checklist for specific Azure services"
      }
    ],
    "recommendationControl": "Governance",
    "longDescription": "本番環境とテスト環境用に別々の App Service プランを作成して、本番環境デプロイ内のスロットをテスト目的で使用しないようにすることを強くお勧めします。\n",
    "pgVerified": false,
    "description": "本番用とテスト用に個別の App Service プランを作成する",
    "potentialBenefits": "Protects prod performance; avoids test impact",
    "tags": null,
    "recommendationResourceType": "Microsoft.Web/serverFarms",
    "recommendationImpact": "High",
    "automationAvailable": false,
    "query": "// cannot-be-validated-with-arg\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "6320abf6-f917-1843-b2ae-4779c35985ae",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/ja-jp/azure/app-service/manage-automatic-scaling?tabs=azure-portal",
        "name": "Automatic scaling in Azure App Service"
      },
      {
        "url": "https://learn.microsoft.com/ja-jp/azure/azure-monitor/autoscale/autoscale-get-started",
        "name": "Auto Scale Web Apps"
      }
    ],
    "recommendationControl": "Scalability",
    "longDescription": "Azure App Service の自動スケール/自動スケーリングを有効にすると、受信要求に十分なリソースが確保されます。自動スケールはルールベースですが、新しい機能である自動スケーリングは、HTTP トラフィックに基づいてリソースを自動的に調整します。\n",
    "pgVerified": false,
    "description": "自動スケール/自動スケーリングを有効にして、サービス要求に十分なリソースを使用できるようにする",
    "potentialBenefits": "Optimizes resources for traffic",
    "tags": null,
    "recommendationResourceType": "Microsoft.Web/serverFarms",
    "recommendationImpact": "Medium",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "5a44bd30-ae6a-4b81-9b68-dc3a8ffca4d8",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/azure-cache-for-redis/cache-how-to-zone-redundancy",
        "name": "Azure Cache for Redis のゾーン冗長性を有効にする"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "Azure Cache for Redis では、Premium レベルと Enterprise レベルでゾーン冗長性が提供され、複数の可用性ゾーンにまたがる VM を使用して、回復性と可用性を向上できます。\n",
    "pgVerified": false,
    "description": "Azure Cache for Redis のゾーン冗長を有効にする",
    "potentialBenefits": "Higher resilience and availability",
    "tags": null,
    "recommendationResourceType": "Microsoft.Cache/Redis",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Find Cache for Redis instances with one or no Zones selected\nresources\n| where type =~ \"microsoft.cache/redis\"\n| where array_length(zones) <= 1 or isnull(zones)\n| project recommendationId = \"5a44bd30-ae6a-4b81-9b68-dc3a8ffca4d8\", name, id, tags, param1 = \"AvailabilityZones: Single Zone\"\n| order by id asc\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "cabc1f98-c8a7-44f7-ab24-977982ef3f70",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/azure-cache-for-redis/cache-administration#update-channel-and-schedule-updates",
        "name": "Azure Cache for Redis の更新のスケジュール"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "Azure Cache for Redis では、メンテナンス期間を指定できます。メンテナンス ウィンドウを使用すると、キャッシュをホストしている VM を更新できる曜日と時刻を制御できます。\n",
    "pgVerified": false,
    "description": "メンテナンス期間を設定して更新をスケジュールする",
    "potentialBenefits": "Higher resilience and availability",
    "tags": null,
    "recommendationResourceType": "Microsoft.Cache/redis",
    "recommendationImpact": "Medium",
    "automationAvailable": false,
    "query": "// cannot-be-validated-with-arg\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "c474fc96-4e6a-4fb0-95d0-a26b3f35933c",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/azure-cache-for-redis/cache-network-isolation",
        "name": "Azure Redis Cache でプライベート エンドポイントを構成する"
      }
    ],
    "recommendationControl": "Security",
    "longDescription": "プライベート エンドポイントを使用して、プライベート リンク経由でキャッシュするための安全な接続を行い、パブリック インターネットを回避します。\n",
    "pgVerified": false,
    "description": "プライベート エンドポイントを設定する",
    "potentialBenefits": "Secure, private VNet ingress, efficient data transfer",
    "tags": null,
    "recommendationResourceType": "Microsoft.Cache/redis",
    "recommendationImpact": "Medium",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Find all Azure Redis cache services not protected by private endpoints.\nResources\n| where type =~ \"microsoft.cache/redis\"\n| where properties['publicNetworkAccess'] == \"Enabled\"\n| project recommendationId = \"c474fc96-4e6a-4fb0-95d0-a26b3f35933c\", name, id, tags\n| order by id asc\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "3464854d-6f75-4922-95e4-a2a308b53ce6",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/reliability/reliability-batch#cross-region-disaster-recovery-and-business-continuity",
        "name": "リージョン間のディザスター リカバリーと事業継続"
      }
    ],
    "recommendationControl": "Monitoring and Alerting",
    "longDescription": "リージョン間のディザスター リカバリーとビジネス継続性を確保するには、すべての Batch アカウントに適切なクォータを設定して、必要なコア数を事前に割り当て、クォータ制限に達したことで実行が中断されることを防ぎます。\n",
    "pgVerified": false,
    "description": "Batch アカウントのクォータを監視する",
    "potentialBenefits": "Ensures business continuity",
    "tags": null,
    "recommendationResourceType": "Microsoft.Batch/batchAccounts",
    "recommendationImpact": "Medium",
    "automationAvailable": false,
    "query": "// cannot-be-validated-with-arg\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "71cfab8f-d588-4742-b175-b6e07ae48dbd",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/batch/create-pool-availability-zones",
        "name": "可用性ゾーン間で Azure Batch プールを作成する"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "Azure Batch プールに仮想マシン構成を使用する場合、可用性ゾーン間でプールを分散することを選択すると、Azure データセンターの障害に対してコンピューティング ノードが強化されます。\n",
    "pgVerified": false,
    "description": "可用性ゾーン間で Azure Batch プールを作成する",
    "potentialBenefits": "Enhanced reliability and failure protection",
    "tags": null,
    "recommendationResourceType": "Microsoft.Batch/batchAccounts",
    "recommendationImpact": "High",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "be448849-0d7d-49ba-9c94-9573ee533d5d",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/service-health/resource-health-overview",
        "name": "Resource Health の概要"
      },
      {
        "url": "https://learn.microsoft.com/azure/service-health/resource-health-alert-monitor-guide#create-a-resource-health-alert-rule-in-the-azure-portal",
        "name": "Azure portal で Resource Health アラート ルールを作成する"
      },
      {
        "url": "https://learn.microsoft.com/azure/service-health/alerts-activity-log-service-notifications-portal",
        "name": "正常性アラート"
      }
    ],
    "recommendationControl": "Monitoring and Alerting",
    "longDescription": "該当するすべてのリソースに対して Resource Health アラートを構成して、Azure リソースの現在および過去の正常性状態を常に把握します。これらのリソースの正常性状態が変更されると、通知されます。\n",
    "pgVerified": true,
    "description": "リソース正常性アラートを構成する",
    "potentialBenefits": "Stay informed on resource status",
    "tags": null,
    "recommendationResourceType": "Microsoft.Insights/activityLogAlerts",
    "recommendationImpact": "Low",
    "automationAvailable": false,
    "query": "// cannot-be-validated-with-arg\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "9729c89d-8118-41b4-a39b-e12468fa872b",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/service-health/overview",
        "name": "Azure Service Health とは"
      },
      {
        "url": "https://learn.microsoft.com/azure/service-health/alerts-activity-log-service-notifications-portal",
        "name": "サービス正常性イベントのアラートを構成する"
      }
    ],
    "recommendationControl": "Monitoring and Alerting",
    "longDescription": "サービス正常性は、使用している Azure サービスとリージョンのパーソナライズされた正常性ビューを提供し、使用しているサービスを把握することで、停止、計画メンテナンス、正常性アドバイザリに関する通知に最適な場所を提供します。\n",
    "pgVerified": true,
    "description": "サービス正常性アラートを構成する",
    "potentialBenefits": "Proactive outage and maintenance alerts",
    "tags": null,
    "recommendationResourceType": "Microsoft.Insights/activityLogAlerts",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// This resource graph query will return all subscriptions without Service Health alerts configured.\n\nresourcecontainers\n| where type == 'microsoft.resources/subscriptions'\n| project subscriptionAlerts=tostring(id),name,tags\n| join kind=leftouter (\n  resources\n  | where type == 'microsoft.insights/activitylogalerts' and properties.condition contains \"ServiceHealth\"\n  | extend subscriptions = properties.scopes\n  | project subscriptions\n  | mv-expand subscriptions\n  | project subscriptionAlerts = tostring(subscriptions)\n) on subscriptionAlerts\n| where isempty(subscriptionAlerts1)\n| project-away subscriptionAlerts1\n| project recommendationId = \"9729c89d-8118-41b4-a39b-e12468fa872b\",id=subscriptionAlerts,name,tags\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "dac421ec-2832-4c37-839e-b6dc5a38f2fa",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/azure-monitor/app/convert-classic-resource",
        "name": "ワークスペースベースの Application Insights リソースに移行する"
      }
    ],
    "recommendationControl": "Service Upgrade and Retirement",
    "longDescription": "クラシック Application Insights は 2024 年 2 月に廃止されます。既存のアプリケーション監視シナリオの中断を最小限に抑えるには、2024 年 2 月 29 日より前にワークスペースベースの Application Insights に移行してください。\n",
    "pgVerified": false,
    "description": "クラシック デプロイメントを変換する",
    "potentialBenefits": "Avoid service disruption post-Feb 2024",
    "tags": null,
    "recommendationResourceType": "Microsoft.Insights/components",
    "recommendationImpact": "Medium",
    "automationAvailable": true,
    "query": "// Azure Resource Graph query\n// Filters Application Insights resources with ‘Classic’ deployment type\nresources\n| where type =~ \"microsoft.insights/components\"\n| extend IngestionMode = properties.IngestionMode\n| where IngestionMode =~ 'ApplicationInsights'\n| project recommendationId= \"dac421ec-2832-4c37-839e-b6dc5a38f2fa\", name, id, tags, param1=\"ApplicationInsightsDeploymentType: Classic\"\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "0e835cc2-2551-a247-b1f1-3c5f25c9cb70",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/databricks/release-notes/runtime/databricks-runtime-ver",
        "name": "Databricks ランタイムのサポート ライフサイクル"
      }
    ],
    "recommendationControl": "Governance",
    "longDescription": "Databricks では、安定性とサポートを強化するために、ワークロードを最新バージョンまたは LTS バージョンのランタイムに移行することをお勧めします。Runtime 11.3 LTS 以降を使用している場合は、最新の 12.x バージョンに直接移行します。それ以前の場合は、まず 11.3 LTS に移行し、次に移行ガイドに従って最新の 12.x バージョンに移行します。\n",
    "pgVerified": true,
    "description": "Databricks ランタイムのバージョンが最新でないか、LTS バージョンではない",
    "potentialBenefits": "Enhanced stability and support",
    "tags": null,
    "recommendationResourceType": "Microsoft.Databricks/workspaces",
    "recommendationImpact": "Medium",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "c166602e-0804-e34b-be8f-09b4d56e1fcd",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/databricks/lakehouse-architecture/reliability/best-practices",
        "name": "信頼性のためのベスト プラクティス"
      }
    ],
    "recommendationControl": "Scalability",
    "longDescription": "Databricks プールは VM を事前にプロビジョニングすることで、クラスターの起動やスケーリング中のプロビジョニング エラーのリスクを軽減し、信頼性を高めます。\n",
    "pgVerified": true,
    "description": "Databricks プールを使用する",
    "potentialBenefits": "Reduces provisioning errors",
    "tags": null,
    "recommendationResourceType": "Microsoft.Databricks/workspaces",
    "recommendationImpact": "High",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "5877a510-8444-7a4c-8412-a8dab8662f7e",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/virtual-machines/disks-types#premium-ssd",
        "name": "Azure マネージド ディスクの種類"
      }
    ],
    "recommendationControl": "Scalability",
    "longDescription": "Premium VM の HDD を SSD にアップグレードして、速度と信頼性を向上させます。Premium SSD は IO 負荷の高いアプリケーションをブーストします。Standard SSD はコストとパフォーマンスのバランスをとります。重要なワークロードに最適で、アップグレードすると短時間の再起動で接続性が向上します。重要な VM でご検討ください。\n",
    "pgVerified": true,
    "description": "ワーカー VM の種類とドライバーの種類に SSD による VM を使用する",
    "potentialBenefits": "Faster, reliable VM performance",
    "tags": null,
    "recommendationResourceType": "Microsoft.Databricks/workspaces",
    "recommendationImpact": "Medium",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "5c72f0d6-55ec-d941-be84-36c194fa78c0",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/databricks/lakehouse-architecture/reliability/best-practices#enable-autoscaling-for-batch-workloads",
        "name": "信頼性のためのベスト プラクティス"
      }
    ],
    "recommendationControl": "Scalability",
    "longDescription": "自動スケーリングは、ワークロードの需要に基づいてクラスター サイズを自動的に調整し、コストとパフォーマンスの面で多くのユースケースにメリットをもたらします。これには、自動スケーリングを最適に活用するタイミングと方法に関するガイダンスが含まれています。ストリーミングの場合は、自動スケールを備えた Delta Live Tables をお勧めします。\n",
    "pgVerified": true,
    "description": "バッチ ワークロードの自動スケーリングを有効にする",
    "potentialBenefits": "Cost and performance optimization",
    "tags": null,
    "recommendationResourceType": "Microsoft.Databricks/workspaces",
    "recommendationImpact": "High",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "362ad2b6-b92c-414f-980a-0cf69467ccce",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/databricks/lakehouse-architecture/reliability/best-practices#enable-autoscaling-for-sql-warehouse",
        "name": "信頼性のためのベスト プラクティス"
      }
    ],
    "recommendationControl": "Scalability",
    "longDescription": "SQL ウェアハウスのスケーリング パラメーターは、クエリを分散するためのクラスターの最小数と最大数を定義します。既定では、1 に設定されています。クラスター数を増やすと、より多くの同時ユーザーを効果的に収容できます。\n",
    "pgVerified": true,
    "description": "SQL ウェアハウスの自動スケールを有効にする",
    "potentialBenefits": "Improves concurrency and efficiency",
    "tags": null,
    "recommendationResourceType": "Microsoft.Databricks/workspaces",
    "recommendationImpact": "High",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "cd77db98-9b13-6e4b-bd2b-74c2cb538628",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/databricks/lakehouse-architecture/reliability/best-practices",
        "name": "信頼性のためのベスト プラクティス"
      },
      {
        "url": "https://learn.microsoft.com/azure/databricks/delta-live-tables/settings#use-autoscaling-to-increase-efficiency-and-reduce-resource-usage",
        "name": "Databricks 拡張自動スケーリング"
      }
    ],
    "recommendationControl": "Scalability",
    "longDescription": "Databricks の拡張自動スケーリングは、パイプラインのデータ処理待機時間への影響を最小限に抑えながら、ワークロードの量に基づいてクラスター リソースを自動的に割り当てることで、クラスターの使用率を最適化します。\n",
    "pgVerified": true,
    "description": "Delta Live Tables の強化された自動スケールを使用する",
    "potentialBenefits": "Optimized resource use and minimal latency",
    "tags": null,
    "recommendationResourceType": "Microsoft.Databricks/workspaces",
    "recommendationImpact": "Medium",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "3d3e53b5-ebd1-db42-b43b-d4fad74824ec",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/databricks/lakehouse-architecture/reliability/best-practices",
        "name": "信頼性のためのベスト プラクティス"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "クラスター リソースを節約するために、クラスターを終了して、将来の再使用ジョブや自動始動ジョブのためにその構成を保管することができます。クラスターは非アクティブになった後に自動終了できますが、これは Spark ジョブのみを追跡し、Spark ジョブが終了した後も実行されている可能性のあるローカル プロセスは追跡しません。\n",
    "pgVerified": true,
    "description": "自動ジョブ終了が有効で、ユーザー定義のローカル プロセスがないことを確認する",
    "potentialBenefits": "Saves cluster resources, avoids idle use",
    "tags": null,
    "recommendationResourceType": "Microsoft.Databricks/workspaces",
    "recommendationImpact": "Medium",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "7fb90127-5364-bb4d-86fa-30778ed713fb",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/databricks/clusters/configure#cluster-log-delivery",
        "name": "コンピューティング構成リファレンス"
      }
    ],
    "recommendationControl": "Monitoring and Alerting",
    "longDescription": "Databricks クラスターを作成するときに、Spark ドライバー、ワーカー ノード、およびイベントのログ配信場所を設定できます。ログは 5 分ごとに配信され、1 時間ごとにアーカイブされます。クラスターが終了すると、その時点までに生成されたすべてのログが配信されることが保証されます。\n",
    "pgVerified": true,
    "description": "ログを有効にする - コンピューティング ログの配信",
    "potentialBenefits": "Improved troubleshooting and audit",
    "tags": null,
    "recommendationResourceType": "Microsoft.Databricks/workspaces",
    "recommendationImpact": "Medium",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "da4ea916-4df3-8c4d-8060-17b49da45977",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/databricks/lakehouse-architecture/reliability/best-practices",
        "name": "信頼性のためのベスト プラクティス"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "Delta Lake は、ACID トランザクション、スキーマの適用、スケーラブルなメタデータ処理により、データ レイクの信頼性を高めるオープン ソースのストレージ形式です。\n",
    "pgVerified": true,
    "description": "Delta Lake を使用して信頼性を高める",
    "potentialBenefits": "Enhances data reliability and processing",
    "tags": null,
    "recommendationResourceType": "Microsoft.Databricks/workspaces",
    "recommendationImpact": "High",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "892ca809-e2b5-9a47-924a-71132bf6f902",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/databricks/lakehouse-architecture/reliability/best-practices#use-apache-spark-or-photon-for-distributed-compute",
        "name": "信頼性のためのベスト プラクティス"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "Databricks レイクハウスの Apache Spark は、失敗したタスクを自動的に再スケジュールすることで、回復力のある分散データ処理を保証し、ネットワークの問題や失効した VM などの外部の問題を克服するのに役立ちます。\n",
    "pgVerified": true,
    "description": "Photon アクセラレーションを使用する",
    "potentialBenefits": "Boosts speed and reliability for Spark tasks",
    "tags": null,
    "recommendationResourceType": "Microsoft.Databricks/workspaces",
    "recommendationImpact": "Low",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "7e52d64d-8cc0-8548-a593-eb49ab45630d",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/databricks/lakehouse-architecture/reliability/best-practices",
        "name": "信頼性のためのベスト プラクティス"
      }
    ],
    "recommendationControl": "Business Continuity",
    "longDescription": "無効や不適合なデータは、特定のデータ形式に依存するワークロードをクラッシュさせる可能性があります。ベスト プラクティスでは、インジェスト時にこのようなデータをフィルター処理してエンドツーエンドの回復性を向上させ、データが失われたり失われたりしないようにすることをお勧めします。\n",
    "pgVerified": true,
    "description": "Databricks Auto Loader や Delta Live Tables を使用して、無効なデータや不適合のデータを自動的に復旧する",
    "potentialBenefits": "Enhanced data resilience and integrity",
    "tags": null,
    "recommendationResourceType": "Microsoft.Databricks/workspaces",
    "recommendationImpact": "Low",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "84e44da6-8cd7-b349-b02c-c8bf72cf587c",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/databricks/lakehouse-architecture/reliability/best-practices",
        "name": "信頼性のためのベスト プラクティス"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "Databricks と MLflow を使用して、ジョブのスケジュール設定、再試行、自動スケーリング用の Spark UDF としてモデルをデプロイします。モデル サービングは、スケーラブルなインフラストラクチャを提供し、MLflow を使用してモデルを処理し、Databricks クラウドで管理されるサーバーレスコンピューティングを使用して REST API を介してモデルを提供します。\n",
    "pgVerified": true,
    "description": "ジョブの自動再試行と終了を構成する",
    "potentialBenefits": "Enhanced reliability and autoscaling",
    "tags": null,
    "recommendationResourceType": "Microsoft.Databricks/workspaces",
    "recommendationImpact": "High",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "4cbb7744-ff3d-0447-badb-baf068c95696",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/databricks/lakehouse-architecture/reliability/best-practices",
        "name": "信頼性のためのベスト プラクティス"
      }
    ],
    "recommendationControl": "Scalability",
    "longDescription": "Databricks と MLflow を使用して、モデルを Apache Spark UDF としてデプロイし、ジョブのスケジュール設定、再試行、自動スケーリングなどのメリットを享受します。\n",
    "pgVerified": true,
    "description": "スケーラブルな本番環境グレードのモデル サービング インフラストラクチャを使用する",
    "potentialBenefits": "Enhances scalability and reliability",
    "tags": null,
    "recommendationResourceType": "Microsoft.Databricks/workspaces",
    "recommendationImpact": "High",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "1b0d0893-bf0e-8f4c-9dc6-f18f145c1ecf",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/databricks/lakehouse-architecture/reliability/best-practices",
        "name": "信頼性のためのベスト プラクティス"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "階層化されたアーキテクチャを作成してデータをキュレーションし、レイヤー全体のデータ品質を向上させます。取り込まれたソース データの未加工レイヤーから始めて、クレンジングおよび精製されたデータ用のキュレーションされたレイヤーに続き、セキュリティとパフォーマンスに重点を置いたビジネス ニーズに応える最終レイヤーで終わります。\n",
    "pgVerified": true,
    "description": "階層型ストレージ アーキテクチャを使用する",
    "potentialBenefits": "Enhances data quality and trust",
    "tags": null,
    "recommendationResourceType": "Microsoft.Databricks/workspaces",
    "recommendationImpact": "Medium",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "e93fe702-e385-d741-ba37-1f1656482ecd",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/databricks/lakehouse-architecture/reliability/best-practices",
        "name": "信頼性のためのベスト プラクティス"
      }
    ],
    "recommendationControl": "Business Continuity",
    "longDescription": "データをコピーすると、冗長性、整合性の喪失、系列、アクセスの問題が発生し、レイクハウスのデータ品質に影響します。一時コピーは、俊敏性とイノベーションに役立ちますが、データのマスター ステータスと最新性に疑問が生じ、問題のある運用データ サイロになる可能性があります。\n",
    "pgVerified": true,
    "description": "データの冗長性を削減することでデータの整合性を向上させる",
    "potentialBenefits": "Enhanced data integrity and quality",
    "tags": null,
    "recommendationResourceType": "Microsoft.Databricks/workspaces",
    "recommendationImpact": "Low",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "b7e1d13f-54c9-1648-8a52-34c0abe8ce16",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/databricks/lakehouse-architecture/reliability/best-practices",
        "name": "信頼性のためのベスト プラクティス"
      }
    ],
    "recommendationControl": "Other Best Practices",
    "longDescription": "制御されていないスキーマの変更は、無効なデータやジョブの失敗につながる可能性があります。Databricks は、インジェスト中の不良レコードを防ぐ Delta Lake と、新しい列を検出し、データの整合性を維持するためにスキーマの進化をサポートする自動ローダーを使用して、スキーマを検証して適用します。\n",
    "pgVerified": true,
    "description": "スキーマを積極的に管理する",
    "potentialBenefits": "Prevents invalid data and job failures",
    "tags": null,
    "recommendationResourceType": "Microsoft.Databricks/workspaces",
    "recommendationImpact": "Medium",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "a42297c4-7e4f-8b41-8d4b-114033263f0e",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/databricks/lakehouse-architecture/reliability/best-practices#use-constraints-and-data-expectations",
        "name": "信頼性のためのベスト プラクティス"
      }
    ],
    "recommendationControl": "Business Continuity",
    "longDescription": "Delta テーブルでは、SQL 制約を使用してデータ品質が自動的に検証され、違反に対してエラーがトリガーされます。Delta Live Tables は、Python や SQL を使用してデータ品質の期待を定義し、レコード障害のアクションを管理し、データの整合性とコンプライアンスを確保することで、これを強化します。\n",
    "pgVerified": true,
    "description": "制約とデータの期待値を使用する",
    "potentialBenefits": "Ensures data quality and integrity",
    "tags": null,
    "recommendationResourceType": "Microsoft.Databricks/workspaces",
    "recommendationImpact": "Low",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "932d45d6-b46d-e341-abfb-d97bce832f1f",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/databricks/lakehouse-architecture/reliability/best-practices#create-regular-backups",
        "name": "信頼性のためのベスト プラクティス"
      }
    ],
    "recommendationControl": "Disaster Recovery",
    "longDescription": "障害から復旧するには、定期的なバックアップが必要です。Databricks Labs プロジェクトの移行により、管理者は Databricks CLI/API を使用してワークスペース資産をエクスポートすることでバックアップを作成できます。これらのバックアップは、ワークスペースの復元や移行に役立ちます。\n",
    "pgVerified": true,
    "description": "定期的なバックアップを作成する",
    "potentialBenefits": "Ensures data recovery and migration",
    "tags": null,
    "recommendationResourceType": "Microsoft.Databricks/workspaces",
    "recommendationImpact": "Low",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "12e9d852-5cdc-2743-bffe-ee21f2ef7781",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/databricks/lakehouse-architecture/reliability/best-practices#recover-from-structured-streaming-query-failures",
        "name": "信頼性のためのベスト プラクティス"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "構造化ストリーミングは、ストリーミング クエリのフォールト トレランスとデータの一貫性を保証します。Azure Databricks ワークフローを使用すると、失敗後に自動的に再起動するようにクエリを設定し、中断したところから正確に再開できます。\n",
    "pgVerified": true,
    "description": "構造化ストリーミングのクエリ エラーから復旧する",
    "potentialBenefits": "Fault-tolerance and auto-restart for queries",
    "tags": null,
    "recommendationResourceType": "Microsoft.Databricks/workspaces",
    "recommendationImpact": "High",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "a18d60f8-c98c-ba4e-ad6e-2fac72879df1",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/databricks/lakehouse-architecture/reliability/best-practices#recover-etl-jobs-based-on-delta-time-travel",
        "name": "信頼性のためのベスト プラクティス"
      }
    ],
    "recommendationControl": "Disaster Recovery",
    "longDescription": "徹底的なテストにもかかわらず、本番ジョブは失敗したり、予期しないデータを生成したりする可能性があります。場合によっては、問題を識別し、パイプライン修正後にジョブを追加することによって修理が行われることがあります。\n",
    "pgVerified": true,
    "description": "Delta タイム トラベルに基づく ETL ジョブの回復",
    "potentialBenefits": "Easy rollback and fix for ETL jobs",
    "tags": null,
    "recommendationResourceType": "Microsoft.Databricks/workspaces",
    "recommendationImpact": "Medium",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "c0e22580-3819-444d-8546-a80e4ed85c83",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/databricks/lakehouse-architecture/reliability/best-practices",
        "name": "信頼性のためのベスト プラクティス"
      }
    ],
    "recommendationControl": "Disaster Recovery",
    "longDescription": "Databricks ワークフローは、問題調査のためのマトリックス ビューを提供することで、マルチタスク ジョブでの効率的なエラー回復を可能にします。修正を適用して、失敗したタスクと依存するタスクのみを対象とした修復の実行を開始し、成功した結果を維持し、時間とコストを節約できます。\n",
    "pgVerified": true,
    "description": "Databricks ワークフローと組み込みの復旧を使用する",
    "potentialBenefits": "Saves time and money with smart recovery",
    "tags": null,
    "recommendationResourceType": "Microsoft.Databricks/workspaces",
    "recommendationImpact": "Low",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "4fdb7112-4531-6f48-b60e-c917a6068d9b",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://github.com/Azure/AzureDatabricksBestPractices/tree/master",
        "name": "信頼性のためのベスト プラクティス"
      }
    ],
    "recommendationControl": "Disaster Recovery",
    "longDescription": "ディザスター リカバリー パターンの実装は Azure Databricks にとって不可欠であり、まれに発生するリージョン停止時にもデータ チームのアクセスを確保します。\nAzure Databricks サービスは完全にゾーン冗長ではなく、ゾーン フェールオーバーをサポートしていることに注意することが重要です。\n",
    "pgVerified": false,
    "description": "ディザスター リカバリー パターンを構成する",
    "potentialBenefits": "Ensures service continuity during disasters",
    "tags": null,
    "recommendationResourceType": "Microsoft.Databricks/workspaces",
    "recommendationImpact": "High",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "42aedaa8-6151-424d-b782-b8666c779969",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/databricks/lakehouse-architecture/operational-excellence/best-practices#2-automate-deployments-and-workloads",
        "name": "オペレーショナル エクセレンスのベスト プラクティス"
      }
    ],
    "recommendationControl": "Other Best Practices",
    "longDescription": "Databricks Terraform プロバイダーは、Azure Databricks ワークスペースとクラウド インフラストラクチャを柔軟かつ強力に管理します。\n",
    "pgVerified": false,
    "description": "デプロイとワークロードを自動化する",
    "potentialBenefits": "Efficient, reliable automation",
    "tags": null,
    "recommendationResourceType": "Microsoft.Databricks/workspaces",
    "recommendationImpact": "High",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "20193ff9-dbcd-a74e-b197-71d7d9d3c1e6",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/databricks/lakehouse-architecture/operational-excellence/best-practices#system-monitoring",
        "name": "オペレーショナル エクセレンスのベスト プラクティス"
      }
    ],
    "recommendationControl": "Monitoring and Alerting",
    "longDescription": "Databricks Terraform プロバイダーは、Azure Databricks ワークスペースとクラウド インフラストラクチャを管理するための柔軟で強力なツールです。\n",
    "pgVerified": false,
    "description": "監視、アラート、ログを設定する",
    "potentialBenefits": "Enhanced reliability and automation",
    "tags": null,
    "recommendationResourceType": "Microsoft.Databricks/workspaces",
    "recommendationImpact": "High",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "397cdebb-9d6e-ab4f-83a1-8c481de0a3a7",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://github.com/Azure/AzureDatabricksBestPractices/blob/master/toc.md#deploy-workspaces-in-multiple-subscriptions-to-honor-azure-capacity-limits",
        "name": "Azure Databricks Best Practices"
      }
    ],
    "recommendationControl": "Scalability",
    "longDescription": "多くの場合、顧客はワークスペースをチームや部門ごとに自然に分割します。ただし、パーティション分割の際には、Azure サブスクリプションと Azure Databricks ワークスペースの制限も考慮することが重要です。\n",
    "pgVerified": false,
    "description": "ワークスペースを個別のサブスクリプションにデプロイする",
    "potentialBenefits": "Enhanced limits management, team separation",
    "tags": null,
    "recommendationResourceType": "Microsoft.Databricks/workspaces",
    "recommendationImpact": "High",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "5e722c4f-415a-9b4c-bd4c-96b74dce29ad",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://github.com/Azure/AzureDatabricksBestPractices/blob/master/toc.md#consider-isolating-each-workspace-in-its-own-vnet",
        "name": "Azure Databricks Best Practices"
      }
    ],
    "recommendationControl": "Scalability",
    "longDescription": "VNet ごとに Databricks ワークスペースを 1 つだけデプロイすることは Azure Databricks の分離モデルと一致します。\n",
    "pgVerified": false,
    "description": "各ワークスペースを個別の VNet に分離する",
    "potentialBenefits": "Enhanced security and resource isolation",
    "tags": null,
    "recommendationResourceType": "Microsoft.Databricks/workspaces",
    "recommendationImpact": "High",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "14310ba6-77ad-3641-a2db-57a2218b9bc7",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://github.com/Azure/AzureDatabricksBestPractices/blob/master/toc.md#do-not-store-any-production-data-in-default-dbfs-folders",
        "name": "Azure Databricks Best Practices"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "セキュリティとデータの可用性に関する懸念によるものです。どのワークスペースにも既定の DBFS が付属しており、主にライブラリや Init スクリプトなどのシステム レベルの構成アーティファクトを格納するように設計されています。運用データ用ではありません。\n",
    "pgVerified": false,
    "description": "既定のの DBFS フォルダーに本番データを格納しない",
    "potentialBenefits": "Enhanced security, data protection",
    "tags": null,
    "recommendationResourceType": "Microsoft.Databricks/workspaces",
    "recommendationImpact": "High",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "b5af7e26-3939-1b48-8fba-f8d4a475c67a",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/virtual-machines/spot-vms",
        "name": "Azure Spot Virtual Machines を使用する"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "Azure スポット VM は、高可用性と信頼性を必要とする重要な運用ワークロードには適していません。これらはフォールト トレラント タスクを対象としており、Azure で容量が必要な場合は 30 秒前に通知して削除でき、SLA は保証されません。\n",
    "pgVerified": false,
    "description": "重要な運用ワークロードに Azure スポット VM を使用しない",
    "potentialBenefits": "Ensures high reliability for production",
    "tags": null,
    "recommendationResourceType": "Microsoft.Databricks/workspaces",
    "recommendationImpact": "High",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "8aa63c34-dd9d-49bd-9582-21ec310dfbdd",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/databricks/resources/supported-regions#--azure-databricks-control-plane-addresses",
        "name": "Azure Databricks コントロール プレーン アドレス"
      },
      {
        "url": "https://github.com/databrickslabs/migrate",
        "name": "Migrate - Databricks Inc. によって保守されている"
      },
      {
        "url": "https://registry.terraform.io/providers/databricks/databricks/latest/docs/guides/experimental-exporter",
        "name": "Databricks Terraform Exporter - Databricks Inc. によって保守されている (実験的)"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "ワークスペースをリージョン内のコントロール プレーンに移動して、リージョンの分離を強化します。ワークスペース URL と nslookup を使用して、現在のコントロール プレーン領域を特定します。CNAME のリージョンがワークスペース リージョンと異なり、リージョン内コントロールを使用できる場合は、以下に示すツールを使用した移行を検討してください。\n",
    "pgVerified": false,
    "description": "ワークスペースのリージョン分離を評価する",
    "potentialBenefits": "Improves resilience and data sovereignty",
    "tags": null,
    "recommendationResourceType": "Microsoft.Databricks/workspaces",
    "recommendationImpact": "High",
    "automationAvailable": false,
    "query": "// cannot-be-validated-with-arg\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "028593be-956e-4736-bccf-074cb10b92f4",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/databricks/compute/cluster-config-best-practices",
        "name": "コンピューティング構成のベスト プラクティス"
      },
      {
        "url": "https://learn.microsoft.com/azure/databricks/compute/gpu",
        "name": "GPU 対応コンピューティング"
      }
    ],
    "recommendationControl": "Personalized",
    "longDescription": "Azure Databricks の計画には、容量の問題に対する VM SKU スワップ戦略を含める必要があります。VM はリージョンごとのリソースであり、\"CLOUD PROVIDER\" エラーで示される割り当てエラーが発生する可能性があります。\n",
    "pgVerified": false,
    "description": "代替 VM SKU を定義する",
    "potentialBenefits": "Ensures service availability",
    "tags": null,
    "recommendationResourceType": "Microsoft.Databricks/workspaces",
    "recommendationImpact": "Medium",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "e7495e1c-0c75-0946-b266-b429b5c7f3bf",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/virtual-machine-scale-sets/virtual-machine-scale-sets-design-overview#when-to-use-scale-sets-instead-of-virtual-machines",
        "name": "仮想マシンではなくスケール セットを使用するケース"
      },
      {
        "url": "https://learn.microsoft.com/azure/well-architected/services/compute/virtual-machines/virtual-machines-review",
        "name": "Virtual Machines とスケール セットに関する Azure Well-Architected Framework の観点"
      }
    ],
    "recommendationControl": "Scalability",
    "longDescription": "フレキシブル オーケストレーション モードを使用して単一インスタンスの VM をスケール セットにデプロイすると、アプリケーションのスケーリングと可用性が将来にわたって保証されます。このモードでは、リージョン内または可用性ゾーン内の障害ドメイン間で VM を分散することで、高可用性 (最大 1000 個の VM) が保証されます。\n",
    "pgVerified": true,
    "description": "VMSS を Uniform ではなく Flex オーケストレーション モードでデプロイする",
    "potentialBenefits": "Higher scalability and availability",
    "tags": null,
    "recommendationResourceType": "Microsoft.Compute/virtualMachineScaleSets",
    "recommendationImpact": "Medium",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Find all zonal VMs that are NOT deployed with Flex orchestration mode\nresources\n| where type == \"microsoft.compute/virtualmachinescalesets\"\n| where properties.orchestrationMode != \"Flexible\"\n| project recommendationId = \"e7495e1c-0c75-0946-b266-b429b5c7f3bf\", name, id, tags, param1 = strcat(\"orchestrationMode: \", tostring(properties.orchestrationMode))\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "94794d2a-eff0-2345-9b67-6f9349d0a627",
    "recommendationTypeId": "3b587048-b04b-4f81-aaed-e43793652b0f",
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/virtual-machine-scale-sets/virtual-machine-scale-sets-health-extension?tabs=rest-api",
        "name": "Virtual Machine Scale Sets でアプリケーションの正常性拡張機能を使用する"
      }
    ],
    "recommendationControl": "Monitoring and Alerting",
    "longDescription": "Azure Virtual Machine Scale Sets でのアプリケーションの正常性の監視は、デプロイ管理にとって非常に重要です。OS イメージの自動アップグレードや VM ゲストのパッチ適用などのローリング アップグレードをサポートし、アップグレードに正常性監視を活用します。\n",
    "pgVerified": true,
    "description": "Azure 仮想マシン スケール セットのアプリケーション正常性監視を有効にする",
    "potentialBenefits": "Enhances deployment management and upgrades",
    "tags": null,
    "recommendationResourceType": "Microsoft.Compute/virtualMachineScaleSets",
    "recommendationImpact": "Medium",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Find all VMs that do NOT have health monitoring enabled\nresources\n| where type == \"microsoft.compute/virtualmachinescalesets\"\n| join kind=leftouter  (\n    resources\n    | where type == \"microsoft.compute/virtualmachinescalesets\"\n    | mv-expand extension=properties.virtualMachineProfile.extensionProfile.extensions\n    | where extension.properties.type in ( \"ApplicationHealthWindows\", \"ApplicationHealthLinux\" )\n    | project id\n) on id\n| where id1 == \"\"\n| project recommendationId = \"94794d2a-eff0-2345-9b67-6f9349d0a627\", name, id, tags, param1 = \"extension: null\"\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "820f4743-1f94-e946-ae0b-45efafd87962",
    "recommendationTypeId": "b4d988a9-85e6-4179-b69c-549bdd8a55bb",
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/virtual-machine-scale-sets/virtual-machine-scale-sets-automatic-instance-repairs#requirements-for-using-automatic-instance-repairs",
        "name": "Azure Virtual Machine Scale Sets の自動インスタンス修復"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "Azure Virtual Machine Scale Sets で自動インスタンス修復を有効にすると、継続的な正常性チェックとメンテナンス プロセスを通じてアプリケーションの可用性が向上します。\n",
    "pgVerified": true,
    "description": "Azure 仮想マシン スケール セットで自動修復ポリシーを有効にする",
    "potentialBenefits": "Boosts app availability by auto-repair",
    "tags": null,
    "recommendationResourceType": "Microsoft.Compute/virtualMachineScaleSets",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Find all VMs that do NOT have automatic repair policy enabled\nresources\n| where type == \"microsoft.compute/virtualmachinescalesets\"\n| where properties.automaticRepairsPolicy.enabled == false\n| project recommendationId = \"820f4743-1f94-e946-ae0b-45efafd87962\", name, id, tags, param1 = \"automaticRepairsPolicy: Disabled\"\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "ee66ff65-9aa3-2345-93c1-25827cf79f44",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/azure-monitor/autoscale/autoscale-get-started",
        "name": "Azure での自動スケールの使用"
      },
      {
        "url": "https://learn.microsoft.com/azure/azure-monitor/autoscale/autoscale-overview",
        "name": "Azure での自動スケーリングの概要"
      }
    ],
    "recommendationControl": "Scalability",
    "longDescription": "メトリックとスケジュールに基づいて VMSS のカスタム自動スケーリングを使用して、パフォーマンスとコスト効率を向上させ、需要の変化に応じてインスタンスを調整します。\n",
    "pgVerified": true,
    "description": "VMSS Autoscale をカスタムに構成し、スケーリング メトリックを構成する",
    "potentialBenefits": "Enhances performance and cost-efficiency",
    "tags": null,
    "recommendationResourceType": "Microsoft.Compute/virtualMachineScaleSets",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Find VMSS instances associated with autoscale settings when autoscale is disabled\nresources\n| where type == \"microsoft.compute/virtualmachinescalesets\"\n| project name, id, tags\n| join kind=leftouter  (\n    resources\n    | where type == \"microsoft.insights/autoscalesettings\"\n    | where tostring(properties.targetResourceUri) contains \"Microsoft.Compute/virtualMachineScaleSets\"\n    | project id = tostring(properties.targetResourceUri), autoscalesettings = properties\n) on id\n| where isnull(autoscalesettings) or autoscalesettings.enabled == \"false\"\n| project recommendationId = \"ee66ff65-9aa3-2345-93c1-25827cf79f44\", name, id, tags, param1 = \"autoscalesettings: Disabled\"\n| order by id asc\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "3f85a51c-e286-9f44-b4dc-51d00768696c",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/azure-monitor/autoscale/autoscale-predictive",
        "name": "Virtual Machine Scale Sets で予測自動スケーリングを使用して負荷が発生する前にスケールアウトする"
      }
    ],
    "recommendationControl": "Scalability",
    "longDescription": "予測自動スケーリングでは、機械学習を利用して、使用状況の履歴分析を通じて CPU 負荷を予測することで Azure Virtual Machine Scale Sets を効率的に管理およびスケーリングし、需要を満たすためのタイムリーなスケールアウトを保証します。\n",
    "pgVerified": true,
    "description": "予測自動スケーリングを有効にし、少なくとも「予測のみ」を構成する",
    "potentialBenefits": "Optimizes scaling with ML predictions",
    "tags": null,
    "recommendationResourceType": "Microsoft.Compute/virtualMachineScaleSets",
    "recommendationImpact": "Low",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Find VMSS instances associated with autoscale settings when predictiveAutoscalePolicy_scaleMode is disabled\nresources\n| where type == \"microsoft.compute/virtualmachinescalesets\"\n| project name, id, tags\n| join kind=leftouter  (\n    resources\n    | where type == \"microsoft.insights/autoscalesettings\"\n    | where tostring(properties.targetResourceUri) contains \"Microsoft.Compute/virtualMachineScaleSets\"\n    | project id = tostring(properties.targetResourceUri), autoscalesettings = properties\n) on id\n| where autoscalesettings.enabled == \"true\" and autoscalesettings.predictiveAutoscalePolicy.scaleMode == \"Disabled\"\n| project recommendationId = \"3f85a51c-e286-9f44-b4dc-51d00768696c\", name, id, tags, param1 = \"predictiveAutoscalePolicy_scaleMode: Disabled\"\n| order by id asc\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "b5a63aa0-c58e-244f-b8a6-cbba0560a6db",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/virtual-machine-scale-sets/virtual-machine-scale-sets-scale-in-policy",
        "name": "Azure 仮想マシン スケール セットでカスタム スケールイン ポリシーを使用する"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "Microsoft は、スケーラビリティと柔軟性を向上させるために、VMSS の可用性ゾーン間で VM インスタンスを厳密に均等に分散させないことを推奨しており、不均等な分散は、回復性の潜在的なトレードオフがあるものの、アプリケーションの負荷需要によりよく対応できる可能性があることに注意してください。\n",
    "pgVerified": true,
    "description": "スケールインとスケールアウトの失敗を避けるためにゾーン間のバランスを厳密に均等にする強制を無効にする",
    "potentialBenefits": "Improves scaling, reduces fail attempts",
    "tags": null,
    "recommendationResourceType": "Microsoft.Compute/virtualMachineScaleSets",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Find VMSS instances where strictly zoneBalance is set to True\nresources\n| where type == \"microsoft.compute/virtualmachinescalesets\"\n| where properties.orchestrationMode == \"Uniform\" and properties.zoneBalance == true\n| project recommendationId = \"b5a63aa0-c58e-244f-b8a6-cbba0560a6db\", name, id, tags, param1 = \"strictly zoneBalance: Enabled\"\n| order by id asc\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "1422c567-782c-7148-ac7c-5fc14cf45adc",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/virtual-machine-scale-sets/virtual-machine-scale-sets-use-availability-zones",
        "name": "可用性ゾーンを使用する仮想マシン スケール セットを作成する"
      },
      {
        "url": "https://learn.microsoft.com/azure/virtual-machine-scale-sets/virtual-machine-scale-sets-use-availability-zones?tabs=cli-1%2Cportal-2#update-scale-set-to-add-availability-zones",
        "name": "可用性ゾーンを追加するようにスケール セットを更新する"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "VMSS を作成するときは、データセンターの障害という稀なイベントに対するアプリケーションとデータの保護手段として可用性ゾーンを実装します。\n",
    "pgVerified": true,
    "description": "VMSS Flex を使用して可用性ゾーン全体に VMSS を展開する",
    "potentialBenefits": "Enhances disaster resilience",
    "tags": null,
    "recommendationResourceType": "Microsoft.Compute/virtualMachineScaleSets",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Find VMSS instances with one or no Zones selected\nresources\n| where type == \"microsoft.compute/virtualmachinescalesets\"\n| where array_length(zones) <= 1 or isnull(zones)\n| project recommendationId = \"1422c567-782c-7148-ac7c-5fc14cf45adc\", name, id, tags, param1 = \"AvailabilityZones: Single Zone\"\n| order by id asc\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "e4ffd7b0-ba24-c84e-9352-ba4819f908c0",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/virtual-machines/automatic-vm-guest-patching",
        "name": "Azure Virtual Machines とスケール セットのゲストの自動パッチ適用"
      },
      {
        "url": "https://learn.microsoft.com/azure/virtual-machine-scale-sets/virtual-machine-scale-sets-automatic-upgrade",
        "name": "Azure 仮想マシン スケール セットによる自動的な OS イメージのアップグレード"
      }
    ],
    "recommendationControl": "Other Best Practices",
    "longDescription": "VM ゲストの自動更新プログラムの適用を有効にすると、VM の影響範囲を制限しながら、セキュリティ コンプライアンスを維持するために仮想マシンに安全に自動的に更新プログラムを適用することで、更新管理が容易になります。\n",
    "pgVerified": true,
    "description": "パッチ オーケストレーション オプションを Azure-orchestrated に設定する",
    "potentialBenefits": "Eases patch management, enhances security",
    "tags": null,
    "recommendationResourceType": "Microsoft.Compute/virtualMachineScaleSets",
    "recommendationImpact": "Low",
    "automationAvailable": true,
    "query": "// Azure Resource Graph query\n// Identifies VMs and VMSS with manual patch settings, excluding automatic patch modes\nresources\n| where type == \"microsoft.compute/virtualmachinescalesets\"\n| join kind=inner (\n    resources\n    | where type == \"microsoft.compute/virtualmachines\"\n    | project id = tostring(properties.virtualMachineScaleSet.id), vmproperties = properties\n) on id\n| extend recommendationId = \"e4ffd7b0-ba24-c84e-9352-ba4819f908c0\", param1 = \"patchMode: Manual\", vmproperties.osProfile.linuxConfiguration.patchSettings.patchMode\n| where isnotnull(vmproperties.osProfile.linuxConfiguration) and vmproperties.osProfile.linuxConfiguration.patchSettings.patchMode !in (\"AutomaticByPlatform\", \"AutomaticByOS\")\n| distinct recommendationId, name, id, param1\n| union (resources\n| where type == \"microsoft.compute/virtualmachinescalesets\"\n| join kind=inner (\n    resources\n    | where type == \"microsoft.compute/virtualmachines\"\n    | project id = tostring(properties.virtualMachineScaleSet.id), vmproperties = properties\n) on id\n| extend recommendationId = \"e4ffd7b0-ba24-c84e-9352-ba4819f908c0\", param1 = \"patchMode: Manual\", vmproperties.osProfile.windowsConfiguration.patchSettings.patchMode\n| where isnotnull(vmproperties.osProfile.windowsConfiguration) and vmproperties.osProfile.windowsConfiguration.patchSettings.patchMode !in (\"AutomaticByPlatform\", \"AutomaticByOS\")\n| distinct recommendationId, name, id, param1)\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "83d61669-7bd6-9642-a305-175db8adcdf4",
    "recommendationTypeId": "3b739bd1-c193-4bb6-a953-1362ee3b03b2",
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/virtual-machines/deprecated-images",
        "name": "非推奨の Azure Marketplace イメージ"
      }
    ],
    "recommendationControl": "Governance",
    "longDescription": "イメージ非推奨後の中断を避けるために、現在のバージョンのイメージが使用されていることを確認してください。VM の発行元、オファー、SKU 情報を確認して、サポートされているイメージで実行されていることを確認してください。自動ゲスト パッチ適用またはイメージ アップグレードを有効にして、イメージ非推奨に関する通知を受け取ります。\n",
    "pgVerified": true,
    "description": "非推奨になる予定やすでに非推奨になっている VMSS イメージ バージョンをアップグレードする",
    "potentialBenefits": "Avoid disruptions by updating VMSS images.",
    "tags": null,
    "recommendationResourceType": "Microsoft.Compute/virtualMachineScaleSets",
    "recommendationImpact": "High",
    "automationAvailable": false,
    "query": "//cannot-be-validated-with-arg\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "273f6b30-68e0-4241-85ea-acf15ffb60bf",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/virtual-machine-scale-sets/virtual-machine-scale-sets-orchestration-modes#what-has-changed-with-flexible-orchestration-mode",
        "name": "フレキシブル オーケストレーション モードの変更点"
      },
      {
        "url": "https://learn.microsoft.com/azure/virtual-machine-scale-sets/virtual-machine-scale-sets-attach-detach-vm?branch=main&tabs=portal-1%2Cportal-2%2Cportal-3",
        "name": "仮想マシンを仮想マシン スケール セットにアタッチする、または仮想マシン スケール セットからデタッチする"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "本番 VM ワークロードは、複数の VM にデプロイし、VMSS Flex インスタンスにグループ化して、プラットフォーム全体にインテリジェントに分散し、プラットフォームの障害や更新の影響を最小限に抑える必要があります。\n",
    "pgVerified": true,
    "description": "VMSS Flex を使用して 2 つ以上の VM で運用ワークロードを実行する",
    "potentialBenefits": "Enhanced fault/update resilience",
    "tags": null,
    "recommendationResourceType": "Microsoft.Compute/virtualMachines",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Find all VMs that are not associated with a VMSS Flex instance\nresources\n| where type =~ 'Microsoft.Compute/virtualMachines'\n| where isnull(properties.virtualMachineScaleSet.id)\n| project recommendationId=\"273f6b30-68e0-4241-85ea-acf15ffb60bf\", name, id, tags\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "2bd0be95-a825-6f47-a8c6-3db1fb5eb387",
    "recommendationTypeId": "066a047a-9ace-45f4-ac50-6325840a6b00",
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/virtual-machines/create-portal-availability-zone?tabs=standard",
        "name": "Azure portal を使用して可用性ゾーン内に仮想マシンを作成する"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "各 Azure リージョン内の可用性ゾーンは、ローカルの障害に対して耐性があり、物理的に分離することで、データセンターの予期しない障害からアプリケーションとデータを保護します。\n",
    "pgVerified": true,
    "description": "可用性ゾーン間での VM のデプロイ",
    "potentialBenefits": "Enhanced VM resilience to failures",
    "tags": null,
    "recommendationResourceType": "Microsoft.Compute/virtualMachines",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Find all VMs that are not assigned to a Zone\nResources\n| where type =~ 'Microsoft.Compute/virtualMachines'\n| where isnull(zones)\n| project recommendationId=\"2bd0be95-a825-6f47-a8c6-3db1fb5eb387\", name, id, tags, param1=\"No Zone\"\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "a8d25876-7951-b646-b4e8-880c9031596b",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/virtual-machine-scale-sets/flexible-virtual-machine-scale-sets-migration-resources",
        "name": "フレキシブル オーケストレーションでデプロイとリソースを Virtual Machine Scale Sets に移行する"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "可用性セットがすぐに廃止される予定はありませんが、将来的には廃止される予定です。VM から VMSS Flex にワークロードを移行し、ゾーンをまたがる展開や、同一ゾーン内の異なる障害ドメイン (FD) にまたがる展開を行うことで、信頼性の向上を図ります。\n",
    "pgVerified": true,
    "description": "可用性セットを使用している VM を VMSS Flex に移行する",
    "potentialBenefits": "Enhances reliability and future-proofs VMs",
    "tags": null,
    "recommendationResourceType": "Microsoft.Compute/virtualMachines",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Find all VMs using Availability Sets\nresources\n| where type =~ 'Microsoft.Compute/virtualMachines'\n| where isnotnull(properties.availabilitySet)\n| project recommendationId = \"a8d25876-7951-b646-b4e8-880c9031596b\", name, id, tags, param1=strcat(\"availabilitySet: \",properties.availabilitySet.id)\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "cfe22a65-b1db-fd41-9e8e-d573922709ae",
    "recommendationTypeId": "ed651749-cd37-4fd5-9897-01b416926745",
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/architecture/checklist/resiliency-per-service#virtual-machines",
        "name": "Virtual Machines の回復性のチェックリスト"
      },
      {
        "url": "https://learn.microsoft.com/azure/site-recovery/site-recovery-test-failover-to-azure",
        "name": "Azure へのテスト フェールオーバー (ディザスター リカバリー訓練) を実行する"
      }
    ],
    "recommendationControl": "Disaster Recovery",
    "longDescription": "Site Recovery を使用して Azure VM をレプリケートするには、ターゲット リージョンへの継続的な非同期ディスク レプリケーションが必要です。復旧ポイントは数分ごとに生成され、数分単位の目標復旧ポイント (RPO) が確保されます。\n",
    "pgVerified": true,
    "description": "Azure Site Recovery を使用して VM をレプリケートする",
    "potentialBenefits": "Minimize downtime in disasters",
    "tags": null,
    "recommendationResourceType": "Microsoft.Compute/virtualMachines",
    "recommendationImpact": "Medium",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Find all VMs that do NOT have replication with ASR enabled\nresources\n| where type =~ \"Microsoft.Compute/virtualMachines\"\n| extend securityType = iif(isnull(properties.securityProfile.securityType), \"Standard\", properties.securityProfile.securityType)\n| where securityType !in~ (\"TrustedLaunch\", \"ConfidentialVM\")\n| project id, vmIdForJoin = tolower(id), name, tags\n| join kind = leftouter (\n    recoveryservicesresources\n    | where type =~ \"Microsoft.RecoveryServices/vaults/replicationFabrics/replicationProtectionContainers/replicationProtectedItems\"\n        and properties.providerSpecificDetails.dataSourceInfo.datasourceType =~ \"AzureVm\"\n    | project vmResourceId = tolower(properties.providerSpecificDetails.dataSourceInfo.resourceId)\n    )\n    on $left.vmIdForJoin == $right.vmResourceId\n| where isempty(vmResourceId)\n| project recommendationId = \"cfe22a65-b1db-fd41-9e8e-d573922709ae\", name, id, tags\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "122d11d7-b91f-8747-a562-f56b79bcfbdc",
    "recommendationTypeId": "57ecb3cd-f2b4-4cad-8b3a-232cca527a0b",
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/virtual-machines/unmanaged-disks-deprecation",
        "name": "2025 年 9 月 30 日までに Azure アンマネージド ディスクを移行してください"
      },
      {
        "url": "https://learn.microsoft.com/azure/virtual-machines/windows/convert-unmanaged-to-managed-disks",
        "name": "Windows 仮想マシンをアンマネージド ディスクからマネージド ディスクに移行する"
      },
      {
        "url": "https://learn.microsoft.com/azure/virtual-machines/linux/convert-unmanaged-to-managed-disks",
        "name": "Linux 仮想マシンをアンマネージド ディスクからマネージド ディスクに移行する"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "Azure は、2025 年 9 月 30 日にアンマネージド ディスクを廃止します。ユーザーは、中断を回避し、サービスの信頼性を維持するために、移行を計画する必要があります。\n",
    "pgVerified": true,
    "description": "VM ディスクにマネージド ディスクを使用する",
    "potentialBenefits": "Avoid retirement disruption, enhance reliability",
    "tags": null,
    "recommendationResourceType": "Microsoft.Compute/virtualMachines",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Find all VMs that are not using Managed Disks\nResources\n| where type =~ 'Microsoft.Compute/virtualMachines'\n| where isnull(properties.storageProfile.osDisk.managedDisk)\n| project recommendationId = \"122d11d7-b91f-8747-a562-f56b79bcfbdc\", name, id, tags\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "4ea2878f-0d69-8d4a-b715-afc10d1e538e",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/virtual-machines/managed-disks-overview#data-disk",
        "name": "Azure マネージド ディスクの概要 - データ ディスク"
      },
      {
        "url": "https://learn.microsoft.com/azure/virtual-machines/disks-types",
        "name": "Azure マネージド ディスクの種類"
      }
    ],
    "recommendationControl": "Scalability",
    "longDescription": "データ ディスクは、データベースやその他の重要なデータを格納するために仮想マシンに接続されたマネージド ディスクです。これらのディスクは、選択ごとにラベル付けされた SCSI ドライブです。\n",
    "pgVerified": true,
    "description": "データベース データをデータ ディスクでホストする",
    "potentialBenefits": "Enhances performance, recovery, migration flexibility",
    "tags": null,
    "recommendationResourceType": "Microsoft.Compute/virtualMachines",
    "recommendationImpact": "Low",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Find all VMs that only have OS Disk\nResources\n| where type =~ 'Microsoft.Compute/virtualMachines'\n| where array_length(properties.storageProfile.dataDisks) < 1\n| project recommendationId = \"4ea2878f-0d69-8d4a-b715-afc10d1e538e\", name, id, tags\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "1981f704-97b9-b645-9c57-33f8ded9261a",
    "recommendationTypeId": "651c7925-17a3-42e5-85cd-73bd095cf27f",
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/backup/backup-overview",
        "name": "Azure Backup サービスとは"
      }
    ],
    "recommendationControl": "Disaster Recovery",
    "longDescription": "Azure Backup を使用して仮想マシンのバックアップを有効にし、データをセキュリティで保護し、迅速に復旧します。このサービスは、Microsoft Azure クラウドからデータをバックアップおよび回復するための、シンプルで安全かつ費用対効果の高いソリューションを提供します。\n",
    "pgVerified": true,
    "description": "Azure Backup サービスを使用して VM をバックアップする",
    "potentialBenefits": "Secure data recovery and backup",
    "tags": null,
    "recommendationResourceType": "Microsoft.Compute/virtualMachines",
    "recommendationImpact": "Medium",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Find all VMs that do NOT have Backup enabled\n// Run query to see results.\nresources\n| where type =~ 'Microsoft.Compute/virtualMachines'\n| project name, id, tags\n| join kind=leftouter (\n    recoveryservicesresources\n    | where type =~ 'Microsoft.RecoveryServices/vaults/backupFabrics/protectionContainers/protectedItems'\n    | where properties.dataSourceInfo.datasourceType =~ 'Microsoft.Compute/virtualMachines'\n    | project idBackupEnabled=properties.sourceResourceId\n    | extend name=strcat_array(array_slice(split(idBackupEnabled, '/'), 8, -1), '/')\n) on name\n| where isnull(idBackupEnabled)\n| project-away idBackupEnabled\n| project-away name1\n| project recommendationId = \"1981f704-97b9-b645-9c57-33f8ded9261a\", name, id, tags\n| order by id asc\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "98b334c0-8578-6046-9e43-b6e8fce6318e",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/virtual-machines/states-billing?context=%2Ftroubleshoot%2Fazure%2Fvirtual-machines%2Fcontext%2Fcontext#power-states-and-billing",
        "name": "Azure 仮想マシンの電源の状態と課金"
      }
    ],
    "recommendationControl": "Governance",
    "longDescription": "Azure Virtual Machines (VM) インスタンスには、プロビジョニングや電源の状態など、さまざまな状態があります。実行されていない VM は、問題または不要であることを示している可能性があり、削除がコスト削減に役立つ可能性があることを示唆しています。\n",
    "pgVerified": true,
    "description": "停止状態の VM を確認する",
    "potentialBenefits": "Reduce costs by removing unused VMs",
    "tags": null,
    "recommendationResourceType": "Microsoft.Compute/virtualMachines",
    "recommendationImpact": "Low",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Find all VMs that are NOT running\nResources\n| where type =~ 'Microsoft.Compute/virtualMachines'\n| where properties.extended.instanceView.powerState.displayStatus != 'VM running'\n| project recommendationId = \"98b334c0-8578-6046-9e43-b6e8fce6318e\", name, id, tags\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "dfedbeb1-1519-fc47-86a5-52f96cf07105",
    "recommendationTypeId": "3a3c1a2a-8597-4d3a-981a-0a24a0ee9de4",
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/virtual-network/accelerated-networking-overview",
        "name": "高速ネットワークの概要"
      }
    ],
    "recommendationControl": "Scalability",
    "longDescription": "高速ネットワークにより、VM への SR-IOV が可能になり、データ パスからホストをバイパスすることでネットワーク パフォーマンスが大幅に向上し、サポートされている VM の種類で要求の厳しいネットワーク ワークロードの待機時間、ジッター、CPU 使用率が削減されます。\n",
    "pgVerified": true,
    "description": "高速ネットワーク (AccelNet) を有効化する",
    "potentialBenefits": "Reduces latency, jitter and CPU use",
    "tags": null,
    "recommendationResourceType": "Microsoft.Compute/virtualMachines",
    "recommendationImpact": "Medium",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Find all VM NICs that do not have Accelerated Networking enabled\nresources\n| where type =~ 'Microsoft.Compute/virtualMachines'\n| mv-expand nic = properties.networkProfile.networkInterfaces\n| project name, id, tags, lowerCaseNicId = tolower(nic.id), vmSize = tostring(properties.hardwareProfile.vmSize)\n| join kind = inner (\n    resources\n    | where type =~ 'Microsoft.Network/networkInterfaces'\n    | where properties.enableAcceleratedNetworking == false\n    | project nicName = split(id, \"/\")[8], lowerCaseNicId = tolower(id)\n    )\n    on lowerCaseNicId\n| summarize nicNames = make_set(nicName) by name, id, tostring(tags), vmSize\n| extend param1 = strcat(\"NicName: \", strcat_array(nicNames, \", \")), param2 = strcat(\"VMSize: \", vmSize)\n| project recommendationId = \"dfedbeb1-1519-fc47-86a5-52f96cf07105\", name, id, tags, param1, param2\n| order by id asc\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "73d1bb04-7d3e-0d47-bc0d-63afe773b5fe",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/virtual-network/accelerated-networking-overview",
        "name": "高速ネットワークの概要"
      }
    ],
    "recommendationControl": "Governance",
    "longDescription": "高速ネットワークを有効にすると、Guest OS の既定の Azure VNet インターフェイスが Mellanox に交換され、そのドライバーはサード パーティから提供されます。Marketplace イメージには最新の Mellanox ドライバーが含まれていますが、デプロイ後のドライバーの更新はユーザーの責任です。\n",
    "pgVerified": true,
    "description": "高速ネットワーク (AccelNet) が有効になっている場合は、Guest OS NIC ドライバーを手動で更新する必要がある",
    "potentialBenefits": "Enhanced VM network efficiency",
    "tags": null,
    "recommendationResourceType": "Microsoft.Compute/virtualMachines",
    "recommendationImpact": "Low",
    "automationAvailable": false,
    "query": "// cannot-be-validated-with-arg\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "1f629a30-c9d0-d241-82ee-6f2eb9d42cb4",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/load-balancer/load-balancer-outbound-connections",
        "name": "送信接続での送信元ネットワーク アドレス変換 (SNAT)を使用する"
      }
    ],
    "recommendationControl": "Security",
    "longDescription": "仮想マシンの送信インターネット接続には、より高い可用性と SNAT ポート数によって、セキュリティとサービスの回復力を強化するために、NAT Gateway や Azure Firewall を使用することを推奨します。\n",
    "pgVerified": true,
    "description": "VM にパブリック IP を直接関連付けるべきではない",
    "potentialBenefits": "Enhanced security and service resiliency",
    "tags": null,
    "recommendationResourceType": "Microsoft.Compute/virtualMachines",
    "recommendationImpact": "Medium",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Find all VMs with PublicIPs directly associated with them\nResources\n| where type =~ 'Microsoft.Compute/virtualMachines'\n| where isnotnull(properties.networkProfile.networkInterfaces)\n| mv-expand nic=properties.networkProfile.networkInterfaces\n| project name, id, tags, nicId = nic.id\n| extend nicId = tostring(nicId)\n| join kind=inner (\n    Resources\n    | where type =~ 'Microsoft.Network/networkInterfaces'\n    | where isnotnull(properties.ipConfigurations)\n    | mv-expand ipconfig=properties.ipConfigurations\n    | extend publicIp = tostring(ipconfig.properties.publicIPAddress.id)\n    | where publicIp != \"\"\n    | project name, nicId = tostring(id), publicIp\n) on nicId\n| project recommendationId = \"1f629a30-c9d0-d241-82ee-6f2eb9d42cb4\", name, id, tags\n| order by id asc\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "82b3cf6b-9ae2-2e44-b193-10793213f676",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/virtual-network/network-security-group-how-it-works#intra-subnet-traffic",
        "name": "ネットワーク セキュリティ グループによってネットワーク トラフィックをフィルター処理する方法"
      }
    ],
    "recommendationControl": "Security",
    "longDescription": "特別な理由がない限り、ネットワーク セキュリティ グループをサブネットまたはネットワーク インターフェイスに関連付けることをお勧めしますが、2 つの関連付けの間の潜在的なルール競合による予期しない通信の問題やトラブルシューティングを避けるために、両方に関連付けることはお勧めしません。\n",
    "pgVerified": true,
    "description": "VM ネットワーク インターフェイスと関連するサブネットの両方に、ネットワーク セキュリティ グループが関連付けられている",
    "potentialBenefits": "Reduces communication problems",
    "tags": null,
    "recommendationResourceType": "Microsoft.Compute/virtualMachines",
    "recommendationImpact": "Low",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Provides a list of virtual machines and associated NICs that do have an NSG associated to them and also an NSG associated to the subnet.\nResources\n| where type =~ 'Microsoft.Network/networkInterfaces'\n| where isnotnull(properties.networkSecurityGroup)\n| mv-expand ipConfigurations = properties.ipConfigurations, nsg = properties.networkSecurityGroup\n| project nicId = tostring(id), subnetId = tostring(ipConfigurations.properties.subnet.id), nsgName=split(nsg.id, '/')[8]\n| parse kind=regex subnetId with '/virtualNetworks/' virtualNetwork '/subnets/' subnet\n    | join kind=inner (\n        Resources\n        | where type =~ 'Microsoft.Network/NetworkSecurityGroups' and isnotnull(properties.subnets)\n        | project name, resourceGroup, subnet=properties.subnets\n        | mv-expand subnet\n        | project subnetId=tostring(subnet.id)\n    ) on subnetId\n    | project nicId\n| join kind=leftouter (\n    Resources\n    | where type =~ 'Microsoft.Compute/virtualMachines'\n    | where isnotnull(properties.networkProfile.networkInterfaces)\n    | mv-expand nic=properties.networkProfile.networkInterfaces\n    | project vmName = name, vmId = id, tags, nicId = nic.id, nicName=split(nic.id, '/')[8]\n    | extend nicId = tostring(nicId)\n) on nicId\n| project recommendationId = \"82b3cf6b-9ae2-2e44-b193-10793213f676\", name=vmName, id = vmId, tags, param1 = strcat(\"nic-name=\", nicName)\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "41a22a5e-5e08-9647-92d0-2ffe9ef1bdad",
    "recommendationTypeId": "c3b51c94-588b-426b-a892-24696f9e54cc",
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/virtual-network/virtual-network-network-interface?tabs=network-interface-portal#enable-or-disable-ip-forwarding",
        "name": "IP 転送の有効化と無効化"
      }
    ],
    "recommendationControl": "Security",
    "longDescription": "IP 転送は、仮想マシンのネットワーク インターフェイスが、割り当てられた IP アドレス以外のネットワーク トラフィックを送受信できるようにします。\n",
    "pgVerified": true,
    "description": "IP 転送は、ネットワーク仮想アプライアンスに対してのみ有効にする必要がある",
    "potentialBenefits": "Enhances network appliance function",
    "tags": null,
    "recommendationResourceType": "Microsoft.Compute/virtualMachines",
    "recommendationImpact": "Medium",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Find all VM NICs that have IPForwarding enabled. This feature is usually only required for Network Virtual Appliances\nResources\n| where type =~ 'Microsoft.Compute/virtualMachines'\n| where isnotnull(properties.networkProfile.networkInterfaces)\n| mv-expand nic=properties.networkProfile.networkInterfaces\n| project name, id, tags, nicId = nic.id\n| extend nicId = tostring(nicId)\n| join kind=inner (\n    Resources\n    | where type =~ 'Microsoft.Network/networkInterfaces'\n    | where properties.enableIPForwarding == true\n    | project nicId = tostring(id)\n) on nicId\n| project recommendationId = \"41a22a5e-5e08-9647-92d0-2ffe9ef1bdad\", name, id, tags\n| order by id asc\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "1cf8fe21-9593-1e4e-966b-779a294c0d30",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/virtual-network/virtual-networks-name-resolution-for-vms-and-role-instances",
        "name": "Azure 仮想ネットワーク内のリソースの名前解決"
      }
    ],
    "recommendationControl": "Other Best Practices",
    "longDescription": "環境全体での不整合を防ぐために、仮想ネットワーク レベルで DNS サーバーを構成します。\n",
    "pgVerified": true,
    "description": "顧客 DNS サーバーは、仮想ネットワーク レベルで構成する必要がある",
    "potentialBenefits": "Ensures DNS consistency",
    "tags": null,
    "recommendationResourceType": "Microsoft.Compute/virtualMachines",
    "recommendationImpact": "Low",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Find all VM NICs that have DNS Server settings configured in any of the NICs\nResources\n| where type =~ 'Microsoft.Compute/virtualMachines'\n| where isnotnull(properties.networkProfile.networkInterfaces)\n| mv-expand nic=properties.networkProfile.networkInterfaces\n| project name, id, tags, nicId = nic.id\n| extend nicId = tostring(nicId)\n| join kind=inner (\n    Resources\n    | where type =~ 'Microsoft.Network/networkInterfaces'\n    | project name, id, dnsServers = properties.dnsSettings.dnsServers\n    | extend hasDns = array_length(dnsServers) >= 1\n    | where hasDns != 0\n    | project name, nicId = tostring(id)\n) on nicId\n| project recommendationId = \"1cf8fe21-9593-1e4e-966b-779a294c0d30\", name, id, tags\n| order by id asc\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "3263a64a-c256-de48-9818-afd3cbc55c2a",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/virtual-machines/disks-shared",
        "name": "Azure 共有ディスクの概要"
      },
      {
        "url": "https://learn.microsoft.com/azure/virtual-machines/disks-shared-enable?tabs=azure-portal",
        "name": "共有ディスクを有効にする"
      }
    ],
    "recommendationControl": "Other Best Practices",
    "longDescription": "Azure 共有ディスクを使用すると、クラスター化されたアプリケーションをデプロイまたは移行するために、ディスクを同時に複数の VM に接続できます (ディスクが VM クラスター メンバー間で共有されている場合にのみ適しています)。\n",
    "pgVerified": true,
    "description": "共有ディスクは、クラスター化されたサーバーでのみ有効にする必要がある",
    "potentialBenefits": "Enhances clustered server performance",
    "tags": null,
    "recommendationResourceType": "Microsoft.Compute/virtualMachines",
    "recommendationImpact": "Medium",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Find all Disks configured to be Shared. This is not an indication of an issue, but if a disk with this configuration is assigned to two or more VMs without a proper disk control mechanism (like a WSFC) it can lead to data loss\nresources\n| where type =~ 'Microsoft.Compute/disks'\n| where isnotnull(properties.maxShares) and properties.maxShares >= 2\n| project id, name, tags, lowerCaseDiskId = tolower(id), diskState = tostring(properties.diskState)\n| join kind = leftouter (\n    resources\n    | where type =~ 'Microsoft.Compute/virtualMachines'\n    | project osDiskVmName = name, lowerCaseOsDiskId = tolower(properties.storageProfile.osDisk.managedDisk.id)\n    | join kind = fullouter (\n        resources\n        | where type =~ 'Microsoft.Compute/virtualMachines'\n        | mv-expand dataDisks = properties.storageProfile.dataDisks\n        | project dataDiskVmName = name, lowerCaseDataDiskId = tolower(dataDisks.managedDisk.id)\n        )\n        on $left.lowerCaseOsDiskId == $right.lowerCaseDataDiskId\n    | project lowerCaseDiskId = coalesce(lowerCaseOsDiskId, lowerCaseDataDiskId), vmName = coalesce(osDiskVmName, dataDiskVmName)\n    )\n    on lowerCaseDiskId\n| summarize vmNames = make_set(vmName) by name, id, tostring(tags), diskState\n| extend param1 = strcat(\"DiskState: \", diskState), param2 = iif(isempty(vmNames[0]), \"VMName: n/a\", strcat(\"VMName: \", strcat_array(vmNames, \", \")))\n| project recommendationId = \"3263a64a-c256-de48-9818-afd3cbc55c2a\", name, id, tags, param1, param2\n| order by id asc\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "70b1d2be-e6c4-b54e-9959-b1b690f9e485",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/virtual-machines/disks-enable-private-links-for-import-export-portal",
        "name": "Azure Private Link を使用してマネージド ディスクに対するインポートおよびエクスポートのアクセスを制限する"
      }
    ],
    "recommendationControl": "Security",
    "longDescription": "「パブリックアクセスを無効にし、プライベートアクセスを有効にする」に変更し、プライベート エンドポイントを作成して、直接パブリック アクセスを制限し、接続がプライベートに行われるようにすることでセキュリティを強化し、データ保護を強化し、潜在的な外部の脅威を最小限に抑えることをお勧めします。\n",
    "pgVerified": true,
    "description": "VM ディスクへのネットワーク アクセスは、「パブリック アクセスを無効にし、プライベート アクセスを有効にする」に設定する必要がある",
    "potentialBenefits": "Enhances VM security and privacy",
    "tags": null,
    "recommendationResourceType": "Microsoft.Compute/virtualMachines",
    "recommendationImpact": "Low",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Find all Disks with \"Enable public access from all networks\" enabled\nresources\n| where type =~ 'Microsoft.Compute/disks'\n| where properties.publicNetworkAccess == \"Enabled\"\n| project id, name, tags, lowerCaseDiskId = tolower(id)\n| join kind = leftouter (\n    resources\n    | where type =~ 'Microsoft.Compute/virtualMachines'\n    | project osDiskVmName = name, lowerCaseOsDiskId = tolower(properties.storageProfile.osDisk.managedDisk.id)\n    | join kind = fullouter (\n        resources\n        | where type =~ 'Microsoft.Compute/virtualMachines'\n        | mv-expand dataDisks = properties.storageProfile.dataDisks\n        | project dataDiskVmName = name, lowerCaseDataDiskId = tolower(dataDisks.managedDisk.id)\n        )\n        on $left.lowerCaseOsDiskId == $right.lowerCaseDataDiskId\n    | project lowerCaseDiskId = coalesce(lowerCaseOsDiskId, lowerCaseDataDiskId), vmName = coalesce(osDiskVmName, dataDiskVmName)\n    )\n    on lowerCaseDiskId\n| summarize vmNames = make_set(vmName) by name, id, tostring(tags)\n| extend param1 = iif(isempty(vmNames[0]), \"VMName: n/a\", strcat(\"VMName: \", strcat_array(vmNames, \", \")))\n| project recommendationId = \"70b1d2be-e6c4-b54e-9959-b1b690f9e485\", name, id, tags, param1\n| order by id asc\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "c42343ae-2712-2843-a285-3437eb0b28a1",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-principles#policy-driven-governance",
        "name": "ポリシー主導のガバナンス"
      },
      {
        "url": "https://learn.microsoft.com/azure/virtual-machines/security-policy",
        "name": "Azure 仮想マシンの Azure ポリシー規制コンプライアンス制御"
      }
    ],
    "recommendationControl": "Governance",
    "longDescription": "仮想マシン (VM) をセキュリティで保護することは、実行するアプリケーションにとって非常に重要です。これには、さまざまな Azure サービスと機能を使用して、VM への安全なアクセスとデータの安全なストレージを確保し、VM とアプリケーションの全体的なセキュリティを確保することが含まれます。\n",
    "pgVerified": true,
    "description": "VM が Azure ポリシーに準拠していることを確認する",
    "potentialBenefits": "Secure VMs and applications",
    "tags": null,
    "recommendationResourceType": "Microsoft.Compute/virtualMachines",
    "recommendationImpact": "Low",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Find all VMs in \"Non-compliant\" state with Azure Policies\npolicyresources\n| where type =~ \"Microsoft.PolicyInsights/policyStates\" and properties.resourceType =~ \"Microsoft.Compute/virtualMachines\" and properties.complianceState =~ \"NonCompliant\"\n| project\n    policyDefinitionId = tolower(properties.policyDefinitionId),\n    policyAssignmentId = tolower(properties.policyAssignmentId),\n    targetResourceId = tolower(properties.resourceId)\n// Join the policy definition details\n| join kind = leftouter (\n    policyresources\n    | where type =~ \"Microsoft.Authorization/policyDefinitions\"\n    | project policyDefinitionId = tolower(id), policyDefinitionDisplayName = properties.displayName\n    )\n    on policyDefinitionId\n| project policyDefinitionId, policyDefinitionDisplayName, policyAssignmentId, targetResourceId\n// Join the policy assignment details\n| join kind = leftouter (\n    policyresources\n    | where type =~ \"Microsoft.Authorization/policyAssignments\"\n    | project policyAssignmentId = tolower(id), policyAssignmentDisplayName = properties.displayName\n    )\n    on policyAssignmentId\n| project policyDefinitionId, policyDefinitionDisplayName, policyAssignmentId, policyAssignmentDisplayName, targetResourceId\n// Join the target resource details\n| join kind = leftouter (\n    resources\n    | where type =~ \"Microsoft.Compute/virtualMachines\"\n    | project targetResourceId = tolower(id), targetResourceIdPreservedCase = id, targetResourceName = name, targetResourceTags = tags\n    )\n    on targetResourceId\n| project\n    recommendationId = \"c42343ae-2712-2843-a285-3437eb0b28a1\",\n    name = targetResourceName,\n    id = targetResourceIdPreservedCase,\n    tags = targetResourceTags,\n    param1 = strcat(\"DefinitionName: \", policyDefinitionDisplayName),\n    param2 = strcat(\"DefinitionID: \", policyDefinitionId),\n    param3 = strcat(\"AssignmentName: \", policyAssignmentDisplayName),\n    param4 = strcat(\"AssignmentID: \", policyAssignmentId)\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "f0a97179-133a-6e4f-8a49-8a44da73ffce",
    "recommendationTypeId": "a40cc620-e72c-fdf4-c554-c6ca2cd705c0",
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/virtual-machines/disk-encryption-overview",
        "name": "マネージド ディスク暗号化オプションの概要"
      }
    ],
    "recommendationControl": "Security",
    "longDescription": "DM-Crypt (Linux) や BitLocker (Windows) を使用して Azure VM ディスクを暗号化するには、Azure Disk Encryption (ADE) を有効にすることを検討してください。さらに、データセキュリティを強化するために、ホストでの暗号化と機密ディスクの暗号化を検討してください。\n",
    "pgVerified": true,
    "description": "Virtual Machines では Azure Disk Encryption や「ホストでの暗号化」が有効になっている必要がある",
    "potentialBenefits": "Enhances data security and integrity",
    "tags": null,
    "recommendationResourceType": "Microsoft.Compute/virtualMachines",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Provides a list of Azure VM disks without Azure Disk Encryption or encryption at host enabled\nresources\n| where type =~ \"microsoft.compute/disks\"\n| project diskId = id, diskName = name, vmId = tolower(managedBy), azureDiskEncryption = iff(properties.encryptionSettingsCollection.enabled == true, true, false)\n| join kind=leftouter (resources\n| where type =~ \"microsoft.compute/virtualmachines\"\n| project vmId = tolower(id), vmName = name, encryptionAtHost = iff(properties.securityProfile.encryptionAtHost == true, true, false)) on vmId\n| where not(encryptionAtHost) and not(azureDiskEncryption)\n| project recommendationId = 'f0a97179-133a-6e4f-8a49-8a44da73ffce', name = vmName, id =vmId, param1 = strcat('diskName:',diskName), param2 = strcat('azureDiskEncryption:',iff(azureDiskEncryption, \"Enabled\", \"Disabled\")), param3 = strcat('encryptionAtHost:',iff(encryptionAtHost, \"Enabled\", \"Disabled\"))\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "b72214bb-e879-5f4b-b9cd-642db84f36f4",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/azure-monitor/vm/vminsights-overview",
        "name": "VM insights の概要"
      },
      {
        "url": "https://learn.microsoft.com/azure/azure-monitor/vm/vminsights-troubleshoot#was-the-extension-installed-properly",
        "name": "拡張機能は正しくインストールされましたか?"
      }
    ],
    "recommendationControl": "Monitoring and Alerting",
    "longDescription": "VM Insights は、VM とスケール セットのパフォーマンス、正常性、実行中のプロセス、依存関係を監視します。パフォーマンスのボトルネックとネットワークの問題を特定することで、アプリケーションのパフォーマンスと可用性の予測可能性を高め、問題が他の依存関係に関連しているかどうかを明確にします。\n",
    "pgVerified": true,
    "description": "VM Insights を有効にする",
    "potentialBenefits": "Improves VM performance and health",
    "tags": null,
    "recommendationResourceType": "Microsoft.Compute/virtualMachines",
    "recommendationImpact": "Low",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Check for VMs without Azure Monitoring Agent extension installed, missing Data Collection Rule or Data Collection Rule without performance enabled.\nResources\n| where type == 'microsoft.compute/virtualmachines'\n| project idVm = tolower(id), name, tags\n| join kind=leftouter (\n    InsightsResources\n    | where type =~ \"Microsoft.Insights/dataCollectionRuleAssociations\" and id has \"Microsoft.Compute/virtualMachines\"\n    | project idDcr = tolower(properties.dataCollectionRuleId), idVmDcr = tolower(substring(id, 0, indexof(id, \"/providers/Microsoft.Insights/dataCollectionRuleAssociations/\"))))\non $left.idVm == $right.idVmDcr\n| join kind=leftouter (\n    Resources\n    | where type =~ \"Microsoft.Insights/dataCollectionRules\"\n    | extend\n        isPerformanceEnabled = iif(properties.dataSources.performanceCounters contains \"Microsoft-InsightsMetrics\" and properties.dataFlows contains \"Microsoft-InsightsMetrics\", true, false),\n        isMapEnabled = iif(properties.dataSources.extensions contains \"Microsoft-ServiceMap\" and properties.dataSources.extensions contains \"DependencyAgent\" and properties.dataFlows contains \"Microsoft-ServiceMap\", true, false)//,\n    | where isPerformanceEnabled or isMapEnabled\n    | project dcrName = name, isPerformanceEnabled, isMapEnabled, idDcr = tolower(id))\non $left.idDcr == $right.idDcr\n| join kind=leftouter (\n    Resources\n        | where type == 'microsoft.compute/virtualmachines/extensions' and (name contains 'AzureMonitorWindowsAgent' or name contains 'AzureMonitorLinuxAgent')\n        | extend idVmExtension = tolower(substring(id, 0, indexof(id, '/extensions'))), extensionName = name)\non $left.idVm == $right.idVmExtension\n| where isPerformanceEnabled != 1 or (extensionName != 'AzureMonitorWindowsAgent' and extensionName != 'AzureMonitorLinuxAgent')\n| project recommendationId = \"b72214bb-e879-5f4b-b9cd-642db84f36f4\", name, id = idVm, tags, param1 = strcat('MonitoringExtension:', extensionName), param2 = strcat('DataCollectionRuleId:', idDcr), param3 = strcat('isPerformanceEnabled:', isPerformanceEnabled)\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "4a9d8973-6dba-0042-b3aa-07924877ebd5",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/azure-monitor/agents/agents-overview",
        "name": "Azure Monitor エージェントの概要"
      }
    ],
    "recommendationControl": "Monitoring and Alerting",
    "longDescription": "Azure Monitor メトリックはプラットフォーム メトリックを自動的に受信しますが、リソースとその Azure プラットフォームの詳細な診断と監査を提供するプラットフォーム ログは、収集のために手動でルーティングする必要があります。\n",
    "pgVerified": true,
    "description": "すべての Azure Virtual Machines の監視を構成する",
    "potentialBenefits": "Enhanced diagnostics and auditing capability",
    "tags": null,
    "recommendationResourceType": "Microsoft.Compute/virtualMachines",
    "recommendationImpact": "Low",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Find all Virtual Machines without diagnostic settings enabled/with diagnostic settings enabled but not configured both performance counters and event logs/syslogs.\nresources\n| where type =~ \"microsoft.compute/virtualmachines\"\n| project name, id, tags, lowerCaseVmId = tolower(id)\n| join kind = leftouter (\n    resources\n    | where type =~ \"Microsoft.Compute/virtualMachines/extensions\" and properties.publisher =~ \"Microsoft.Azure.Diagnostics\"\n    | project\n        lowerCaseVmIdOfExtension = tolower(substring(id, 0, indexof(id, \"/extensions/\"))),\n        extensionType = properties.type,\n        provisioningState = properties.provisioningState,\n        storageAccount = properties.settings.StorageAccount,\n        // Windows\n        wadPerfCounters = properties.settings.WadCfg.DiagnosticMonitorConfiguration.PerformanceCounters.PerformanceCounterConfiguration,\n        wadEventLogs = properties.settings.WadCfg.DiagnosticMonitorConfiguration.WindowsEventLog,\n        // Linux\n        ladPerfCounters = properties.settings.ladCfg.diagnosticMonitorConfiguration.performanceCounters.performanceCounterConfiguration,\n        ladSyslog = properties.settings.ladCfg.diagnosticMonitorConfiguration.syslogEvents\n    | extend\n        // Windows\n        isWadPerfCountersConfigured = iif(array_length(wadPerfCounters) > 0, true, false),\n        isWadEventLogsConfigured = iif(isnotnull(wadEventLogs) and array_length(wadEventLogs.DataSource) > 0, true, false),\n        // Linux\n        isLadPerfCountersConfigured = iif(array_length(ladPerfCounters) > 0, true, false),\n        isLadSyslogConfigured = isnotnull(ladSyslog)\n    | project\n        lowerCaseVmIdOfExtension,\n        extensionType,\n        provisioningState,\n        storageAccount,\n        isPerfCountersConfigured = case(extensionType =~ \"IaaSDiagnostics\", isWadPerfCountersConfigured, extensionType =~ \"LinuxDiagnostic\", isLadPerfCountersConfigured, false),\n        isEventLogsConfigured = case(extensionType =~ \"IaaSDiagnostics\", isWadEventLogsConfigured, extensionType =~ \"LinuxDiagnostic\", isLadSyslogConfigured, false)\n    )\n    on $left.lowerCaseVmId == $right.lowerCaseVmIdOfExtension\n| where isempty(lowerCaseVmIdOfExtension) or provisioningState !~ \"Succeeded\" or not(isPerfCountersConfigured and isEventLogsConfigured)\n| extend\n    param1 = strcat(\"DiagnosticSetting: \", iif(isnotnull(extensionType), strcat(\"Enabled, partially configured (\", extensionType, \")\"), \"Not enabled\")),\n    param2 = strcat(\"ProvisioningState: \", iif(isnotnull(provisioningState), provisioningState, \"n/a\")),\n    param3 = strcat(\"storageAccount: \", iif(isnotnull(storageAccount), storageAccount, \"n/a\")),\n    param4 = strcat(\"PerformanceCounters: \", case(isnull(isPerfCountersConfigured), \"n/a\", isPerfCountersConfigured, \"Configured\", \"Not configured\")),\n    param5 = strcat(\"EventLogs/Syslogs: \", case(isnull(isEventLogsConfigured), \"n/a\", isEventLogsConfigured, \"Configured\", \"Not configured\"))\n| project recommendationId = \"4a9d8973-6dba-0042-b3aa-07924877ebd5\", name, id, tags, param1, param2, param3, param4, param5\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "52ab9e5c-eec0-3148-8bd7-b6dd9e1be870",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/virtual-machines/maintenance-configurations",
        "name": "メンテナンス構成による VM の更新の管理"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "メンテナンス構成設定を使用すると、ユーザーは更新をスケジュールや管理して、VM の更新や中断が計画された期間内に実行されるようにすることができます。\n",
    "pgVerified": true,
    "description": "VM のメンテナンス構成を使用する",
    "potentialBenefits": "Scheduled updates for VMs",
    "tags": null,
    "recommendationResourceType": "Microsoft.Compute/virtualMachines",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Find VMS that do not have maintenance configuration assigned\nResources\n| extend resourceId = tolower(id)\n| project name, location, type, id, tags, resourceId, properties\n| where type =~ 'Microsoft.Compute/virtualMachines'\n| join kind=leftouter (\nmaintenanceresources\n| where type =~ \"microsoft.maintenance/configurationassignments\"\n| project planName = name, type, maintenanceProps = properties\n| extend resourceId = tostring(maintenanceProps.resourceId)\n) on resourceId\n| where isnull(maintenanceProps)\n| project recommendationId = \"52ab9e5c-eec0-3148-8bd7-b6dd9e1be870\",name, id, tags\n| order by id asc\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "3201dba8-d1da-4826-98a4-104066545170",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/virtual-machines/sizes-b-series-burstable",
        "name": "B シリーズのバースト可能なマシンのサイズ"
      }
    ],
    "recommendationControl": "Scalability",
    "longDescription": "A シリーズ VM は、開発およびテスト サーバー、低トラフィックの Web サーバー、小規模から中規模のデータベースなどのユース ケースを含む、開発やテストなどのエントリ レベルのワークロード向けに調整されています。\n",
    "pgVerified": true,
    "description": "A または B シリーズの VM を常にフル CPU パフォーマンスを必要とする運用環境に使用しない",
    "potentialBenefits": "Ensures full CPU usage for heavy tasks",
    "tags": null,
    "recommendationResourceType": "Microsoft.Compute/virtualMachines",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Find all VMs using A or B series families\nresources\n| where type == 'microsoft.compute/virtualmachines'\n| where properties.hardwareProfile.vmSize contains \"Standard_B\" or properties.hardwareProfile.vmSize contains \"Standard_A\"\n| project recommendationId = \"3201dba8-d1da-4826-98a4-104066545170\", name, id, tags, param1=strcat(\"vmSku: \" , properties.hardwareProfile.vmSize)\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "df0ff862-814d-45a3-95e4-4fad5a244ba6",
    "recommendationTypeId": "58d6648d-32e8-4346-827c-4f288dd8ca24",
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/virtual-machines/disks-types#disk-type-comparison",
        "name": "ディスクの種類の比較とデシジョン ツリー"
      }
    ],
    "recommendationControl": "Scalability",
    "longDescription": "Standard HDD や SSD と比較して、Premium SSD、Premium SSD v2、Ultra Disk では、パフォーマンスと構成可能性が向上し、単一インスタンス仮想マシンのアップタイム SLA が向上します。仮想マシン上のすべてのディスクの中で最も低い SLA が適用されるため、最高のアップタイム SLA を得るには、Premium または Ultra Disk を使用することをお勧めします。\n",
    "pgVerified": true,
    "description": "ミッション クリティカルなワークロードでは Premium または Ultra Disk の使用を検討する必要がある",
    "potentialBenefits": "Enhanced performance, cost efficiency, and uptime SLA",
    "tags": null,
    "recommendationResourceType": "Microsoft.Compute/virtualMachines",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Find all VMs that have an attached disk that is not in the Premium or Ultra sku tier.\n\nresources\n| where type =~ 'Microsoft.Compute/virtualMachines'\n| extend lname = tolower(name)\n| join kind=leftouter(resources\n    | where type =~ 'Microsoft.Compute/disks'\n    | where not(sku.tier =~ 'Premium') and not(sku.tier =~ 'Ultra')\n    | extend lname = tolower(tostring(split(managedBy, '/')[8]))\n    | project lname, name\n    | summarize disks = make_list(name) by lname) on lname\n| where isnotnull(disks)\n| project recommendationId = \"df0ff862-814d-45a3-95e4-4fad5a244ba6\", name, id, tags, param1=strcat(\"AffectedDisks: \", disks)\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "9ab499d8-8844-424d-a2d4-8f53690eb8f8",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/azure-boost/overview",
        "name": "Microsoft Azure Boost"
      },
      {
        "url": "https://aka.ms/AzureBoostGABlog",
        "name": "Announcing the general availability of Azure Boost"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "ワークロードがメンテナンスに敏感な場合は、Azure Boost 互換 VM を検討してください。Azure Boost は、ホスト上で Azure のメンテナンス アクティビティが発生した場合に、お客様への影響を軽減するように設計されています。\n",
    "pgVerified": true,
    "description": "メンテナンスの影響を受けやすいワークロードに Azure Boost VM を使用する",
    "potentialBenefits": "Less maintenance impact",
    "tags": null,
    "recommendationResourceType": "Microsoft.Compute/virtualMachines",
    "recommendationImpact": "Medium",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "2de8fa5e-14f4-4c4c-857f-1520f87a629f",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/virtual-machines/windows/scheduled-event-service",
        "name": "Azure VM のスケジュールされたイベントを監視する"
      },
      {
        "url": "https://learn.microsoft.com/azure/virtual-machines/linux/scheduled-events",
        "name": "Azure Metadata Service - Linux VM の Scheduled Events"
      },
      {
        "url": "https://learn.microsoft.com/azure/virtual-machines/windows/scheduled-events",
        "name": "Azure Metadata Service - Windows VM のScheduled Events"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "ワークロードがメンテナンスの影響を受けやすい場合は、スケジュールされたイベントを有効にします。この Azure Metadata Service を使用すると、再起動などの今後のイベントに関する情報を提供することで、アプリが仮想マシンのメンテナンスに備えることができ、中断が軽減されます。\n",
    "pgVerified": true,
    "description": "メンテナンスに敏感なワークロード VM のスケジュールされたイベントを有効にする",
    "potentialBenefits": "Minimize downtime for VMs",
    "tags": null,
    "recommendationResourceType": "Microsoft.Compute/virtualMachines",
    "recommendationImpact": "Medium",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "fa0cf4f5-0b21-47b7-89a9-ee936f193ce1",
    "recommendationTypeId": "d4102c0f-ebe3-4b22-8fe0-e488866a87af",
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/virtual-machines/disks-redundancy#zone-redundant-storage-for-managed-disks",
        "name": "マネージド ディスクの冗長性オプション"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "Azure ディスクには、ゾーン全体のダウンに対する回復性が必要なワークロードに対して、ゾーン冗長ストレージ (ZRS) オプションが用意されています。クロスゾーン データ レプリケーションのため、ZRS ディスクはローカル冗長オプション (LRS) と比較して書き込み待機時間が長くなるため、ディスクのベンチマークを必ず行ってください。\n",
    "pgVerified": true,
    "description": "Azure ディスクとゾーン冗長ストレージを使用して、回復性と可用性を高める",
    "potentialBenefits": "Enhanced Disk resilience to failures",
    "tags": null,
    "recommendationResourceType": "Microsoft.Compute/virtualMachines",
    "recommendationImpact": "Medium",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Find eligible Disks that are not zonal nor zone redundant\nresources\n| where type == 'microsoft.compute/disks'\n| where sku has \"Premium_LRS\" or sku has \"StandardSSD_LRS\"\n| where sku.name has_cs 'ZRS' or array_length(zones) > 0\n| project recommendationId=\"fa0cf4f5-0b21-47b7-89a9-ee936f193ce1\", name, id, tags, param1 = sku, param2 = sku.name\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "302fda08-ee65-4fbe-a916-6dc0b33169c4",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/virtual-machines/capacity-reservation-overview",
        "name": "オンデマンド容量予約"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "Azure 容量予約 は、特定のリージョンまたは可用性ゾーン内でコンピューティング容量を事前に予約することで、仮想マシンの高可用性を確保します。これにより、需要のピーク時やメンテナンス時に VM に必要なリソースが確保され、信頼性とアップタイムが向上します。\n",
    "pgVerified": false,
    "description": "重要なワークロードのためにコンピューティング容量を予約する",
    "potentialBenefits": "Guaranteed capacity in constrained regions/zones",
    "tags": null,
    "recommendationResourceType": "Microsoft.Compute/virtualMachines",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Find all Virtual Machines not associated with a Capacity Reservation, and provide details for Capacity Reservation like vmSize, location, and zone.\nresources\n| where type =~ 'Microsoft.Compute/virtualMachines'\n| where isnull(properties.capacityReservation)\n| extend zoneValue = iff(isnull(zones), \"null\", zones)\n| project recommendationId = \"302fda08-ee65-4fbe-a916-6dc0b33169c4\", name, id, tags, param1 = strcat(\"VmSize: \", properties.hardwareProfile.vmSize), param2 = strcat(\"Location: \", location), param3 = strcat(\"Zone: \", zoneValue)\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "5f7e8a12-3c4f-456b-919c-2e9adff98c38",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/virtual-machines/extensions/update-linux-agent?tabs=ubuntu",
        "name": "VM で Azure Linux エージェントを更新する方法"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "Azure Linux エージェントをインストールしてある場合、または動作保証済みのディストリビューション イメージを使用している場合は、エージェントのバージョンが最新であることを確認してください。Linux ディストリビューションによっては、自動更新が無効になっていたり、古いバージョンのエージェントが使用されていたりすることがあります。\n",
    "pgVerified": false,
    "description": "Azure Linux VM エージェントを更新する",
    "potentialBenefits": "Reduces complications with VM provisioning",
    "tags": null,
    "recommendationResourceType": "Microsoft.Compute/virtualMachines",
    "recommendationImpact": "Low",
    "automationAvailable": false,
    "query": "// under-development\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "b49a39fd-f431-4b61-9062-f2157849d845",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/virtual-machines/azure-compute-gallery#best-practices",
        "name": "Compute Gallery のベスト プラクティス"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "Azure Compute Gallery に運用イメージ用に少なくとも 3 つのレプリカを保持すると、スケーラビリティが確保され、VM デプロイを異なるレプリカに分散することで、マルチ VM デプロイでの調整が防止されます。これにより、1 つのレプリカが過負荷になるリスクが軽減されます。\n",
    "pgVerified": true,
    "description": "本番イメージ バージョン用に少なくとも 3 つのレプリカを保持する必要がある",
    "potentialBenefits": "Enhances scalability and avoids throttling",
    "tags": null,
    "recommendationResourceType": "Microsoft.Compute/galleries",
    "recommendationImpact": "Medium",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Query to list all image versions,its associated image name and version replica configurations per region in a compute gallery whose version replicas is less than 3\nresources\n| where type =~ \"microsoft.compute/galleries/images/versions\"\n| extend GalleryName = tostring(split(tostring(id), \"/\")[8]), ImageName = tostring(split(tostring(id), \"/\")[10])\n| mv-expand VersionReplicas = properties.publishingProfile.targetRegions\n| project RecommendationId=\"b49a39fd-f431-4b61-9062-f2157849d845\",name,id,tags,param1=strcat(\"GalleryName: \",GalleryName),param2=strcat(\"ImageName: \",ImageName),param3=strcat(\"VersionReplicaRegionName: \",VersionReplicas.name),param4=strcat(\"VersionReplicationCount: \",VersionReplicas.regionalReplicaCount),rc=toint(VersionReplicas.regionalReplicaCount)\n| where rc < 3\n| project-away rc\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "488dcc8b-f2e3-40ce-bf95-73deb2db095f",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/virtual-machines/azure-compute-gallery#best-practices",
        "name": "Compute Gallery のベスト プラクティス"
      },
      {
        "url": "https://learn.microsoft.com/azure/storage/common/storage-redundancy#zone-redundant-storage",
        "name": "ゾーン冗長ストレージ"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "Azure Compute Gallery でイメージ/VM バージョンを作成するときは、高可用性のために ZRS を使用し、可用性ゾーンの障害に対する回復性を提供します。ZRS アカウントは、可用性ゾーンのあるリージョンで推奨され、これらのリージョンでは Standard_LRS よりも推奨される Standard_ZRS を選択できます。\n",
    "pgVerified": true,
    "description": "ゾーン冗長ストレージをイメージ バージョンに使用する必要がある",
    "potentialBenefits": "Enhances image version availability",
    "tags": null,
    "recommendationResourceType": "Microsoft.Compute/galleries",
    "recommendationImpact": "Medium",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Query to list all image versions and its associated image and gallery name whose Storage account type is not using ZRS\nresources\n| where type =~ \"microsoft.compute/galleries/images/versions\"\n| extend GalleryName = tostring(split(tostring(id), \"/\")[8]), ImageName = tostring(split(tostring(id), \"/\")[10])\n| extend StorageAccountType = tostring(properties.publishingProfile.storageAccountType)\n| where StorageAccountType !has \"ZRS\"\n| project RecommendationId=\"488dcc8b-f2e3-40ce-bf95-73deb2db095f\",name,id,tags,param1=strcat(\"GalleryName: \",GalleryName),param2=strcat(\"ImageName: \",ImageName),param3=strcat(\"StorageAccountType: \",StorageAccountType)\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "1c5e1e58-4e56-491c-8529-10f37af9d4ed",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/virtual-machines/azure-compute-gallery#best-practices",
        "name": "Compute Gallery のベスト プラクティス"
      },
      {
        "url": "https://learn.microsoft.com/windows-server/virtualization/hyper-v/plan/should-i-create-a-generation-1-or-2-virtual-machine-in-hyper-v",
        "name": "Hyper-V での第 1 世代 vs 第 2 世代"
      },
      {
        "url": "https://learn.microsoft.com/azure/virtual-machines/shared-image-galleries?tabs=azure-cli",
        "name": "Azure Compute Gallery におけるイメージ"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "セキュア ブート、vTPM、トラステッド起動 VM、大容量ブート ボリュームなどのメリットを得るために、トラステッド起動対応イメージを作成することをお勧めします。これらは既定で Gen 2 イメージであり、作成後に VM の世代を変更することはできないため、最初に考慮事項を確認してください。\n",
    "pgVerified": true,
    "description": "可能な場合は、トラステッド起動対応イメージの作成を検討する",
    "potentialBenefits": "Enhances VM security and features",
    "tags": null,
    "recommendationResourceType": "Microsoft.Compute/galleries",
    "recommendationImpact": "Low",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Query to list all images whose Hyper-V generation is not V2\nresources\n| where type =~ \"microsoft.compute/galleries/images\"\n| extend VMGeneration = properties.hyperVGeneration\n| where VMGeneration <> 'V2'\n| project RecommendationId=\"1c5e1e58-4e56-491c-8529-10f37af9d4ed\",name,id,tags,param1=strcat(\"VMGeneration: \",VMGeneration)\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "74fcb9f2-9a25-49a6-8c42-d32851c4afb7",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/azure-vmware/eslz-management-and-monitoring#design-recommendations",
        "name": "Azure Service Health アラートを構成する"
      }
    ],
    "recommendationControl": "Monitoring and Alerting",
    "longDescription": "Azure Service Health 通知が、使用されているすべてのリージョンとサブスクリプションで Azure VMware Solution に設定されていることを確認します。これにより、サービス/セキュリティの問題と、ホストの交換やアップグレードなどのメンテナンス アクティビティが伝達され、サービス リクエストの送信が削減されます。\n",
    "pgVerified": true,
    "description": "Azure VMware Solution の Azure Service Health 通知とアラートを構成する",
    "potentialBenefits": "Prompt mitigation of issues.",
    "tags": null,
    "recommendationResourceType": "Microsoft.AVS/privateClouds",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Provides a list of Azure VMware Solution resources that don't have one or more service health alerts covering AVS private clouds in the deployed subscription and region pairs.\n//full list of private clouds\n(resources\n| where ['type'] == \"microsoft.avs/privateclouds\"\n| extend locale = tolower(location)\n| extend subscriptionId = tolower(subscriptionId)\n| project id, name, tags, subscriptionId, locale)\n| join kind=leftouter\n//Alert ID's that include all incident types filtered by AVS Service Health alerts\n((resources\n| where type == \"microsoft.insights/activitylogalerts\"\n| extend alertproperties = todynamic(properties)\n| where alertproperties.condition.allOf[0].field == \"category\" and alertproperties.condition.allOf[0].equals == \"ServiceHealth\"\n| where alertproperties.condition.allOf[1].field == \"properties.impactedServices[*].ServiceName\" and set_has_element(alertproperties.condition.allOf[1].containsAny, \"Azure VMware Solution\")\n| extend locale = strcat_array(split(tolower(alertproperties.condition.allOf[2].containsAny),' '), '')\n| mv-expand todynamic(locale)\n| where locale != \"global\"\n| project subscriptionId, tostring(locale) )\n| union\n//Alert ID's that include only some of the incident types after filtering by service health alerts covering AVS private clouds.\n(resources\n| where type == \"microsoft.insights/activitylogalerts\"\n| extend subscriptionId = tolower(subscriptionId)\n| extend alertproperties = todynamic(properties)\n| where alertproperties.condition.allOf[0].field == \"category\" and alertproperties.condition.allOf[0].equals == \"ServiceHealth\"\n| where alertproperties.condition.allOf[2].field == \"properties.impactedServices[*].ServiceName\" and set_has_element(alertproperties.condition.allOf[2].containsAny, \"Azure VMware Solution\")\n| extend locale = strcat_array(split(tolower(alertproperties.condition.allOf[3].containsAny),' '), '')\n| mv-expand todynamic(locale)\n| mv-expand alertproperties.condition.allOf[1].anyOf\n| extend incidentType = alertproperties_condition_allOf_1_anyOf.equals\n| where locale != \"global\"\n| project id, subscriptionId, locale, incidentType\n| distinct subscriptionId, tostring(locale), tostring(incidentType)\n| summarize incidentTypes=count() by subscriptionId, locale\n| where incidentTypes == 5 //only include this subscription, region pair if it includes all the incident types.\n| project subscriptionId, locale)) on subscriptionId, locale\n| where subscriptionId1 == \"\" or locale1 == \"\" or isnull(subscriptionId1) or isnull(locale1)\n| project recommendationId = \"74fcb9f2-9a25-49a6-8c42-d32851c4afb7\", name, id, tags, param1 = \"avsServiceHealthAlertsAllIncidentTypesConfigured: False\"\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "29d7a115-dfb6-4df1-9205-04824109548f",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/well-architected/azure-vmware/monitoring#configure-and-streamline-alerts",
        "name": "アラートの構成と合理化"
      }
    ],
    "recommendationControl": "Monitoring and Alerting",
    "longDescription": "Azure VMware Solution プライベート クラウドのノード数が 90 ホストに達したとき、またはそれを超えたときのアラートを設定し、新しいプライベート クラウドのタイムリーな計画を可能にします。\n",
    "pgVerified": true,
    "description": "Azure VMware Solution プライベート クラウドが容量制限に達しているタイミングを監視する",
    "potentialBenefits": "Proactive capacity planning",
    "tags": null,
    "recommendationResourceType": "Microsoft.AVS/privateClouds",
    "recommendationImpact": "Medium",
    "automationAvailable": false,
    "query": "// cannot-be-validated-with-arg\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "f86355e3-de7c-4dad-8080-1b0b411e66c8",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/well-architected/azure-vmware/monitoring#configure-and-streamline-alerts",
        "name": "アラートの構成と合理化"
      }
    ],
    "recommendationControl": "Monitoring and Alerting",
    "longDescription": "クラスター サイズが 14 ホストに達したときにアラートを出します。特にストレージ ニーズの増加による新しいクラスターやデータストアを計画するための定期的なアラートを設定します。ホスト数が 14 を超えると、新しいホストが追加されるたびにアラートがトリガーされ、プロアクティブなリソース監視が可能になります。\n",
    "pgVerified": true,
    "description": "Azure VMware Solution クラスター サイズがホストの制限に近づいているタイミングを監視する",
    "potentialBenefits": "Proactive resource management",
    "tags": null,
    "recommendationResourceType": "Microsoft.AVS/privateClouds",
    "recommendationImpact": "Medium",
    "automationAvailable": false,
    "query": "// cannot-be-validated-with-arg\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "9ec5b4c8-3dd8-473a-86ee-3273290331b9",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/well-architected/azure-vmware/infrastructure#implement-high-availability",
        "name": "高可用性を実装する"
      },
      {
        "url": "https://learn.microsoft.com/azure/azure-vmware/deploy-vsan-stretched-clusters",
        "name": "ストレッチ クラスター"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "Azure VMware Solution の場合、ストレッチ クラスターを有効にすると、99.99% の SLA、同期ストレージ レプリケーション (RPO = 0) が提供され、vSAN データストアが 2 つの AZ に分散されます。初期設定時に行う必要があり、AZ 間での拡張のために二重のクォータが必要です。\n",
    "pgVerified": true,
    "description": "ストレッチ クラスターを有効にして、vSAN データストアのマルチ AZ 可用性を実現する",
    "potentialBenefits": "99.99% SLA, 0 RPO, Multi-AZ",
    "tags": null,
    "recommendationResourceType": "Microsoft.AVS/privateClouds",
    "recommendationImpact": "Low",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Provides a list of Azure VMware Solution resources that aren't configured as stretched clusters and in supported regions.\nresources\n| where ['type'] == \"microsoft.avs/privateclouds\"\n| extend avsproperties = todynamic(properties)\n| where avsproperties.availability.strategy != \"DualZone\"\n| where location in (\"uksouth\", \"westeurope\", \"germanywestcentral\", \"australiaeast\")\n| project recommendationId = \"9ec5b4c8-3dd8-473a-86ee-3273290331b9\", name, id, tags, param1 = \"stretchClusters: Disabled\"\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "4232eb32-3241-4049-9e14-9b8005817b56",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/azure-vmware/configure-alerts-for-azure-vmware-solution#supported-metrics-and-activities",
        "name": "サポートされているメトリックとアクティビティ"
      }
    ],
    "recommendationControl": "Monitoring and Alerting",
    "longDescription": "ストレージ使用率を監視し、70% と 75% の使用率でアラートを設定してキャパシティ プランニングを可能にすることで、VMware vSAN データストアのスラック領域が SLA 用に維持されるようにします。拡張するには、CPU と RAM の要件が満たされている場合は、ホストや外部ストレージ (Azure Elastic SAN、Azure NetApp Files など) を追加します。\n",
    "pgVerified": true,
    "description": "vSAN データストア使用率の Azure Monitor アラートで警告しきい値を構成する",
    "potentialBenefits": "Optimized capacity planning for vSAN",
    "tags": null,
    "recommendationResourceType": "Microsoft.AVS/privateClouds",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Provides a list of Azure VMware Solution resources that don't have a vSAN capacity critical alert with a threshold of 75% or a warning capacity of 70%.\n(\nresources\n| where ['type'] == \"microsoft.avs/privateclouds\"\n| extend scopeId = tolower(tostring(id))\n| project ['scopeId'], name, id, tags\n| join kind=leftouter (\nresources\n| where type == \"microsoft.insights/metricalerts\"\n| extend alertProperties = todynamic(properties)\n| mv-expand alertProperties.scopes\n| mv-expand alertProperties.criteria.allOf\n| extend scopeId = tolower(tostring(alertProperties_scopes))\n| extend metric = alertProperties_criteria_allOf.metricName\n| extend threshold = alertProperties_criteria_allOf.threshold\n| project scopeId, tostring(metric), toint(['threshold'])\n| where metric == \"DiskUsedPercentage\"\n| where threshold == 75\n) on scopeId\n| where isnull(['threshold'])\n| project recommendationId = \"4232eb32-3241-4049-9e14-9b8005817b56\", name, id, tags, param1 = \"vsanCapacityCriticalAlert: isNull or threshold != 75\"\n)\n| union (\nresources\n| where ['type'] == \"microsoft.avs/privateclouds\"\n| extend scopeId = tolower(tostring(id))\n| project ['scopeId'], name, id, tags\n| join kind=leftouter (\nresources\n| where type == \"microsoft.insights/metricalerts\"\n| extend alertProperties = todynamic(properties)\n| mv-expand alertProperties.scopes\n| mv-expand alertProperties.criteria.allOf\n| extend scopeId = tolower(tostring(alertProperties_scopes))\n| extend metric = alertProperties_criteria_allOf.metricName\n| extend threshold = alertProperties_criteria_allOf.threshold\n| project scopeId, tostring(metric), toint(['threshold'])\n| where metric == \"DiskUsedPercentage\"\n| where threshold == 70\n) on scopeId\n| where isnull(['threshold'])\n| project recommendationId = \"4232eb32-3241-4049-9e14-9b8005817b56\", name, id, tags, param1 = \"vsanCapacityWarningAlert: isNull or threshold != 70\"\n)\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "fa4ab927-bced-429a-971a-53350de7f14b",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/well-architected/azure-vmware/monitoring#manage-logs-and-archives",
        "name": "ログとアーカイブを管理する"
      }
    ],
    "recommendationControl": "Monitoring and Alerting",
    "longDescription": "各プライベート クラウドに対して診断設定が構成され、分析やアーカイブのために外部ソースに syslog が送信されていることを確認します。Azure VMware Solution Syslog には、トラブルシューティングとパフォーマンスのためのデータが含まれており、問題の迅速な解決と問題の早期検出に役立ちます。\n",
    "pgVerified": true,
    "description": "Azure VMware Solution の診断設定で Syslog を構成する",
    "potentialBenefits": "Faster issue resolution, early detection",
    "tags": null,
    "recommendationResourceType": "Microsoft.AVS/privateClouds",
    "recommendationImpact": "High",
    "automationAvailable": false,
    "query": "// cannot-be-validated-with-arg\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "4ee5d535-c47b-470a-9557-4a3dd297d62f",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/well-architected/azure-vmware/monitoring#configure-and-streamline-alerts",
        "name": "アラートの構成と合理化"
      }
    ],
    "recommendationControl": "Monitoring and Alerting",
    "longDescription": "動的なワークロード リソース管理に vSphere DRS と HA を利用する Azure VMware Solution で、ホスト リソースの枯渇を回避するために十分なコンピューティング リソースを確保します。ただし、CPU 使用率が 95% を超えると、CPU の準備時間が長くなり、ワークロードに影響を与える可能性があります。\n",
    "pgVerified": true,
    "description": "CPU 使用率を監視して、ワークロードに十分なリソースを確保する",
    "potentialBenefits": "Avoids resource exhaustion, optimizes performance",
    "tags": null,
    "recommendationResourceType": "Microsoft.AVS/privateClouds",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Provides a list of Azure VMware Solution resources that don't have a Cluster CPU capacity critical alert with a threshold of 95%.\nresources\n| where ['type'] == \"microsoft.avs/privateclouds\"\n| extend scopeId = tolower(tostring(id))\n| project ['scopeId'], name, id, tags\n| join kind=leftouter (\nresources\n| where type == \"microsoft.insights/metricalerts\"\n| extend alertProperties = todynamic(properties)\n| mv-expand alertProperties.scopes\n| mv-expand alertProperties.criteria.allOf\n| extend scopeId = tolower(tostring(alertProperties_scopes))\n| extend metric = alertProperties_criteria_allOf.metricName\n| extend threshold = alertProperties_criteria_allOf.threshold\n| project scopeId, tostring(metric), toint(['threshold'])\n| where metric == \"EffectiveCpuAverage\"\n| where threshold == 95\n) on scopeId\n| where isnull(['threshold'])\n| project recommendationId = \"4ee5d535-c47b-470a-9557-4a3dd297d62f\", name, id, tags, param1 = \"hostCpuCriticalAlert: isNull or threshold != 95\"\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "029208c8-5186-4a76-8ee8-6e3445fef4dd",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/well-architected/azure-vmware/monitoring#configure-and-streamline-alerts",
        "name": "アラートの構成と合理化"
      }
    ],
    "recommendationControl": "Monitoring and Alerting",
    "longDescription": "Azure VMware Solution でのホスト リソースの枯渇を防ぐために、十分なメモリ リソースを確保します。動的なワークロード管理には、vSphere DRS と vSphere HA を使用します。しかし、95%を超える継続的なメモリ使用量はディスクスワッピングにつながり、ワークロードに影響を与えます。\n",
    "pgVerified": true,
    "description": "メモリ使用率を監視して、ワークロードに十分なリソースを確保する",
    "potentialBenefits": "Avoids host exhaustion and swapping",
    "tags": null,
    "recommendationResourceType": "Microsoft.AVS/privateClouds",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Provides a list of Azure VMware Solution resources that don't have a cluster host memory critical alert with a threshold of 95%.\nresources\n| where ['type'] == \"microsoft.avs/privateclouds\"\n| extend scopeId = tolower(tostring(id))\n| project ['scopeId'], name, id, tags\n| join kind=leftouter (\nresources\n| where type == \"microsoft.insights/metricalerts\"\n| extend alertProperties = todynamic(properties)\n| mv-expand alertProperties.scopes\n| mv-expand alertProperties.criteria.allOf\n| extend scopeId = tolower(tostring(alertProperties_scopes))\n| extend metric = alertProperties_criteria_allOf.metricName\n| extend threshold = alertProperties_criteria_allOf.threshold\n| project scopeId, tostring(metric), toint(['threshold'])\n| where metric == \"UsageAverage\"\n| where threshold == 95\n) on scopeId\n| where isnull(['threshold'])\n| project recommendationId = \"029208c8-5186-4a76-8ee8-6e3445fef4dd\", name, id, tags, param1 = \"hostMemoryCriticalAlert: isNull or threshold != 95\"\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "a5ef7c05-c611-4842-9af5-11efdc99123a",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/azure-resource-manager/management/lock-resources",
        "name": "リソースをロックしてインフラストラクチャを保護する"
      }
    ],
    "recommendationControl": "Governance",
    "longDescription": "Azure VMware Solution プライベート クラウド リソース グループにリソース削除ロックを適用すると、共同作成者アクセス権を持つユーザーによる承認されていない削除や偶発的な削除が防止され、Azure VMware Solution プライベート クラウドの保護と信頼性が確保されます。\n",
    "pgVerified": true,
    "description": "プライベート クラウドをホストしているリソース グループに対してリソース削除ロックを適用する",
    "potentialBenefits": "Prevents accidental deletion",
    "tags": null,
    "recommendationResourceType": "Microsoft.AVS/privateClouds",
    "recommendationImpact": "High",
    "automationAvailable": false,
    "query": "// cannot-be-validated-with-arg\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "e0ac2f57-c8c0-4b8c-a7c8-19e5797828b5",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/azure-vmware/configure-customer-managed-keys?tabs=azure-portal",
        "name": "カスタマー マネージド キーを構成する"
      }
    ],
    "recommendationControl": "Security",
    "longDescription": "vSAN データストアの暗号化にカスタマー マネージド キーを使用する場合は、Azure Key Vault を一元管理に利用し、プライベート クラウドにリンクされたマネージド ID を介してアクセスすることをお勧めします。これらのキーの有効期限が切れると、vSAN データストアとそれに関連するワークロードにアクセスできなくなる可能性があります。\n",
    "pgVerified": true,
    "description": "vSAN データストアのカスタマー マネージド キーにキーの自動ローテーションを使用する",
    "potentialBenefits": "Avoid outages with key auto-rotation",
    "tags": null,
    "recommendationResourceType": "Microsoft.AVS/privateClouds",
    "recommendationImpact": "High",
    "automationAvailable": false,
    "query": "// cannot-be-validated-with-arg\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "fcc2e257-23af-4c68-aac8-9cc03033c939",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/azure-vmware/configure-dns-azure-vmware-solution#configure-dns-forwarder",
        "name": "DNS フォワーダーを構成する"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "Azure VMware Solution プライベート クラウドでは、1 つの FQDN に対して最大 3 つの DNS サーバーがサポートされるため、1 つの DNS サーバーが障害点になるのを防ぎます。各プライベート クラウドからのオンプレミスの FQDN 解決には、複数の DNS サーバーを使用することが重要です。\n",
    "pgVerified": true,
    "description": "プライベート FQDN ゾーンごとに複数の DNS サーバーを使用する",
    "potentialBenefits": "Enhances reliability and avoids failure",
    "tags": null,
    "recommendationResourceType": "Microsoft.AVS/privateClouds",
    "recommendationImpact": "High",
    "automationAvailable": false,
    "query": "// cannot-be-validated-with-arg\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "e48a7227-5ec7-463a-b955-ee7cb598ded4",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/stream-analytics/cluster-overview",
        "name": "Azure Stream Analytics クラスターの概要"
      }
    ],
    "recommendationControl": "Scalability",
    "longDescription": "Stream Analytics クラスター (専用) は、より信頼性の高いパフォーマンス保証を提供します。クラスター上で実行されるジョブはすべてお客様のものです。また、プライベート エンドポイント、自動スケーリング、VNet サポートなどの重要な機能も利用できます。\n",
    "pgVerified": false,
    "description": "専用の Stream Analytics クラスターでジョブを実行し、信頼性とセキュリティを向上させる",
    "potentialBenefits": "Enhanced reliability and security",
    "tags": null,
    "recommendationResourceType": "Microsoft.StreamAnalytics/streamingjobs",
    "recommendationImpact": "Medium",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Find all Azure Stream Analytics jobs that are not associated with a dedicated cluster\nresources\n| where type =~ \"Microsoft.StreamAnalytics/streamingjobs\"\n| where isnull(properties.cluster.id)\n| project recommendationId = \"e48a7227-5ec7-463a-b955-ee7cb598ded4\", name, id, tags\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "5d40d3d4-179d-4cf5-ac24-901210f512e7",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/stream-analytics/stream-analytics-streaming-unit-consumption",
        "name": "Stream Analytics ストリーミング ユニットの理解と調整"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "負荷、メトリック、スケジュールに基づいて、割り当てられたストリーミング ユニット (SU) の数をジョブが動的に変更できるように、自動スケールを構成します。\n",
    "pgVerified": false,
    "description": "Stream Analytics ジョブを StandardV2 SKU に移行する",
    "potentialBenefits": "Enhanced reliability and security",
    "tags": null,
    "recommendationResourceType": "Microsoft.StreamAnalytics/streamingjobs",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Find all Azure Stream Analytics jobs that are not using the latest version of the service.\nresources\n| where type =~ \"Microsoft.StreamAnalytics/streamingjobs\"\n| where properties.sku.name !~ \"StandardV2\"\n| project recommendationId = \"5d40d3d4-179d-4cf5-ac24-901210f512e7\", name, id, tags\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "84636c6c-b317-4722-b603-7b1ffc16384b",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/event-hubs/event-hubs-geo-dr?tabs=portal#availability-zones",
        "name": "Azure Event Hubs - geo ディザスター リカバリー"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "Azure portal を使用すると、ゾーン冗長が自動的に有効になります。ただし、一部のコードとしてのインフラストラクチャ (IaC) ツールでは、これを既定で false にしている場合があります。可用性ゾーン内のデータ センター間でメタデータとイベントを確実にレプリケートするには、ゾーン冗長が有効になっていることを常に確認してください。\n",
    "pgVerified": true,
    "description": "サポートされているリージョンでゾーン冗長が有効になっていることを確認する",
    "potentialBenefits": "Enhanced fault tolerance for Event Hub",
    "tags": null,
    "recommendationResourceType": "Microsoft.EventHub/namespaces",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": null
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "fbfef3df-04a5-41b2-a8fd-b8541eb04956",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/event-hubs/event-hubs-auto-inflate",
        "name": "Azure Event Hubs のスループット ユニットを自動的にスケールアップする"
      }
    ],
    "recommendationControl": "Scalability",
    "longDescription": "Event Hub Standard レベルの名前空間で自動インフレを有効にすると、スループット ユニット (TU) が自動的にスケールアップされ、使用量のニーズを満たし、許可されたレートに調整することでデータのイングレスやエグレスのスロットリング シナリオが防止されます。\n",
    "pgVerified": true,
    "description": "Event Hub Standard レベルで自動インフレを有効にする",
    "potentialBenefits": "Prevents throttling by autoscaling TUs",
    "tags": null,
    "recommendationResourceType": "Microsoft.EventHub/namespaces",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Find Event Hub namespace instances that are Standard tier and do not have Auto Inflate enabled\nresources\n| where type == \"microsoft.eventhub/namespaces\"\n| where sku.tier == \"Standard\"\n| where properties.isAutoInflateEnabled == \"false\"\n| project recommendationId = \"fbfef3df-04a5-41b2-a8fd-b8541eb04956\", name, id, tags, param1 = \"AutoInflateEnabled: False\"\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "499769ae-67c9-492e-9ca5-cfd4cece5209",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/virtual-desktop/autoscale-scaling-plan?tabs=portal",
        "name": "Create and assign an autoscale scaling plan"
      }
    ],
    "recommendationControl": "Scalability",
    "longDescription": "各リージョンには、そのリージョン内のホスト プールに割り当てられた独自のスケーリング プランがあります。ただし、これらのプランはリージョン的な障害が発生した場合にアクセスできなくなる可能性があります。このリスクを軽減するために別のリージョンでセカンダリ スケーリング プランを作成することをお勧めします。\n",
    "pgVerified": true,
    "description": "スケーリング プランはリージョンごとに作成するべきであり、リージョンをまたいでスケーリングするべきではない",
    "potentialBenefits": "Enhanced scaling",
    "tags": null,
    "recommendationResourceType": "Microsoft.DesktopVirtualization/scalingPlans",
    "recommendationImpact": "Medium",
    "automationAvailable": false,
    "query": "// under-development\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "013ac34e-7c4b-425f-9e0c-216f0cc06181",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/virtual-desktop/configure-validation-environment?tabs=azure-portal",
        "name": "検証環境としてホスト プールを構成する"
      }
    ],
    "recommendationControl": "Governance",
    "longDescription": "計画された AVD の更新で問題を早期に検出するための検証プールを作成します。必要に応じて制限を調整します。より多くのユーザーのために複数のホスト プールを追加することでスケーリングします。ホスト プールの更新プログラムを定期的にテストします。メイン環境に適用する前に変更を検証して、ダウンタイムを回避します。\n",
    "pgVerified": true,
    "description": "計画された更新プログラムをテストするための検証ホスト プールを作成する",
    "potentialBenefits": "Enhanced environment stability",
    "tags": null,
    "recommendationResourceType": "Microsoft.DesktopVirtualization/hostPools",
    "recommendationImpact": "Medium",
    "automationAvailable": false,
    "query": "// under-development\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "979ff8be-5f3a-4d8e-9aa3-407ecdd6d6f7",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/virtual-desktop/scheduled-agent-updates",
        "name": "Azure Virtual Desktop ホスト プールのスケジュール化されたエージェントの更新"
      }
    ],
    "recommendationControl": "Governance",
    "longDescription": "AVD エージェントの更新のメンテナンス スケジュールを作成して、中断を回避します。スケジュールされたエージェントの更新を使用して、Azure Virtual Desktop エージェント、サイド バイ サイド スタック、Geneva Monitoring エージェントを更新するためのメンテナンス期間を設定します。\n",
    "pgVerified": true,
    "description": "ホスト プールのスケジュールされたエージェントの更新を構成する",
    "potentialBenefits": "Enhanced environment stability",
    "tags": null,
    "recommendationResourceType": "Microsoft.DesktopVirtualization/hostPools",
    "recommendationImpact": "Medium",
    "automationAvailable": false,
    "query": "// Azure Resource Graph Query\n// This resource graph query will return all AVD host pools that does not have scheduled agent updates configured\nresources\n| where type =~ \"Microsoft.DesktopVirtualization/hostpools\"\n| where isnull(properties.agentUpdate)\n| project recommendationId = \"979ff8be-5f3a-4d8e-9aa3-407ecdd6d6f7\", name, id, tags, param1 = 'No scheduled agent updates'\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "939cb85c-102a-4e0a-ab82-5c92116d3778",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/windows-server/identity/ad-ds/deploy/virtual-dc/adds-on-azure-vm#configure-the-vms-and-install-active-directory-domain-services",
        "name": "VM を構成し、Active Directory Domain Services をインストールする"
      }
    ],
    "recommendationControl": "Governance",
    "longDescription": "AVD 構成を最適化するには、ハイブリッド VM を一意の OU に配置します。環境固有の設定のために本番ユニットと DR ユニットを分離します。これにより、FSLogix、タイムアウト、セッション制御など、セッション ホストのターゲット設定が確実になります。\n",
    "pgVerified": true,
    "description": "ドメインに参加しているセッション ホストを含むホスト プールを展開するときに一意の OU が使用されていることを確認する",
    "potentialBenefits": "Improved AVD hostpool config & segmentation",
    "tags": null,
    "recommendationResourceType": "Microsoft.DesktopVirtualization/hostPools",
    "recommendationImpact": "Medium",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "38721758-2cc2-4d6b-b7b7-8b47dadbf7df",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/site-recovery/site-recovery-overview",
        "name": "Site Recovery について"
      }
    ],
    "recommendationControl": "Disaster Recovery",
    "longDescription": "個人用ホスト プールに Azure Site Recovery (ASR) や Azure Backup を実装して、シームレスなフェールオーバーとフェールバックを有効にします。これにより、個人用デスクトップをサポートする VM がセカンダリ Azure リージョンにレプリケートされ、障害や停止が発生した場合に既知の状態から確実に回復できます。\n",
    "pgVerified": true,
    "description": "Azure Site Recovery やバックアップを使用して、個人用デスクトップをサポートする VM を保護する",
    "potentialBenefits": "Ensures VM recovery & failover",
    "tags": null,
    "recommendationResourceType": "Microsoft.Compute/virtualMachines",
    "recommendationImpact": "Medium",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "9437634c-d69e-2747-b13e-631c13182150",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/architecture/guide/technology-choices/load-balancing-overview",
        "name": "負荷分散のオプション"
      },
      {
        "url": "https://learn.microsoft.com/azure/traffic-manager/traffic-manager-overview",
        "name": "Azure Traffic Manager"
      },
      {
        "url": "https://learn.microsoft.com/azure/frontdoor/front-door-overview",
        "name": "Azure Front Door"
      },
      {
        "url": "https://learn.microsoft.com/azure/architecture/guide/networking/global-web-applications/mission-critical-content-delivery",
        "name": "ミッション クリティカルなグローバル コンテンツ配信"
      }
    ],
    "recommendationControl": "Business Continuity",
    "longDescription": "ほとんどのソリューションでは、コンテンツ キャッシュ、CDN、TLS 終端、WAF には Azure Front Door を選択するか、単純なグローバル負荷分散には Traffic Manager を選択します。\n",
    "pgVerified": true,
    "description": "Traffic Manager と Front Door の組み合わせを避ける",
    "potentialBenefits": "Optimized network routing and security",
    "tags": null,
    "recommendationResourceType": "Microsoft.Cdn/profiles",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Avoid combining Traffic Manager and Front Door\nresources\n| where type == \"microsoft.network/trafficmanagerprofiles\"\n| mvexpand(properties.endpoints)\n| extend endpoint=tostring(properties_endpoints.properties.target)\n| project name, trafficmanager=id, matchname=endpoint, tags\n| join (\n    resources\n    | where type =~ \"microsoft.cdn/profiles/afdendpoints\"\n    | extend matchname= tostring(properties.hostName)\n    | extend splitid=split(id, \"/\")\n    | extend frontdoorid=tolower(strcat_array(array_slice(splitid, 0, 8), \"/\"))\n    | project name, id, matchname, frontdoorid, type\n    | union\n        (cdnresources\n        | where type =~ \"Microsoft.Cdn/Profiles/CustomDomains\"\n        | extend matchname= tostring(properties.hostName)\n        | extend splitid=split(id, \"/\")\n        | extend frontdoorid=tolower(strcat_array(array_slice(splitid, 0, 8), \"/\"))\n        | project name, id, matchname, frontdoorid, type)\n    )\n    on matchname\n| project\n    recommendationId = \"9437634c-d69e-2747-b13e-631c13182150\",\n    name=split(trafficmanager, \"/\")[-1],\n    id=trafficmanager,\n    tags,\n    param1=strcat(\"hostname:\", matchname),\n    param2=strcat(\"frontdoorid:\", frontdoorid)\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "6c40b7ae-2bea-5748-be1a-9e9e3b834649",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/frontdoor/origin-security?tabs=app-service-functions&pivots=front-door-standard-premium",
        "name": "Azure Front Door の配信元へのトラフィックをセキュリティで保護する"
      }
    ],
    "recommendationControl": "Security",
    "longDescription": "Front Door の機能は、トラフィックが Front Door のみを通過する場合に最適に実行されます。Front Door をバイパスするトラフィックへのアクセスを拒否するように配信元を設定することをお勧めします。\n",
    "pgVerified": true,
    "description": "配信元へのトラフィックを制限する",
    "potentialBenefits": "Enhances security and performance",
    "tags": null,
    "recommendationResourceType": "Microsoft.Cdn/profiles",
    "recommendationImpact": "High",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "52bc9a7b-23c8-bc4c-9d2a-7bc43b50104a",
    "recommendationTypeId": "e607041e-3194-42ad-9994-b6ea5ec12f5e",
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/rest/api/frontdoor/",
        "name": "REST API Reference"
      },
      {
        "url": "https://learn.microsoft.com/java/api/overview/azure/resourcemanager-frontdoor-readme?view=azure-java-preview",
        "name": "Client library for Java"
      },
      {
        "url": "https://learn.microsoft.com/python/api/overview/azure/front-door?view=azure-python",
        "name": "SDK for Python"
      }
    ],
    "recommendationControl": "Scalability",
    "longDescription": "API、ARM テンプレート、Bicep または SDK を使用して Azure Front Door を操作する場合は、最新の API または SDK バージョンを使用することが重要です。アップデートにより、新機能、重要なセキュリティパッチ、バグ修正がもたらされます。\n",
    "pgVerified": true,
    "description": "最新の API バージョンと SDK バージョンを使用する",
    "potentialBenefits": "Enhanced security and features",
    "tags": null,
    "recommendationResourceType": "Microsoft.Cdn/profiles",
    "recommendationImpact": "Medium",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "1ad74c3c-e3d7-0046-b83f-a2199974ef15",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/frontdoor/front-door-diagnostics?pivots=front-door-standard-premium",
        "name": "Azure Front Door でのメトリックとログの監視"
      },
      {
        "url": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-monitor?pivots=front-door-standard-premium#waf-logs",
        "name": "WAF ログ"
      },
      {
        "url": "https://learn.microsoft.com/azure/frontdoor/standard-premium/how-to-logs",
        "name": "Azure Front Door ログを構成する"
      }
    ],
    "recommendationControl": "Monitoring and Alerting",
    "longDescription": "Front Door ログは、各要求に関する包括的なテレメトリを提供し、特にキャッシュが有効になっている場合は、配信元サーバーがすべての要求を受信するとは限らないため、ソリューションのパフォーマンスと応答を理解するために重要です。\n",
    "pgVerified": true,
    "description": "ログを構成する",
    "potentialBenefits": "Enhanced insights and solution monitoring",
    "tags": null,
    "recommendationResourceType": "Microsoft.Cdn/profiles",
    "recommendationImpact": "Medium",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "d9bd6780-0d6f-cd4c-bc66-8ddcab12f3d1",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/frontdoor/end-to-end-tls?pivots=front-door-standard-premium",
        "name": "Azure Front Door を使用したエンド ツー エンド TLS"
      }
    ],
    "recommendationControl": "Security",
    "longDescription": "Front Door は、クライアントからの TCP 接続と TLS 接続を終了し、各 PoP から配信元への新しい接続を確立します。これらの接続を TLS でセキュリティ保護すると、Azure でホストされている配信元であっても、転送中にデータが常に暗号化されます。\n",
    "pgVerified": true,
    "description": "エンドツーエンドの TLS を使用する",
    "potentialBenefits": "Ensures data encryption in transit",
    "tags": null,
    "recommendationResourceType": "Microsoft.Cdn/profiles",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Use end-to-end TLS\ncdnresources\n| where type == \"microsoft.cdn/profiles/afdendpoints/routes\"\n| extend forwardingProtocol=tostring(properties.forwardingProtocol),supportedProtocols=properties.supportedProtocols\n| project id,name,forwardingProtocol,supportedProtocols,tags\n| where forwardingProtocol !~ \"httpsonly\" or supportedProtocols has \"http\"\n| project recommendationId= \"d9bd6780-0d6f-cd4c-bc66-8ddcab12f3d1\", name,id,tags,param1=strcat(\"forwardingProtocol:\",forwardingProtocol),param2=strcat(\"supportedProtocols:\",supportedProtocols)\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "24ab9f11-a3e4-3043-a985-22cf94c4933a",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/frontdoor/front-door-how-to-redirect-https#create-http-to-https-redirect-rule",
        "name": "HTTP から HTTPS へのリダイレクト ルールの作成"
      }
    ],
    "recommendationControl": "Security",
    "longDescription": "HTTPS の使用は、安全な接続に最適です。ただし、古いクライアントとの互換性のために、HTTP 要求が必要になる場合があります。Azure Front Door を使用すると、HTTP から HTTPS への自動リダイレクトが可能になり、アクセシビリティを犠牲にすることなくセキュリティが強化されます。\n",
    "pgVerified": true,
    "description": "HTTP から HTTPS へのリダイレクトを使用する",
    "potentialBenefits": "Enhances security and compliance",
    "tags": null,
    "recommendationResourceType": "Microsoft.Cdn/profiles",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Use HTTP to HTTPS redirection\ncdnresources\n| where type == \"microsoft.cdn/profiles/afdendpoints/routes\"\n| extend httpsRedirect=tostring(properties.httpsRedirect)\n| project id,name,httpsRedirect,tags\n| where httpsRedirect !~ \"enabled\"\n| project recommendationId= \"24ab9f11-a3e4-3043-a985-22cf94c4933a\", name,id,tags,param1=strcat(\"httpsRedirect:\",httpsRedirect)\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "29d65c41-2fad-d142-95eb-9eab95f6c0a5",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/frontdoor/standard-premium/how-to-configure-https-custom-domain?tabs=powershell",
        "name": "Azure portal を使用して Azure Front Door カスタム ドメインで HTTPS を構成する"
      }
    ],
    "recommendationControl": "Security",
    "longDescription": "Front Door で TLS 証明書を管理すると、運用コストが削減され、証明書の更新を忘れることによるコストのかかる停止を回避できます。Front Door は、マネージド TLS 証明書を自動的に発行し、ローテーションします。\n",
    "pgVerified": true,
    "description": "マネージド TLS 証明書を使用する",
    "potentialBenefits": "Lowers costs, avoids outages",
    "tags": null,
    "recommendationResourceType": "Microsoft.Cdn/profiles",
    "recommendationImpact": "High",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "4638c2c0-03de-6d42-9e09-82ee4478cbf3",
    "recommendationTypeId": "2c057605-4707-4d3e-bbb0-a7fe9b6a626b",
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/frontdoor/standard-premium/how-to-configure-https-custom-domain?tabs=powershell#select-the-certificate-for-azure-front-door-to-deploy",
        "name": "デプロイする Azure Front Door の証明書を選択する"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "独自の TLS 証明書を使用する場合は、Key Vault 証明書のバージョンを \"最新\" に設定して、新しい証明書バージョン用に Azure Front Door を再構成し、Front Door の環境全体でのデプロイを待機しないようにします。\n",
    "pgVerified": true,
    "description": "カスタマー マネージド証明書に最新バージョンを使用する",
    "potentialBenefits": "Saves time and automates TLS updates",
    "tags": null,
    "recommendationResourceType": "Microsoft.Cdn/profiles",
    "recommendationImpact": "Medium",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "cd6a32af-747a-e649-82a7-a98f528ca842",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/architecture/best-practices/host-name-preservation",
        "name": "リバース プロキシとそのバックエンド Web アプリケーションの間で、元の HTTP ホスト名を維持する"
      }
    ],
    "recommendationControl": "Governance",
    "longDescription": "Front Door では、1 つの配信元にルーティングするカスタム ドメイン名のホスト ヘッダーを書き換えることができるため、Front Door と配信元の両方でカスタム ドメイン構成を回避するのに役立ちます。\n",
    "pgVerified": true,
    "description": "Front Door と配信元で同じドメイン名を使用する",
    "potentialBenefits": "Improves session/auth handling",
    "tags": null,
    "recommendationResourceType": "Microsoft.Cdn/profiles",
    "recommendationImpact": "Medium",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "1bd2b7e8-400f-e64a-99a2-c572f7b08a62",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/frontdoor/web-application-firewall",
        "name": "Azure Front Door 上の Web アプリケーション ファイアウォール (WAF)"
      }
    ],
    "recommendationControl": "Security",
    "longDescription": "インターネットに接続するアプリケーションの場合、Microsoft マネージド ルールを使用してさまざまな攻撃から保護するために、Front Door Web アプリケーション ファイアウォール (WAF) を有効にし、マネージド ルールを使用するように構成することをお勧めします。\n",
    "pgVerified": true,
    "description": "WAF を有効にする",
    "potentialBenefits": "Enhances web app security",
    "tags": null,
    "recommendationResourceType": "Microsoft.Cdn/profiles",
    "recommendationImpact": "Medium",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Enable the WAF\n\nresources\n| where type =~ \"microsoft.cdn/profiles\" and sku has \"AzureFrontDoor\"\n| project name, cdnprofileid=tolower(id), tostring(tags), resourceGroup, subscriptionId,skuname=tostring(sku.name)\n| join kind= fullouter (\n    cdnresources\n    | where type == \"microsoft.cdn/profiles/securitypolicies\"\n    | extend wafpolicyid=tostring(properties['parameters']['wafPolicy']['id'])\n    | extend splitid=split(id, \"/\")\n    | extend cdnprofileid=tolower(strcat_array(array_slice(splitid, 0, 8), \"/\"))\n    | project secpolname=name, cdnprofileid, wafpolicyid\n    )\n    on cdnprofileid\n| project name, cdnprofileid, secpolname, wafpolicyid,skuname\n| join kind = fullouter (\n    resources\n    | where type == \"microsoft.network/frontdoorwebapplicationfirewallpolicies\"\n    | extend\n        managedrulesenabled=iff(tostring(properties.managedRules.managedRuleSets) != \"[]\", true, false),\n        enabledState = tostring(properties.policySettings.enabledState)\n    | project afdwafname=name, managedrulesenabled, wafpolicyid=id, enabledState, tostring(tags)\n    )\n    on wafpolicyid\n| where name != \"\"\n| summarize\n    associatedsecuritypolicies=countif(secpolname != \"\"),\n    wafswithmanagedrules=countif(managedrulesenabled == 1)\n    by name, id=cdnprofileid, tags,skuname\n| where associatedsecuritypolicies == 0 or wafswithmanagedrules  == 0\n| project\n    recommendationId = \"1bd2b7e8-400f-e64a-99a2-c572f7b08a62\",\n    name,\n    id,\n    todynamic(tags),\n    param1 = strcat(\"associatedsecuritypolicies:\", associatedsecuritypolicies),\n    param2 = strcat(\"wafswithmanagedrules:\", wafswithmanagedrules),\n    param3 = strcat(\"skuname:\",skuname)\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "38f3d542-6de6-a44b-86c6-97e3be690281",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/frontdoor/health-probes",
        "name": "正常性プローブ"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "Front Door 正常性プローブは、使用できない配信元や異常な配信元を検出し、必要に応じてトラフィックを代替配信元に転送するのに役立ちます。\n",
    "pgVerified": true,
    "description": "配信元グループに配信元が 1 つしかない場合は正常性プローブを無効化する",
    "potentialBenefits": "Reduces unnecessary origin traffic",
    "tags": null,
    "recommendationResourceType": "Microsoft.Cdn/profiles",
    "recommendationImpact": "Low",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Disable health probes when there is only one origin in an origin group\ncdnresources\n| where type =~ \"microsoft.cdn/profiles/origingroups\"\n| extend healthprobe=tostring(properties.healthProbeSettings)\n| project origingroupname=name, id, tags, resourceGroup, subscriptionId, healthprobe\n| join (\n    cdnresources\n    | where type =~ \"microsoft.cdn/profiles/origingroups/Origins\"\n    | extend origingroupname = tostring(properties.originGroupName)\n    )\n    on origingroupname\n| summarize origincount=count(), enabledhealthprobecount=countif(healthprobe != \"\") by origingroupname, id, tostring(tags), resourceGroup, subscriptionId\n| where origincount == 1 and enabledhealthprobecount != 0\n| project\n    recommendationId = \"38f3d542-6de6-a44b-86c6-97e3be690281\",\n    name=origingroupname,\n    id,\n    todynamic(tags),\n    param1 = strcat(\"origincount:\", origincount),\n    param2 = strcat(\"enabledhealthprobecount:\", enabledhealthprobecount)\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "5225bba3-28ec-1e43-8986-7eedfd466d65",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/architecture/patterns/health-endpoint-monitoring",
        "name": "正常性エンドポイントの監視パターン"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "Azure Front Door の正常性プローブのエンドポイントとして、正常性監視用に特別に設計された Web ページや場所を選択することを検討してください。これには、アプリケーション サーバー、データベース、キャッシュなどの重要なコンポーネントのステータスが含まれ、本番トラフィックを効率的に処理する必要があります。\n",
    "pgVerified": true,
    "description": "適切な正常性プローブ エンドポイントを選択する",
    "potentialBenefits": "Improves traffic routing and uptime",
    "tags": null,
    "recommendationResourceType": "Microsoft.Cdn/profiles",
    "recommendationImpact": "Medium",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "5783defe-b49e-d947-84f7-d8677593f324",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/frontdoor/health-probes#supported-http-methods-for-health-probes",
        "name": "正常性プローブでサポートされている HTTP メソッド"
      }
    ],
    "recommendationControl": "Scalability",
    "longDescription": "Azure Front Door の正常性プローブでは、GET や HEAD HTTP メソッドを使用できます。正常性プローブに HEAD メソッドを使用すると、配信元のトラフィック負荷が軽減され、リソースの消費が少なくなるため、推奨される方法です。\n",
    "pgVerified": true,
    "description": "HEAD 正常性プローブを使用する",
    "potentialBenefits": "Reduces traffic load on origins",
    "tags": null,
    "recommendationResourceType": "Microsoft.Cdn/profiles",
    "recommendationImpact": "Medium",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "b515690d-3bf9-3a49-8d38-188e0fd45896",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-geo-filtering",
        "name": "Geo フィルター WAF ポリシー - GeoMatch"
      }
    ],
    "recommendationControl": "Security",
    "longDescription": "WAF を介した Azure Front Door の geo フィルタリングを使用すると、国/地域ごとにカスタム アクセス規則を定義して、Web アプリへのアクセスを制限または許可できます。\n",
    "pgVerified": true,
    "description": "Azure Front Door で geo フィルタリングを使用する",
    "potentialBenefits": "Enhanced regional access control",
    "tags": null,
    "recommendationResourceType": "Microsoft.Cdn/profiles",
    "recommendationImpact": "Medium",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "1cfe7834-56ec-ff41-b11d-993734705dba",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/frontdoor/private-link",
        "name": "Azure Front Door の Private link"
      }
    ],
    "recommendationControl": "Security",
    "longDescription": "Azure Private Link を使用すると、仮想ネットワーク内のプライベート エンドポイント経由で Azure PaaS とサービスに安全にアクセスでき、トラフィックがパブリック インターネットではなく Microsoft のバックボーン ネットワークを経由します。\n",
    "pgVerified": true,
    "description": "Azure Front Door の Private Link を使用して配信元をセキュリティで保護する",
    "potentialBenefits": "Enhanced security and private connectivity",
    "tags": null,
    "recommendationResourceType": "Microsoft.Cdn/profiles",
    "recommendationImpact": "Medium",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "82fa3cff-74bd-4063-b726-834f160592fa",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/frontdoor/understanding-pricing",
        "name": "Azure Front Door レベル間の価格を比較する"
      }
    ],
    "recommendationControl": "Service Upgrade and Retirement",
    "longDescription": "Azure Front Door Standard は、AFD クラシックより最大 45% 安く、さらに多くの利点があります。また、クラシックは 2027 年 3 月 31 日にリタイア予定です。\n",
    "pgVerified": false,
    "description": "クラシック Azure Front Door の使用を避ける",
    "potentialBenefits": "Costs savings and additional supported features",
    "tags": null,
    "recommendationResourceType": "Microsoft.Cdn/profiles",
    "recommendationImpact": "High",
    "automationAvailable": false,
    "query": "//under-development\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "20057905-262c-49fe-a9be-49f423afb359",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/ja-jp/azure/well-architected/services/messaging/service-bus/reliability",
        "name": "Service Bus and reliability"
      },
      {
        "url": "https://learn.microsoft.com/ja-jp/azure/service-bus-messaging/service-bus-geo-dr#availability-zones",
        "name": "Azure Service Bus Geo-disaster recovery"
      },
      {
        "url": "https://learn.microsoft.com/ja-jp/azure/service-bus-messaging/service-bus-outages-disasters",
        "name": "Insulate Azure Service Bus applications against outages and disasters"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "可用性ゾーンは、新しい名前空間では既定で有効になります。既存の名前空間も可用性ゾーンに移行されます。可用性ゾーンが有効な場合でも、プロパティ zoneRedundant は false と表示される場合があります。\n",
    "pgVerified": false,
    "description": "Service Bus 名前空間の可用性ゾーンを有効にする",
    "potentialBenefits": "Enhances fault tolerance and uptime",
    "tags": null,
    "recommendationResourceType": "Microsoft.ServiceBus/namespaces",
    "recommendationImpact": "High",
    "automationAvailable": false,
    "query": "// cannot-be-validated-with-arg\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "d810e3a8-600f-4be1-895b-1a93e61d37fd",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/service-bus-messaging/automate-update-messaging-units",
        "name": "Service Bus auto-scaling"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "Service Bus と自動スケールを使用して高可用性を実現します。Premium SKU では自動スケーリングがサポートされており、負荷に基づいてリソースが自動的にスケーリングされます。\n",
    "pgVerified": false,
    "description": "Service Bus 名前空間での運用ワークロードの自動スケーリングを有効にする",
    "potentialBenefits": "Ensures high availability and performance",
    "tags": null,
    "recommendationResourceType": "Microsoft.ServiceBus/namespaces",
    "recommendationImpact": "High",
    "automationAvailable": false,
    "query": "// cannot-be-validated-with-arg\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "8dbcd94b-0948-4df3-b608-1946726c3abf",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/container-apps/health-probes?tabs=arm-template",
        "name": "Azure Container Apps の正常性プローブ"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "コンテナーの正常性プローブを有効にして、コンテナー アプリの正常性を監視し、異常なコンテナーが自動的に再起動されるようにします。\n",
    "pgVerified": false,
    "description": "コンテナーの正常性プローブを有効にする",
    "potentialBenefits": "Enhanced availability and resilience",
    "tags": null,
    "recommendationResourceType": "Microsoft.App/containerApps",
    "recommendationImpact": "High",
    "automationAvailable": false,
    "query": "// cannot-be-validated-with-arg\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "f4201965-a88d-449d-b3b4-021394719eb2",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/reliability/reliability-azure-container-apps",
        "name": "Azure Container Apps の信頼性"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "可用性ゾーンを利用するには、Container Apps 環境を作成するときにゾーン冗長を有効にする必要があります。環境には、使用可能なサブネットを持つ仮想ネットワークが含まれている必要があります。レプリカを適切に分散するには、アプリの最小レプリカ数を 3 に設定します。\n",
    "pgVerified": false,
    "description": "ゾーン冗長コンテナー アプリ環境をデプロイする",
    "potentialBenefits": "Enhances app resiliency and reliability",
    "tags": null,
    "recommendationResourceType": "Microsoft.App/managedenvironments",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// The query filters the qualified Container app environments that do not have Zone Redundancy enabled.\nresources\n| where type =~ \"microsoft.app/managedenvironments\"\n| where tobool(properties.zoneRedundant) == false\n| project recommendationId = \"f4201965-a88d-449d-b3b4-021394719eb2\", name, id, tags, param1 = \"AvailabilityZones: Single Zone\"\n| order by id asc\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "f8f834a9-c761-4e84-b2cb-ac55494d0c37",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/azure-sql/managed-instance/high-availability-sla-local-zone-redundancy?view=azuresql-mi#zone-redundant-availability",
        "name": "ゾーン冗長による高可用性"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "既定では、Azure SQL Database Premium 層は、同じリージョン内で複数のコピーを持ちます。地理的な冗長性を確保するために、データベースをゾーン冗長として設定し、Azure 可用性ゾーンにコピーを分散させることで、リージョン障害時の可用性を維持することができます。\n",
    "pgVerified": false,
    "description": "Azure SQL Managed Instance のゾーン冗長性を有効にし、高可用性と回復力を実現する",
    "potentialBenefits": "Enhanced availability and reliability",
    "tags": null,
    "recommendationResourceType": "Microsoft.Sql/managedInstances",
    "recommendationImpact": "High",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "15e2712c-f3ea-4a8d-9081-11e822b1ccfb",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/azure-sql/managed-instance/automated-backups-overview?view=azuresql-mi&preserve-view=true#backup-storage-redundancy",
        "name": "バックアップ ストレージの冗長性"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "これは、プライマリ リージョン内の 3 つの Azure 可用性ゾーンに同期的にバックアップをコピーします。Geo を選択すると、セカンダリ リージョンにさらに 3 つのコピーが作成されます。\n",
    "pgVerified": false,
    "description": "ゾーン冗長化や Geo ゾーン冗長化を使用してバックアップ ストレージを冗長化する",
    "potentialBenefits": "Enhanced availability and reliability",
    "tags": null,
    "recommendationResourceType": "Microsoft.Sql/managedInstances",
    "recommendationImpact": "High",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "c14de326-2729-4be7-a91f-4ea185d24b10",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/azure-sql/managed-instance/connection-types-overview?view=azuresql#connection-types",
        "name": "接続の種類"
      }
    ],
    "recommendationControl": "Scalability",
    "longDescription": "リダイレクト モードでは、インスタンスへの直接接続が可能になり、レイテンシとスループットが向上します。リダイレクト モードは VNet ローカル エンドポイントにのみ適用され、パブリック エンドポイントは常にプロキシ接続モードで処理されます。\n",
    "pgVerified": false,
    "description": "アプリケーションのアクセスを高速化するためにリダイレクトの接続の種類を使用する",
    "potentialBenefits": "Improved latency and throughput",
    "tags": null,
    "recommendationResourceType": "Microsoft.Sql/managedInstances",
    "recommendationImpact": "Medium",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "257cd903-700f-4a79-bd37-7dce2b511df4",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/azure-sql/managed-instance/failover-group-sql-mi?view=azuresql",
        "name": "フェールオーバー グループの概要とベスト プラクティス"
      }
    ],
    "recommendationControl": "Disaster Recovery",
    "longDescription": "障害がマネージド インスタンス内の 1 つ以上のデータベースに影響を与えた場合、インスタンス内のすべてのデータベースをセカンダリ リージョンに手動、または自動でフェールオーバーできます。\n",
    "pgVerified": false,
    "description": "セカンダリ インスタンスとフェールオーバー グループを構成して、別のリージョンへのフェールオーバーを可能にする",
    "potentialBenefits": "Ensure seamless service with cross-region failover",
    "tags": null,
    "recommendationResourceType": "Microsoft.Sql/managedInstances",
    "recommendationImpact": "High",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "c9afeb1e-e706-4809-be4e-75d9fac708f2",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://techcommunity.microsoft.com/t5/azure-sql/monitoring-options-available-for-azure-sql-managed-instance/ba-p/1065416",
        "name": "Azure SQL Managed Instance monitoring options"
      }
    ],
    "recommendationControl": "Monitoring and Alerting",
    "longDescription": "監視とアラートは、データベース運用の重要な要素です。Azure SQL Database を使用する際は、Azure Monitor と SQL Insights を活用して、関連するデータベース メトリックを確実に取得します。\n",
    "pgVerified": false,
    "description": "Azure SQL MI Managed Instance をほぼリアルタイムで監視し、信頼性インシデントを検出する",
    "potentialBenefits": "Quick incident detection and response",
    "tags": null,
    "recommendationResourceType": "Microsoft.Sql/servers",
    "recommendationImpact": "Medium",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "9fad5392-b852-4807-9b6d-3f700ff9771a",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/azure-sql/database/always-encrypted-landing?view=azuresql",
        "name": "Always Encrypted"
      }
    ],
    "recommendationControl": "Disaster Recovery",
    "longDescription": "Always Encrypted 構成に関連する暗号化キーを格納するために、Azure Key Vault (AKV) を使用することを強く推奨しますが、必須ではありません。AKV を使用しない場合は、キーが適切にバックアップされ、安全な方法で格納されていることを確認します。\n",
    "pgVerified": false,
    "description": "キーをバックアップする",
    "potentialBenefits": "Enhanced security and data recovery",
    "tags": null,
    "recommendationResourceType": "Microsoft.Sql/servers",
    "recommendationImpact": "Medium",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "74c2491d-048b-0041-a140-935960220e20",
    "recommendationTypeId": "2ea11bcb-dfd0-48dc-96f0-beba578b989a",
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/ja-jp/azure/azure-sql/database/active-geo-replication-overview",
        "name": "Active Geo Replication"
      }
    ],
    "recommendationControl": "Disaster Recovery",
    "longDescription": "アクティブ geo レプリケーションは、読み取り可能なセカンダリ データベース レプリカを利用することで、ビジネス継続性を確保します。プライマリ データベースに障害が発生した場合は、セカンダリ データベースに手動でフェールオーバーします。セカンダリ (最大 4 つ) は、読み取り専用アクセスに使用される同じリージョンまたは異なるリージョンに配置できます。\n",
    "pgVerified": true,
    "description": "アクティブ geo レプリケーションを使用して、別のリージョンに読み取り可能なセカンダリを作成する",
    "potentialBenefits": "Enhanced disaster recovery and read scalability",
    "tags": null,
    "recommendationResourceType": "Microsoft.Sql/servers",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Provides a list of SQL databases that are not part of Geo Replication.\nresources\n| where type == \"microsoft.sql/servers/databases\"\n| summarize secondaryTypeCount = countif(isnotempty(properties.secondaryType)) by name\n| where secondaryTypeCount == 0\n| join kind=inner (\n    Resources\n    | where type == \"microsoft.sql/servers/databases\"\n) on name\n| extend param1 = \"Not part of Geo Replication\"\n| project recommendationId = \"74c2491d-048b-0041-a140-935960220e20\", name, id, tags, param1\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "943c168a-2ec2-a94c-8015-85732a1b4859",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/ja-jp/azure/azure-sql/database/auto-failover-group-overview?tabs=azure-powershell",
        "name": "AutoFailover Groups"
      },
      {
        "url": "https://learn.microsoft.com/ja-jp/azure/azure-sql/database/designing-cloud-solutions-for-disaster-recovery",
        "name": "DR Design"
      }
    ],
    "recommendationControl": "Disaster Recovery",
    "longDescription": "フェールオーバー グループは、ある論理サーバー上のデータベースが別のリージョンの論理サーバーにレプリケートされるように構成することで、障害復旧を容易にします。これにより、geo レプリケートされたデータベース管理が合理化され、プライマリ サーバーに障害が発生した場合にレプリケートされたデータベースへの接続ルーティングのための単一のエンドポイントが提供されます。\n",
    "pgVerified": true,
    "description": "自動フェールオーバー グループには、通常同じアプリで使用される 1 つまたは複数のデータベースを含めることができる",
    "potentialBenefits": "Improves load balancing and disaster recovery",
    "tags": null,
    "recommendationResourceType": "Microsoft.Sql/servers",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Provides a list of SQL databases that are not configured to use a failover-group.\nresources\n| where type =~'microsoft.sql/servers/databases'\n| where isnull(properties['failoverGroupId'])\n| project recommendationId = \"943c168a-2ec2-a94c-8015-85732a1b4859\", name, id, tags, param1= strcat(\"databaseId=\", properties['databaseId'])\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "c0085c32-84c0-c247-bfa9-e70977cbf108",
    "recommendationTypeId": "807e58d0-e385-41ad-987b-4a4b3e3fb563",
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/ja-jp/azure/azure-sql/database/high-availability-sla",
        "name": "Zone Redundant Databases"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "既定では、Azure SQL Database Premium レベルでは、同じリージョン内に複数のコピーがプロビジョニングされます。geo 冗長性の場合、データベースをゾーン冗長として設定し、Azure 可用性ゾーン間でコピーを分散して、リージョンの停止中の可用性を維持できます。\n",
    "pgVerified": true,
    "description": "Azure SQL Database のゾーン冗長を有効にして、高可用性と回復性を実現する",
    "potentialBenefits": "Enhanced reliability, no extra cost",
    "tags": null,
    "recommendationResourceType": "Microsoft.Sql/servers",
    "recommendationImpact": "Medium",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Finds non-zone redundant SQL databases and lists them\nResources\n| where type =~ 'microsoft.sql/servers/databases'\n| where tolower(tostring(properties.zoneRedundant))=~'false'\n|project recommendationId = \"c0085c32-84c0-c247-bfa9-e70977cbf108\", name, id, tags\n\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "cbb17a29-64fb-c943-95d0-8df814a37c40",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/ja-jp/azure/azure-sql/database/troubleshoot-common-connectivity-issues",
        "name": "How to Implement Retry Logic"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "一時的な障害発生時には、アプリケーションは Azure SQL Database を使用して接続の再試行を効果的に処理する必要があります。データベース レイヤーの設定は必要ありません。代わりに、正常な再試行を行うようにアプリケーションを設定する必要があります。\n",
    "pgVerified": true,
    "description": "再試行ロジックを実装する",
    "potentialBenefits": "Enhanced connectivity stability",
    "tags": null,
    "recommendationResourceType": "Microsoft.Sql/servers",
    "recommendationImpact": "High",
    "automationAvailable": false,
    "query": "// cannot-be-validated-with-arg\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "7e7daec9-6a81-3546-a4cc-9aef72fec1f7",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/ja-jp/azure/azure-monitor/insights/azure-sql#analyze-data-and-create-alerts",
        "name": "Azure Monitor"
      },
      {
        "url": "https://learn.microsoft.com/ja-jp/azure/azure-sql/database/monitoring-sql-database-azure-monitor",
        "name": "Azure SQL Database Monitoring"
      },
      {
        "url": "https://learn.microsoft.com/ja-jp/azure/azure-sql/database/monitoring-sql-database-azure-monitor-reference",
        "name": "Monitoring SQL Database Reference"
      }
    ],
    "recommendationControl": "Monitoring and Alerting",
    "longDescription": "監視とアラートは、データベース操作の重要な部分です。Azure SQL Database を使用する場合は、Azure Monitor と SQL Insights を使用して、関連するデータベース メトリックを確実にキャプチャします。\n",
    "pgVerified": true,
    "description": "Azure SQL Database をほぼリアルタイムで監視して信頼性インシデントを検出する",
    "potentialBenefits": "Quick incident detection and response",
    "tags": null,
    "recommendationResourceType": "Microsoft.Sql/servers",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Provides a list of SQL databases that are not configured for monitoring.\nresources\n| where type == \"microsoft.insights/metricalerts\"\n| mv-expand properties.scopes\n| mv-expand properties.criteria.allOf\n| project databaseid = properties_scopes, monitoredMetric = properties_criteria_allOf.metricName\n| where databaseid contains 'databases'\n| summarize monitoredMetrics=make_list(monitoredMetric) by databaseid=tolower(tostring(databaseid))\n| join kind=fullouter   (\n  resources\n  | where type =~ 'microsoft.sql/servers/databases'\n  | project databaseid = tolower(id), name, tags\n) on databaseid\n| where isnull(monitoredMetrics)\n| project recommendationId = \"7e7daec9-6a81-3546-a4cc-9aef72fec1f7\", name, id=databaseid1, tags, param1=strcat(\"MonitoringMetrics=false\" )\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "d6ef87aa-574e-584e-a955-3e6bb8b5425b",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/ja-jp/azure/key-vault/general/overview",
        "name": "Azure Key Vault"
      },
      {
        "url": "https://learn.microsoft.com/ja-jp/azure/azure-sql/database/always-encrypted-landing?view=azuresql",
        "name": "Getting Started with Always Encrypted"
      }
    ],
    "recommendationControl": "Disaster Recovery",
    "longDescription": "Azure Key Vault (AKV) を使用して、Always Encrypted 構成に関連する暗号化キーを格納することを強くお勧めしますが、必須ではありません。AKV を使用していない場合は、キーが適切にバックアップされ、安全な方法で保存されていることを確認してください。\n",
    "pgVerified": true,
    "description": "キーをバックアップする",
    "potentialBenefits": "Enhanced security and data recovery",
    "tags": null,
    "recommendationResourceType": "Microsoft.Sql/servers",
    "recommendationImpact": "Medium",
    "automationAvailable": false,
    "query": "// cannot-be-validated-with-arg\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "de266d8a-a9f3-4cb9-be95-9306001fceea",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/azure-sql/database/failover-group-sql-db?view=azuresql#endpoint-redirection",
        "name": "フェールオーバー グループのエンドポイント リダイレクト"
      }
    ],
    "recommendationControl": "Disaster Recovery",
    "longDescription": "フェールオーバー グループを使用する場合は、個々のデータベースのエンドポイントではなく、フェールオーバー グループのエンドポイントに接続することを推奨します。これにより、フェールオーバー時にセカンダリ データベースへの自動リダイレクトが可能になり、高可用性が確保されます。\n",
    "pgVerified": false,
    "description": "データベース接続にフェールオーバー グループのエンドポイントを使用する",
    "potentialBenefits": "Enhanced disaster recovery",
    "tags": null,
    "recommendationResourceType": "Microsoft.Sql/servers",
    "recommendationImpact": "High",
    "automationAvailable": false,
    "query": "// cannot-be-validated-with-arg\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "43663217-a1d3-844b-80ea-571a2ce37c6c",
    "recommendationTypeId": "b57f7a29-dcc8-43de-86fa-18d3f9d3764d",
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/cosmos-db/distribute-data-globally",
        "name": "Azure Cosmos DB を使用してデータをグローバルに分散させる"
      },
      {
        "url": "https://learn.microsoft.com/azure/cosmos-db/high-availability#tips-for-building-highly-available-applications",
        "name": "Azure Cosmos DB for NoSQL の高可用性 (信頼性)"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "Cosmos DB でセカンダリ リージョンを有効にして、ダウンタイムなしで SLA を向上させます。地図上に場所をピン留めするだけです。厳密な整合性の場合は、障害が発生した場合の書き込み可用性のために少なくとも 3 つのリージョンを構成します。\n",
    "pgVerified": true,
    "description": "高可用性のために少なくとも 2 つのリージョンを構成する",
    "potentialBenefits": "Enhances SLA and resilience",
    "tags": null,
    "recommendationResourceType": "Microsoft.DocumentDB/databaseAccounts",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Query to find Azure Cosmos DB accounts that have less than 2 regions or less than 3 regions with strong consistency level\nResources\n| where type =~ 'Microsoft.DocumentDb/databaseAccounts'\n| where\n    array_length(properties.locations) < 2 or\n    (array_length(properties.locations) < 3 and properties.consistencyPolicy.defaultConsistencyLevel == 'Strong')\n| project recommendationId='43663217-a1d3-844b-80ea-571a2ce37c6c', name, id, tags\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "9cabded7-a1fc-6e4a-944b-d7dd98ea31a2",
    "recommendationTypeId": "5de9f2e6-087e-40da-863a-34b7943beed4",
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/cosmos-db/how-to-manage-database-account#automatic-failover",
        "name": "Azure portal を使用して Azure Cosmos DB アカウントを管理する"
      }
    ],
    "recommendationControl": "Disaster Recovery",
    "longDescription": "Cosmos DB は、高いアップタイムと回復性を誇っています。それでも、問題が発生する可能性があります。サービス マネージド フェールオーバーでは、リージョンがダウンしている場合、Cosmos DB は次に使用可能なリージョンに自動的に切り替わり、ユーザーの操作は必要ありません。\n",
    "pgVerified": true,
    "description": "単一の書き込みリージョンを持つマルチリージョン アカウントのサービス マネージド フェイルオーバーを有効にする",
    "potentialBenefits": "Auto failover for high uptime",
    "tags": null,
    "recommendationResourceType": "Microsoft.DocumentDB/databaseAccounts",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Query to list all Azure Cosmos DB accounts that do not have multiple write locations or automatic failover enabled\nResources\n| where type =~ 'Microsoft.DocumentDb/databaseAccounts'\n| where\n    array_length(properties.locations) > 1 and\n    tobool(properties.enableAutomaticFailover) == false and\n    tobool(properties.enableMultipleWriteLocations) == false\n| project recommendationId='9cabded7-a1fc-6e4a-944b-d7dd98ea31a2', name, id, tags\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "921631f6-ed59-49a5-94c1-f0f3ececa580",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/reliability/reliability-cosmos-db-nosql",
        "name": "Azure Cosmos DB の高可用性"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "可用性ゾーンが構成されると、Azure Cosmos DB はデータの 4 つのレプリカをすべての可用性ゾーンにインテリジェントに分散します。これにより、Azure Cosmos DB は、1 つの可用性ゾーンの停止に耐え、全体を通して完全に稼働し続けることができます。\n",
    "pgVerified": false,
    "description": "可用性ゾーンを有効にする",
    "potentialBenefits": "Enhances high availability",
    "tags": null,
    "recommendationResourceType": "Microsoft.DocumentDB/databaseAccounts",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Query to find Azure Cosmos DB accounts that do not utilize availability zones and are deployed in availability-zone supported regions\nResources\n| where type == \"microsoft.documentdb/databaseaccounts\"\n| where properties.capabilities !has_cs 'EnableServerless'\n| project recommendationId='921631f6-ed59-49a5-94c1-f0f3ececa580', name, id, tags, locations=properties.locations\n| mv-expand locations\n| where not(locations.isZoneRedundant) //filter out already AZ enabled regions\n| extend location=tostring(locations.locationName)\n| project-away locations\n| where location in (\n    'Australia East', 'Brazil South', 'Canada Central', 'Central India', 'Central US',\n    'China North 3', 'East Asia', 'East US', 'East US 2', 'France Central',\n    'Germany West Central', 'Israel Central', 'Italy North', 'Japan East', 'Japan West',\n    'Korea Central', 'Mexico Central', 'New Zealand North', 'North Europe', 'Norway East',\n    'Poland Central', 'Qatar Central', 'South Africa North', 'South Central US', 'Southeast Asia',\n    'Spain Central', 'Sweden Central', 'Switzerland North', 'UAE North', 'UK South',\n    'US Gov Virginia', 'West Europe', 'West US 2', 'West US 3') // filter out regions unsupported for AZs\n| project-rename param1=location\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "9ce78192-74a0-104c-b5bb-9a443f941649",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/cosmos-db/distribute-data-globally",
        "name": "Azure Cosmos DB を使用してデータをグローバルに分散させる"
      },
      {
        "url": "https://learn.microsoft.com/azure/cosmos-db/conflict-resolution-policies",
        "name": "複数の書き込みリージョンを使用する場合の競合の種類と解決ポリシー"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "複数リージョンの書き込み機能を使用すると、複数のリージョン間で可用性の高いアプリケーションを設計できますが、一貫性の要件と競合の解決には細心の注意を払う必要があります。不適切な設定を行うと、可用性が低下し、未処理の競合によりデータが破損する可能性があります。\n",
    "pgVerified": true,
    "description": "複数リージョンの書き込み機能を評価する",
    "potentialBenefits": "Enhances high availability",
    "tags": null,
    "recommendationResourceType": "Microsoft.DocumentDB/databaseAccounts",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Query to find Azure Cosmos DB accounts that have multiple read locations but do not have multiple write locations enabled\nResources\n| where type =~ 'Microsoft.DocumentDb/databaseAccounts'\n| where\n    array_length(properties.locations) > 1 and\n    properties.enableMultipleWriteLocations == false\n| project recommendationId='9ce78192-74a0-104c-b5bb-9a443f941649', name, id, tags\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "e544520b-8505-7841-9e77-1f1974ee86ec",
    "recommendationTypeId": "52fef986-5897-4359-8b92-0f22749f0d73",
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/cosmos-db/continuous-backup-restore-introduction",
        "name": "Azure Cosmos DB のポイントインタイム リストアを使用した継続的バックアップ"
      }
    ],
    "recommendationControl": "Disaster Recovery",
    "longDescription": "Cosmos DB のバックアップは常時稼働しており、データの事故から保護します。Microsoft サポートに連絡する必要があり、リストア時間が長くなる定期モードとは異なり、継続モードでは、災難前のポイントにセルフサービスで復元できます。\n",
    "pgVerified": true,
    "description": "継続的バックアップ モードを構成する",
    "potentialBenefits": "Faster self-serve data restore",
    "tags": null,
    "recommendationResourceType": "Microsoft.DocumentDB/databaseAccounts",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Query all Azure Cosmos DB accounts that do not have continuous backup mode configured\nResources\n| where type =~ 'Microsoft.DocumentDb/databaseAccounts'\n| where\n    properties.backupPolicy.type == 'Periodic' and\n    properties.enableMultipleWriteLocations == false and\n    properties.enableAnalyticalStorage == false\n| project recommendationId='e544520b-8505-7841-9e77-1f1974ee86ec', name, id, tags\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "c006604a-0d29-684c-99f0-9729cb40dac5",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/cosmos-db/nosql/query/pagination#handling-multiple-pages-of-results",
        "name": "Azure Cosmos DB for NoSQL での改ページ"
      }
    ],
    "recommendationControl": "Scalability",
    "longDescription": "Cosmos DB には 4 MB の応答制限があり、大規模なクエリやパーティションにまたがるクエリでは、結果がページ分割されます。各ページには空き状況が表示され、次のページのための継続トークンが提供されます。すべてのページを完了までたどるには、コード内に while ループが必要です。\n",
    "pgVerified": true,
    "description": "クエリ結果が完全に取得されていることを確認する",
    "potentialBenefits": "Maximizes data retrieval efficiency",
    "tags": null,
    "recommendationResourceType": "Microsoft.DocumentDB/databaseAccounts",
    "recommendationImpact": "High",
    "automationAvailable": false,
    "query": "// under-development\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "7eb32cf9-9a42-1540-acf8-597cbba8a418",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/cosmos-db/nosql/conceptual-resilient-sdk-applications",
        "name": "Azure Cosmos DB SDK を使用した回復性があるアプリケーションの設計"
      }
    ],
    "recommendationControl": "Scalability",
    "longDescription": "接続はクライアントに関連付けられているため、アカウントとアプリケーションごとに SDK クライアントの 1 つのインスタンスを使用することが重要です。コンピューティング環境では、開いている接続に制限があり、超過すると接続に影響します。\n",
    "pgVerified": true,
    "description": "クライアントでシングルトン パターンを維持する",
    "potentialBenefits": "Optimizes connections and efficiency",
    "tags": null,
    "recommendationResourceType": "Microsoft.DocumentDB/databaseAccounts",
    "recommendationImpact": "Medium",
    "automationAvailable": false,
    "query": "// under-development\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "fa6ac22f-0584-bb4b-80e4-80f4755d1a97",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/cosmos-db/nosql/conceptual-resilient-sdk-applications",
        "name": "Azure Cosmos DB SDK を使用した回復性があるアプリケーションの設計"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "Cosmos DB SDK では、再試行によって多くの一時的なエラーが自動的に管理されます。それでも、SDK が一般的に対処できない特定のケースを対象とする追加の再試行ポリシーをアプリケーションで実装し、より堅牢なエラー処理を確保することが重要です。\n",
    "pgVerified": true,
    "description": "クライアントに再試行ロジックを実装する",
    "potentialBenefits": "Enhances error handling resilience",
    "tags": null,
    "recommendationResourceType": "Microsoft.DocumentDB/databaseAccounts",
    "recommendationImpact": "Medium",
    "automationAvailable": false,
    "query": "// under-development\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "deaea200-013c-414b-ac9f-bfa7a7fb13f0",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/cosmos-db/create-alerts",
        "name": "Azure Monitor を使用して Azure Cosmos DB のアラートを作成する"
      }
    ],
    "recommendationControl": "Monitoring and Alerting",
    "longDescription": "Azure Cosmos DB リソースの可用性と応答性を監視し、ワークロードに対してアラートを設定することをお勧めします。これにより、予期しないイベントに積極的に対処できます。\n",
    "pgVerified": true,
    "description": "Cosmos DB の正常性を監視し、アラートを設定する",
    "potentialBenefits": "Proactive issue management",
    "tags": null,
    "recommendationResourceType": "Microsoft.DocumentDB/databaseAccounts",
    "recommendationImpact": "Medium",
    "automationAvailable": false,
    "query": "// under-development\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "af426a99-62a6-6b4c-9662-42d220b413b8",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/azure-netapp-files/azure-netapp-files-service-levels",
        "name": "Service levels for Azure NetApp Files | Microsoft Learn"
      }
    ],
    "recommendationControl": "Scalability",
    "longDescription": "容量プール属性の一部であるサービス レベルによって、Azure NetApp Files のボリューム クォータあたりの最大スループットが決まります。読み取り速度と書き込み速度を兼ね備えており、Standard (1TiB あたり 16MiB/秒)、Premium (1TiB あたり 64MiB/秒)、Ultra (1TiB あたり 128MiB/秒) の 3 つのレベルを提供します。\n",
    "pgVerified": true,
    "description": "予想されるパフォーマンス レベルに対して正しいサービス レベルとボリューム クォータ サイズを使用する",
    "potentialBenefits": "Optimized performance and cost efficiency",
    "tags": null,
    "recommendationResourceType": "Microsoft.NetApp/netAppAccounts",
    "recommendationImpact": "Medium",
    "automationAvailable": false,
    "query": "// cannot-be-validated-with-arg\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "ab984130-c57b-6c4a-8d04-6723b4e1bdb6",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/azure-netapp-files/azure-netapp-files-network-topologies",
        "name": "Guidelines for Azure NetApp Files network planning | Microsoft Learn"
      }
    ],
    "recommendationControl": "Scalability",
    "longDescription": "Azure NetApp Files の標準ネットワーク機能は、ネットワーク セキュリティ グループ、サブネット上のユーザー定義ルート、さまざまな接続オプションなど、IP 制限と VNet 機能を強化します。\n",
    "pgVerified": true,
    "description": "Azure NetApp Files の運用環境に標準ネットワーク機能を使用する",
    "potentialBenefits": "Enhanced connectivity and security",
    "tags": null,
    "recommendationResourceType": "Microsoft.NetApp/netAppAccounts",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// This Resource Graph query will return all Azure NetApp Files volumes without standard network features.\nresources\n| where type =~ \"microsoft.netapp/netappaccounts/capacitypools/volumes\"\n| where properties.networkFeatures != \"Standard\"\n| project recommendationId = \"ab984130-c57b-6c4a-8d04-6723b4e1bdb6\", name, id, tags\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "47d100a5-7f85-5742-967a-67eb5081240a",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/azure-netapp-files/use-availability-zones",
        "name": "Use availability zones for high availability in Azure NetApp Files | Microsoft Learn"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "可用性ゾーンは、ローカルの障害に耐えるための Azure リージョン内の個別の場所です。ワークロードを複数の可用性ゾーンにデプロイし、アプリケーションベースのレプリケーションや Azure NetApp Files のクロスゾーン レプリケーションを使用して高可用性を実現します。フェールオーバーは手動のプロセスであることに注意してください。\n",
    "pgVerified": true,
    "description": "可用性ゾーンを使用して Azure NetApp Files で高可用性を実現する",
    "potentialBenefits": "High Availability across availability zones",
    "tags": null,
    "recommendationResourceType": "Microsoft.NetApp/netAppAccounts",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// This Resource Graph query will return all Azure NetApp Files volumes without an availability zone defined.\nResources\n| where type =~ \"Microsoft.NetApp/netAppAccounts/capacityPools/volumes\"\n| where array_length(zones) == 0 or isnull(zones)\n| project recommendationId = \"47d100a5-7f85-5742-967a-67eb5081240a\", name, id, tags\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "8bb690e8-64d5-4838-8703-9ee3dbac688f",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/azure-netapp-files/manage-availability-zone-volume-placement",
        "name": "Manage availability zone volume placement for Azure NetApp Files | Microsoft Learn"
      }
    ],
    "recommendationControl": "Other Best Practices",
    "longDescription": "Azure NetApp Files の可用性ゾーン (AZ) ボリューム配置機能を使用すると、Azure コンピューティングやその他のサービスと同じ AZ にボリュームをデプロイして、AZ 内の待機時間を確保し、同じ AZ 障害ドメインを共有できます。\n",
    "pgVerified": true,
    "description": "ANF ボリュームを Azure コンピューティングやその他のサービスと同じ可用性ゾーンにデプロイする",
    "potentialBenefits": "Within AZ latency and tolerate failure of other AZ",
    "tags": null,
    "recommendationResourceType": "Microsoft.NetApp/netAppAccounts",
    "recommendationImpact": "High",
    "automationAvailable": false,
    "query": "// cannot-be-validated-with-arg\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "72827434-c773-4345-9493-34848ddf5803",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/azure-netapp-files/snapshots-introduction",
        "name": "How Azure NetApp Files snapshots work | Microsoft Learn"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "Azure NetApp Files スナップショット テクノロジにより、パフォーマンスに影響を与えることなく、安定性、スケーラビリティ、迅速なデータ復旧性が確保されます。Azure NetApp Files データのポリシーによる自動スナップショット作成がサポートされています。\n",
    "pgVerified": true,
    "description": "Azure NetApp Files でのデータ保護にスナップショットを使用する",
    "potentialBenefits": "Stable, scalable, swift recovery, no perf impact",
    "tags": null,
    "recommendationResourceType": "Microsoft.NetApp/netAppAccounts",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// This Resource Graph query will return all Azure NetApp Files volumes without a snapshot policy defined.\nresources\n| where type == \"microsoft.netapp/netappaccounts/capacitypools/volumes\"\n| where properties.dataProtection.snapshot.snapshotPolicyId == \"\"\n| project recommendationId = \"72827434-c773-4345-9493-34848ddf5803\", name, id, tags\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "b2fb3e60-97ec-e34d-af29-b16a0d61c2ac",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/azure-netapp-files/backup-introduction",
        "name": "Understand Azure NetApp Files backup | Microsoft Learn"
      }
    ],
    "recommendationControl": "Disaster Recovery",
    "longDescription": "Azure NetApp Files は、長期的な復旧、アーカイブ、コンプライアンスを強化するフル マネージド バックアップ ソリューションを提供します。\n",
    "pgVerified": true,
    "description": "Azure NetApp Files でデータ保護のバックアップを有効にする",
    "potentialBenefits": "Enhances data recovery and compliance",
    "tags": null,
    "recommendationResourceType": "Microsoft.NetApp/netAppAccounts",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// This Resource Graph query will return all Azure NetApp Files volumes without a backup policy defined.\nresources\n| where type == \"microsoft.netapp/netappaccounts/capacitypools/volumes\"\n| where properties.dataProtection.backup.backupPolicyId == \"\"\n| project recommendationId = \"b2fb3e60-97ec-e34d-af29-b16a0d61c2ac\", name, id, tags\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "e30317d2-c502-4dfe-a2d3-0a737cc79545",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/ja-jp/azure/azure-netapp-files/cross-region-replication-introduction",
        "name": "Cross-region replication of Azure NetApp Files volumes"
      }
    ],
    "recommendationControl": "Disaster Recovery",
    "longDescription": "Azure NetApp Files レプリケーションは、リージョンの障害が発生した場合に、アプリケーションのフェールオーバーのために非同期のリージョン間ボリューム レプリケーションを許可することで、データ保護を提供します。ボリュームは、リージョン間でレプリケートできますが、クロスゾーンレプリケーションと同時にレプリケートすることはできません。フェールオーバーは手動のプロセスであることに注意してください。\n",
    "pgVerified": true,
    "description": "Azure NetApp Files ボリュームのリージョン間レプリケーションを有効にする",
    "potentialBenefits": "Enhanced data protection and disaster recovery",
    "tags": null,
    "recommendationResourceType": "Microsoft.NetApp/netAppAccounts",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// This Resource Graph query will return all Azure NetApp Files volumes without cross-region replication.\nresources\n| where type == \"microsoft.netapp/netappaccounts/capacitypools/volumes\"\n| extend remoteVolumeRegion = properties.dataProtection.replication.remoteVolumeRegion\n| extend volumeType = properties.volumeType\n| extend replicationType = iff((remoteVolumeRegion == location), \"CZR\", iff((remoteVolumeRegion == \"\"),\"n/a\",\"CRR\"))\n| where replicationType != \"CRR\" and volumeType != \"DataProtection\"\n| project recommendationId = \"e30317d2-c502-4dfe-a2d3-0a737cc79545\", name, id, tags\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "e3d742e1-dacd-9b48-b6b1-510ec9f87c96",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/azure-netapp-files/cross-zone-replication-introduction",
        "name": "Cross-zone replication of Azure NetApp Files volumes | Microsoft Learn"
      }
    ],
    "recommendationControl": "Disaster Recovery",
    "longDescription": "ゾーン間レプリケーション (CZR) 機能を使用すると、異なる可用性ゾーン間で Azure NetApp Files ボリューム間で非同期データ レプリケーションが可能になり、ゾーン全体の障害が発生した場合にデータ保護と重要なアプリケーションのフェールオーバーが保証されます。フェールオーバーは手動のプロセスであることに注意してください。\n",
    "pgVerified": true,
    "description": "Azure NetApp Files ボリュームのゾーン間レプリケーションを有効にする",
    "potentialBenefits": "Enhances disaster recovery across availability zones",
    "tags": null,
    "recommendationResourceType": "Microsoft.NetApp/netAppAccounts",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// This Resource Graph query will return all Azure NetApp Files volumes without cross-zone replication.\nresources\n| where type == \"microsoft.netapp/netappaccounts/capacitypools/volumes\"\n| extend remoteVolumeRegion = properties.dataProtection.replication.remoteVolumeRegion\n| extend volumeType = properties.volumeType\n| extend replicationType = iff((remoteVolumeRegion == location), \"CZR\", iff((remoteVolumeRegion == \"\"),\"n/a\",\"CRR\"))\n| where replicationType != \"CZR\" and volumeType != \"DataProtection\"\n| project recommendationId = \"e3d742e1-dacd-9b48-b6b1-510ec9f87c96\", name, id, tags\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "2f579fc9-e599-0d44-8b97-254f50ae04d8",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/azure-netapp-files/monitor-azure-netapp-files",
        "name": "Ways to monitor Azure NetApp Files | Microsoft Learn"
      }
    ],
    "recommendationControl": "Monitoring and Alerting",
    "longDescription": "Azure NetApp Files は、割り当てられたストレージ、実際の使用量、ボリューム IOPS、待機時間などのメトリックを提供し、NetApp アカウントの使用パターンとボリューム パフォーマンスをより深く理解できるようにします。\n",
    "pgVerified": true,
    "description": "Azure NetApp Files メトリックを監視して、使用パターンとパフォーマンスをよりよく理解する",
    "potentialBenefits": "Optimize usage and performance",
    "tags": null,
    "recommendationResourceType": "Microsoft.NetApp/netAppAccounts",
    "recommendationImpact": "Medium",
    "automationAvailable": false,
    "query": "// cannot-be-validated-with-arg\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "687ae58f-517f-ca43-90fe-922497e61283",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/azure-netapp-files/azure-policy-definitions",
        "name": "Azure Policy definitions for Azure NetApp Files | Microsoft Learn"
      },
      {
        "url": "https://learn.microsoft.com/azure/governance/policy/tutorials/create-custom-policy-definition",
        "name": "Creating custom policy definitions | Microsoft Learn"
      }
    ],
    "recommendationControl": "Governance",
    "longDescription": "Azure NetApp Files では、組み込みのポリシー定義を使用するか、組織の標準とコンプライアンスを維持するためのカスタム ポリシー定義を作成することで、Azure ポリシーの統合がサポートされています。\n",
    "pgVerified": true,
    "description": "Azure Policy を使用して Azure NetApp Files の標準を適用し、コンプライアンスを評価する",
    "potentialBenefits": "Enforce standards and assess compliance",
    "tags": null,
    "recommendationResourceType": "Microsoft.NetApp/netAppAccounts",
    "recommendationImpact": "Medium",
    "automationAvailable": false,
    "query": "// cannot-be-validated-with-arg\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "cfa2244b-5436-47de-8287-b217875d3b0a",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/azure-netapp-files/configure-network-features",
        "name": "Configure network features for an Azure NetApp Files volume"
      },
      {
        "url": "https://learn.microsoft.com/azure/azure-netapp-files/manage-smb-share-access-control-lists",
        "name": "Manage SMB share ACLs in Azure NetApp Files"
      },
      {
        "url": "https://learn.microsoft.com/azure/azure-netapp-files/azure-netapp-files-configure-export-policy",
        "name": "Configure export policy for NFS or dual-protocol volumes"
      },
      {
        "url": "https://learn.microsoft.com/azure/azure-netapp-files/configure-access-control-lists",
        "name": "Configure access control lists on NFSv4.1 volumes for Azure NetApp Files"
      },
      {
        "url": "https://learn.microsoft.com/azure/azure-netapp-files/configure-unix-permissions-change-ownership-mode",
        "name": "Configure Unix permissions and change ownership mode for NFS and dual-protocol volumes"
      }
    ],
    "recommendationControl": "Security",
    "longDescription": "委任されたサブネットへのアクセスは、特定の Azure Virtual Network に制限する必要があります。SMB 対応ボリュームの共有アクセス許可は、\"すべてのユーザー/フル コントロール\" から移動する必要があります。NFS 対応ボリュームのアクセスは、エクスポートポリシーや NFSv4.1 ACL を使用して制御する必要があります。\n",
    "pgVerified": true,
    "description": "Azure NetApp Files ボリュームへの既定のアクセスを制限する",
    "potentialBenefits": "Enhanced security, Reduced data breach risk",
    "tags": null,
    "recommendationResourceType": "Microsoft.NetApp/netAppAccounts",
    "recommendationImpact": "Medium",
    "automationAvailable": false,
    "query": "// cannot-be-validated-with-arg\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "d1e7ccc3-e6c1-40e9-a36e-fd134711c808",
    "recommendationTypeId": "e4bebd74-387a-4a74-b757-475d2d1b4e3e",
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/azure-netapp-files/faq-application-resilience#do-i-need-to-take-special-precautions-for-smb-based-applications",
        "name": "Do I need to take special precautions for SMB-based applications? | Microsoft Learn"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "特定の SMB アプリケーションでは、サーバー接続を中断することなくメンテナンスするために SMB 透過フェールオーバーが必要です。Azure NetApp Files は、Citrix App Layering、FSLogix ユーザー/プロファイル コンテナー、Microsoft SQL Server、MSIX アプリのアタッチなどのアプリケーションに対して、SMB 継続的可用性を通じてこれを提供します。\n",
    "pgVerified": true,
    "description": "サポートされているアプリケーションに SMB の継続的可用性を利用する",
    "potentialBenefits": "Zero downtime for SMB apps",
    "tags": null,
    "recommendationResourceType": "Microsoft.NetApp/netAppAccounts",
    "recommendationImpact": "High",
    "automationAvailable": false,
    "query": "// cannot-be-validated-with-arg\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "60f36f9b-fac9-4160-bbf5-57af04da4f53",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/azure-netapp-files/faq-application-resilience#what-do-you-recommend-for-handling-potential-application-disruptions-due-to-storage-service-maintenance-events",
        "name": "What do you recommend for handling potential application disruptions due to storage service maintenance events? | Microsoft Learn"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "Azure NetApp Files では、プラットフォームの更新やサービスやソフトウェアのアップグレードなど、計画的なメンテナンスが随時行われる場合があります。これらのストレージ サービスのメンテナンス イベントに対処するために、アプリケーションの回復性設定に注意することが重要です。\n",
    "pgVerified": true,
    "description": "サービス メンテナンス イベントに対するアプリケーションの回復力を確保する",
    "potentialBenefits": "Minimizes downtime during maintenance",
    "tags": null,
    "recommendationResourceType": "Microsoft.NetApp/netAppAccounts",
    "recommendationImpact": "Medium",
    "automationAvailable": false,
    "query": "// cannot-be-validated-with-arg\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "54c3191b-b535-1946-bba9-b754f44060f6",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/event-grid/enable-diagnostic-logs-topic",
        "name": "Event Grid リソースについての診断ログを有効にする"
      }
    ],
    "recommendationControl": "Monitoring and Alerting",
    "longDescription": "カスタム トピック、システム トピック、ドメインなどの Azure Event Grid リソースで診断設定を有効にすると、診断情報をキャプチャして表示し、エラーのトラブルシューティングを効果的に行うことができます。\n",
    "pgVerified": false,
    "description": "すべての Azure Event Grid リソースの診断設定を構成する",
    "potentialBenefits": "Enhanced troubleshooting for Event Grid",
    "tags": null,
    "recommendationResourceType": "Microsoft.EventGrid/topics",
    "recommendationImpact": "Low",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "92162eb5-4323-3145-8a6c-525ce2f0700e",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/event-grid/delivery-and-retry#dead-letter-events",
        "name": "Event Grid によるメッセージの配信と再試行"
      }
    ],
    "recommendationControl": "Personalized",
    "longDescription": "Event Grid は、特定の時間内や数回の試行後にイベントを配信できない場合、未配信イベントをストレージ アカウントに送信する配信不能処理につながります。\n",
    "pgVerified": false,
    "description": "配信不能イベントを保存するために配信不能処理を設定する",
    "potentialBenefits": "Saves undelivered events",
    "tags": null,
    "recommendationResourceType": "Microsoft.EventGrid/topics",
    "recommendationImpact": "Low",
    "automationAvailable": false,
    "query": "// under-development\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "b2069f64-4741-3d4a-a71d-50c8b03f5ab7",
    "recommendationTypeId": "bdac9c7b-b9b8-f572-0450-f161c430861c",
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/event-grid/configure-private-endpoints",
        "name": "Azure Event Grid カスタム トピックまたはドメインに対してプライベート エンドポイントを構成する"
      }
    ],
    "recommendationControl": "Security",
    "longDescription": "プライベート エンドポイントを使用して、プライベート リンク経由でカスタム トピック/ドメインへの安全なイベント イングレスを行い、パブリック インターネットを回避します。トピック/ドメインの VNet 空間の IP が使用されます。\n",
    "pgVerified": false,
    "description": "Azure Event Grid のトピックでは、プライベート リンク プライベート エンドポイントを使用する必要がある",
    "potentialBenefits": "Secure, private VNet ingress",
    "tags": null,
    "recommendationResourceType": "Microsoft.EventGrid/topics",
    "recommendationImpact": "Medium",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Find all eventgrid services not protected by private endpoints.\nResources\n| where type contains \"eventgrid\"\n| where properties['publicNetworkAccess'] == \"Enabled\"\n| project recommendationId = \"b2069f64-4741-3d4a-a71d-50c8b03f5ab7\", name, id, tags\n| order by id asc\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "c041d596-6c97-4c5f-b4b3-9cd37628f2e2",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://docs.citrix.com/ja-jp/citrix-daas-azure/limits",
        "name": "Citrix Limits"
      }
    ],
    "recommendationControl": "Governance",
    "longDescription": "Citrix Managed Azure サブスクリプションは、Cloud Connector などの他のマシンを除き、アプリ/デスクトップ配信用の VDA を備えた仮想マシンをサポートします。制限に近づいたら、ダッシュボード通知で通知され、十分なライセンスがある場合は、別のサブスクリプションを要求します。カタログに指定された制限を超えることはできません。\n",
    "pgVerified": true,
    "description": "サブスクリプションごとに 2,000 を超える Citrix VDA サーバーを作成しない",
    "potentialBenefits": "Avoids hitting limit, ensures reliability",
    "tags": null,
    "recommendationResourceType": "Microsoft.Subscription/Subscriptions",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Count VM instances with a tag that contains \"Citrix VDA\" and create output if that count is >2000 for each subscription.\n// The Citrix published limit is 2500. This query runs an 80% check.\n\nresources\n| where type == 'microsoft.compute/virtualmachines'\n| where tags contains 'Citrix VDA'\n| summarize VMs=count() by subscriptionId\n| where VMs > 2000\n| join (resourcecontainers| where type =='microsoft.resources/subscriptions' | project subname=name, subscriptionId) on subscriptionId\n| project recommendationId='c041d596-6c97-4c5f-b4b3-9cd37628f2e2', name= subname, id = subscriptionId, param1='Too many instances.', param2= VMs\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "5ada5ffa-7149-4e49-9fbf-e67be7c2594c",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/ja-jp/azure/cloud-adoption-framework/ready/landing-zone/design-area/resource-org-management-groups#management-group-recommendations",
        "name": "Management group recommendations"
      },
      {
        "url": "https://learn.microsoft.com/ja-jp/azure/governance/management-groups/overview#root-management-group-for-each-directory",
        "name": "Root management group for each directory"
      }
    ],
    "recommendationControl": "Governance",
    "longDescription": "Azure のルート管理グループは、組織階層用に設計されているため、すべての管理グループとサブスクリプションをそこに折りたたむことができます。\n",
    "pgVerified": true,
    "description": "サブスクリプションをテナント ルート管理グループの下に配置しない",
    "potentialBenefits": "Enhanced security, compliance, and management",
    "tags": null,
    "recommendationResourceType": "Microsoft.Subscription/Subscriptions",
    "recommendationImpact": "Medium",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Provides a list of Azure Subscriptions that are placed under the Tenant Root Management Group\nresourcecontainers\n| where type == 'microsoft.resources/subscriptions'\n| extend mgParentSize = array_length(properties.managementGroupAncestorsChain)\n| where mgParentSize == 1\n| project recommendationId=\"5ada5ffa-7149-4e49-9fbf-e67be7c2594c\", name, id, tags\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "783c6c18-760b-4867-9ced-3010a0bc5aa3",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/iot-hub/iot-hub-bulk-identity-mgmt",
        "name": "IoT Hub デバイス ID の一括でのインポートおよびエクスポート"
      },
      {
        "url": "https://learn.microsoft.com/azure/iot-hub/iot-hub-ha-dr#manual-failover",
        "name": "IoT Hub の高可用性とディザスター リカバリー"
      }
    ],
    "recommendationControl": "Disaster Recovery",
    "longDescription": "デバイス ID は、フェールオーバーが発生した場合の接続を確保するために、すべての IoT デバイスのフェールオーバー リージョン IoT Hub にコピーする必要があります。別のリージョンへの手動フェールオーバーはミッション クリティカルなワークロードに適しており、より高速 (RTO) です。\n",
    "pgVerified": false,
    "description": "デバイス ID はセカンダリ リージョンにエクスポートする",
    "potentialBenefits": "Faster failover; Ensures device connectivity",
    "tags": null,
    "recommendationResourceType": "Microsoft.Devices/IotHubs",
    "recommendationImpact": "High",
    "automationAvailable": false,
    "query": "// cannot-be-validated-with-arg\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "eeba3a49-fef0-481f-a471-7ff01139b474",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/iot-hub/iot-hub-scaling",
        "name": "ソリューションに適した IoT Hub のレベルとサイズを選択する"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "運用環境のシナリオでは、Free レベルでは必要なサービス レベル アグリーメントが提供されないため、IoT Hub レベルを Free にしないでください。\n",
    "pgVerified": false,
    "description": "Free レベルを使用しない",
    "potentialBenefits": "Ensures SLA for production",
    "tags": null,
    "recommendationResourceType": "Microsoft.Devices/IotHubs",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// list all IoT Hubs that are using the Free tier\nresources\n| where type =~ \"microsoft.devices/iothubs\" and\n    tostring(sku.tier) =~ 'Free'\n| project recommendationId=\"eeba3a49-fef0-481f-a471-7ff01139b474\", name, id, tags, param1=strcat(\"tier:\", tostring(sku.tier))\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "214cbc46-747e-4354-af6e-6bf0054196a5",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/iot-hub/iot-hub-ha-dr#availability-zones",
        "name": "IoT Hub の高可用性とディザスター リカバリー"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "IoT Hub の可用性ゾーンをサポートするリージョンでは、これらのゾーンを使用すると可用性が向上します。これらは、サポートされているリージョンの新しい IoT Hub に対して自動的にアクティブ化されます。\n",
    "pgVerified": false,
    "description": "可用性ゾーンを使用する",
    "potentialBenefits": "Boosts IoT Hub availability",
    "tags": null,
    "recommendationResourceType": "Microsoft.Devices/IotHubs",
    "recommendationImpact": "High",
    "automationAvailable": false,
    "query": "// cannot-be-validated-with-arg\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "b1e1378d-4572-4414-bebd-b8872a6d4d1c",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/iot-dps/concepts-service",
        "name": "IoT Hub Device Provisioning Service (DPS) の用語"
      },
      {
        "url": "https://learn.microsoft.com/azure/iot-dps/concepts-deploy-at-scale",
        "name": "大規模な IoT デバイス デプロイのベスト プラクティス"
      },
      {
        "url": "https://learn.microsoft.com/azure/iot-dps/iot-dps-ha-dr",
        "name": "IoT Hub Device Provisioning Service の高可用性とディザスター リカバリー"
      }
    ],
    "recommendationControl": "Scalability",
    "longDescription": "Device Provisioning Service (DPS) を使用すると、スケーリングと可用性のために IoT デバイスを簡単に再配布できるため、デバイスを再割り当てし、特定の IoT Hub インスタンスにバインドしないようにすることができます。DPS を使用する IoT Hub 内のデバイスは、DPS 使用率を確認する必要があります。\n",
    "pgVerified": false,
    "description": "Device Provisioning Service を使用する",
    "potentialBenefits": "Enhances scalability and availability",
    "tags": null,
    "recommendationResourceType": "Microsoft.Devices/IotHubs",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// list all IoT Hubs that do not have a linked IoT Hub Device Provisioning Service (DPS)\nresources\n| where type =~ \"microsoft.devices/iothubs\"\n| project id, iotHubName=tostring(properties.hostName), tags, resourceGroup\n| join kind=fullouter (\n    resources\n    | where type == \"microsoft.devices/provisioningservices\"\n    | mv-expand iotHubs=properties.iotHubs\n    | project iotHubName = tostring(iotHubs.name), dpsName = name, name=iotHubs.name\n) on iotHubName\n| where dpsName == ''\n| project recommendationId=\"b1e1378d-4572-4414-bebd-b8872a6d4d1c\", name=iotHubName, id, tags, param1='DPS:none'\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "02568a5d-335e-4e51-9f7c-fe2ada977300",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/iot-hub/iot-hub-ha-dr",
        "name": "IoT Hub の高可用性とディザスター リカバリー"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "リージョンで障害が発生した場合、IoT Hub は自動または手動で 2 番目のリージョンにフェールオーバーして、アプリケーションが引き続き動作するようにすることができます。\n",
    "pgVerified": false,
    "description": "フェールオーバーのガイドラインを定義する",
    "potentialBenefits": "Ensures business continuity",
    "tags": null,
    "recommendationResourceType": "Microsoft.Devices/IotHubs",
    "recommendationImpact": "High",
    "automationAvailable": false,
    "query": "// cannot-be-validated-with-arg\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "e7dbd21f-b27a-4b8c-a901-cedb1e6d8e1e",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/iot-hub/iot-hub-devguide-messages-d2c#fallback-route",
        "name": "メッセージ ルーティングを使用する - フォールバック ルート"
      }
    ],
    "recommendationControl": "Monitoring and Alerting",
    "longDescription": "IoT Hub のカスタム エンドポイントにメッセージ ルーティングを使用すると、特定の条件が満たされていない場合、メッセージがこれらの宛先に到達しない可能性があります。既定のルートでは、すべてのメッセージが確実に受信されますが、このセーフティ ネットを無効にすると、一部のメッセージが配信されないままになるリスクがあります。\n",
    "pgVerified": false,
    "description": "フォールバック ルートを無効にする",
    "potentialBenefits": "Prevents undelivered messages",
    "tags": null,
    "recommendationResourceType": "Microsoft.Devices/IotHubs",
    "recommendationImpact": "Low",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// list all IoT Hubs that have the fallback route disabled\nresources\n| where type == \"microsoft.devices/iothubs\"\n| extend fallbackEnabled=properties.routing.fallbackRoute.isEnabled\n| where fallbackEnabled == false\n| project recommendationId=\"e7dbd21f-b27a-4b8c-a901-cedb1e6d8e1e\", name, id, tags, param1='FallbackRouteEnabled:false'\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "98bd7098-49d6-491b-86f1-b143d6b1a0ff",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/ja-jp/azure/azure-resource-manager/management/overview#resource-group-location-alignment",
        "name": "Azure Resource Manager Overview"
      }
    ],
    "recommendationControl": "Disaster Recovery",
    "longDescription": "リソースの場所がリソース グループと一致していることを確認して、リージョンの停止中にリソースを管理します。ARM はリソース データを格納しますが、使用できないリージョンにある場合、更新が停止し、リソースが読み取り専用になる可能性があります。\n",
    "pgVerified": true,
    "description": "リソース グループとそのリソースが同じリージョンにあることを確認する",
    "potentialBenefits": "Improves outage management",
    "tags": null,
    "recommendationResourceType": "Microsoft.Resources/resourceGroups",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Provides a list of Azure Resource Groups that have resources deployed in a region different than the Resource Group region\nresources\n| project id, name, tags, resourceGroup, location\n| where location != \"global\"                                                                                                          // exclude global resources\n| where resourceGroup != \"networkwatcherrg\"                                                                                           // exclude networkwatcherrg\n| where split(id, \"/\", 3)[0] =~ \"resourceGroups\"                                                                                      // resource is in a resource group\n| extend resourceGroupId = strcat_array(array_slice(split(id, \"/\"),0,4), \"/\")                                                         // create resource group resource id\n| join (resourcecontainers | project containerid=id, containerlocation=location ) on $left.resourceGroupId == $right.['containerid']  // join to resourcecontainers table\n| where  location != containerlocation\n| project recommendationId=\"98bd7098-49d6-491b-86f1-b143d6b1a0ff\", name, id, tags\n| order by id asc\n\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "88856605-53d8-4bbd-a75b-4a7b14939d32",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/mysql/flexible-server/concepts-high-availability",
        "name": "Azure Database for MySQL フレキシブル サーバーでの高可用性の概念"
      }
    ],
    "recommendationControl": "High Availability",
    "longDescription": "フレキシブル サーバー インスタンスでゾーン冗長を使用した HA を有効にして、スタンバイ レプリカを別のゾーンにデプロイし、信頼性とディザスター リカバリーを向上させるための自動フェールオーバー機能を提供します。\n",
    "pgVerified": true,
    "description": "ゾーン冗長で HA を有効にする",
    "potentialBenefits": "Enhanced uptime and data protection",
    "tags": null,
    "recommendationResourceType": "Microsoft.DBforMySQL/flexibleServers",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Find Database for MySQL instances that are not zone redundant\nresources\n| where type == \"microsoft.dbformysql/flexibleservers\"\n| where properties.highAvailability.mode != \"ZoneRedundant\"\n| project recommendationId = \"88856605-53d8-4bbd-a75b-4a7b14939d32\", name, id, tags, param1 = \"ZoneRedundant: False\"\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "82a9a0f2-24ee-496f-9ad2-25f81710942d",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/mysql/flexible-server/concepts-maintenance",
        "name": "Azure Database for MySQL - フレキシブル サーバーでの予定メンテナンス"
      }
    ],
    "recommendationControl": "Scalability",
    "longDescription": "フレキシブル サーバー インスタンスでカスタム メンテナンス スケジュールを使用して、サービス更新プログラムを適用する優先時間を選択します。\n",
    "pgVerified": true,
    "description": "カスタム メンテナンス スケジュールを有効にする",
    "potentialBenefits": "Control update timings",
    "tags": null,
    "recommendationResourceType": "Microsoft.DBforMySQL/flexibleServers",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Find Database for MySQL instances that do not have a custom maintenance window\nresources\n| where type =~ \"microsoft.dbformysql/flexibleservers\"\n| where properties.maintenanceWindow.customWindow != \"Enabled\"\n| project recommendationId = \"82a9a0f2-24ee-496f-9ad2-25f81710942d\", name, id, tags, param1 = strcat(\"customWindow:\", properties['maintenanceWindow']['customWindow'])\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "5c96afc3-7d2e-46ff-a4c7-9c32850c441b",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/mysql/flexible-server/concepts-backup-restore",
        "name": "Azure Database for MySQL - フレキシブル サーバーでのバックアップと復元"
      }
    ],
    "recommendationControl": "Disaster Recovery",
    "longDescription": "障害や災害が発生した場合でも、データベースの可用性と耐久性の目標を確実に満たすように GRS を構成します。\n",
    "pgVerified": true,
    "description": "geo 冗長バックアップ ストレージを構成する",
    "potentialBenefits": "Recover from regional failure and/or disaster",
    "tags": null,
    "recommendationResourceType": "Microsoft.DBforMySQL/flexibleServers",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Find Database for MySQL instances that do not have geo redundant backup storage enabled\nresources\n| where type =~ \"microsoft.dbformysql/flexibleservers\"\n| where properties.backup.geoRedundantBackup != \"Enabled\"\n| project recommendationId = \"5c96afc3-7d2e-46ff-a4c7-9c32850c441b\", name, id, tags, param1 = strcat(\"geoRedundantBackup:\", properties['backup']['geoRedundantBackup'])\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "b49a8653-cc43-48c9-8513-a2d2e3f14dd1",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/mysql/flexible-server/concepts-read-replicas",
        "name": "Azure Database for MySQL - フレキシブル サーバーでの読み取りレプリカ"
      }
    ],
    "recommendationControl": "Disaster Recovery",
    "longDescription": "1 つ以上の読み取りレプリカを構成して、障害や障害が発生した場合でもデータベースの可用性と耐久性の目標を確実に満たすようにします。\n",
    "pgVerified": true,
    "description": "1 つ以上の読み取りレプリカを構成する",
    "potentialBenefits": "Recover from regional failure and/or disaster",
    "tags": null,
    "recommendationResourceType": "Microsoft.DBforMySQL/flexibleServers",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Find Database for MySQL instances that do not have a read replica configured\nresources\n| where type =~ \"microsoft.dbformysql/flexibleservers\"\n| where properties.replicationRole == \"None\"\n| project recommendationId = \"b49a8653-cc43-48c9-8513-a2d2e3f14dd1\", name, id, tags, param1 = strcat(\"replicationRole:\", properties['replicationRole'])\n"
  },
  {
    "publishedToAdvisor": null,
    "aprlGuid": "8176a79d-8645-4e52-96be-a10fc0204fe5",
    "recommendationTypeId": null,
    "recommendationMetadataState": "Active",
    "learnMoreLink": [
      {
        "url": "https://learn.microsoft.com/azure/mysql/flexible-server/concepts-service-tiers-storage#storage-autogrow",
        "name": "Azure Database for MySQL - Flexible Server service tiers - Storage auto grow"
      }
    ],
    "recommendationControl": "Scalability",
    "longDescription": "ストレージの自動拡張を構成して、サーバーのストレージが不足して読み取り専用になるのを防ぎます。\n",
    "pgVerified": true,
    "description": "ストレージの自動拡張を構成する",
    "potentialBenefits": "Scale storage automatically to meet increasing demand",
    "tags": null,
    "recommendationResourceType": "Microsoft.DBforMySQL/flexibleServers",
    "recommendationImpact": "High",
    "automationAvailable": true,
    "query": "// Azure Resource Graph Query\n// Find Database for MySQL instances that do not have a storage auto-grow\nresources\n| where type =~ \"microsoft.dbformysql/flexibleservers\"\n| where properties.storage.autoGrow != \"Enabled\"\n| project recommendationId = \"8176a79d-8645-4e52-96be-a10fc0204fe5\", name, id, tags, param1 = strcat(\"autoGrow:\", properties['storage']['autoGrow'])\n"
  }
]
